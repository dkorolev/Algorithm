/* f04c17a1d967f6886bef5c5a35a1ff17 */
(function(k){var d=/^\s*|\s*$/g,a="B".replace(/A(.)|B/,"$1")==="$1",c={majorVersion:"@@tinymce_major_version@@",minorVersion:"@@tinymce_minor_version@@",releaseDate:"@@tinymce_release_date@@",_init:function(){function e(m){if(m.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(m.src)){if(/_(src|dev)\.js/g.test(m.src))b.suffix="_src";if((o=m.src.indexOf("?"))!=-1)b.query=m.src.substring(o+1);b.baseURL=m.src.substring(0,m.src.lastIndexOf("/"));if(l&&b.baseURL.indexOf("://")==-1&&
b.baseURL.indexOf("/")!==0)b.baseURL=l+b.baseURL;return b.baseURL}return null}var b=this,f=document,h=navigator,g=h.userAgent,l,o,p;b.isOpera=k.opera&&opera.buildNumber;b.isWebKit=/WebKit/.test(g);b.isIE=!b.isWebKit&&!b.isOpera&&/MSIE/gi.test(g)&&/Explorer/gi.test(h.appName);b.isIE6=b.isIE&&/MSIE [56]/.test(g);b.isGecko=!b.isWebKit&&/Gecko/.test(g);b.isMac=g.indexOf("Mac")!=-1;b.isAir=/adobeair/i.test(g);b.isIDevice=/(iPad|iPhone)/.test(g);if(k.tinyMCEPreInit){b.suffix=tinyMCEPreInit.suffix;b.baseURL=
tinyMCEPreInit.base;b.query=tinyMCEPreInit.query}else{b.suffix="";g=f.getElementsByTagName("base");for(h=0;h<g.length;h++)if(p=g[h].href){if(/^https?:\/\/[^\/]+$/.test(p))p+="/";l=p?p.match(/.*\//)[0]:""}g=f.getElementsByTagName("script");for(h=0;h<g.length;h++)if(e(g[h]))return;if(f=f.getElementsByTagName("head")[0]){g=f.getElementsByTagName("script");for(h=0;h<g.length;h++)if(e(g[h]))return}}},is:function(e,b){if(!b)return e!==void 0;if(b=="array"&&e.hasOwnProperty&&e instanceof Array)return true;
return typeof e==b},makeMap:function(e,b,f){e=e||[];b=b||",";if(typeof e=="string")e=e.split(b);f=f||{};for(b=e.length;b--;)f[e[b]]={};return f},each:function(e,b,f){var h,g;if(!e)return 0;f=f||e;if(e.length!==void 0){h=0;for(g=e.length;h<g;h++)if(b.call(f,e[h],h,e)===false)return 0}else for(h in e)if(e.hasOwnProperty(h))if(b.call(f,e[h],h,e)===false)return 0;return 1},trim:function(e){return(e?""+e:"").replace(d,"")},create:function(e,b,f){var h,g,l,o,p,m=0;e=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(e);
l=e[3].match(/(^|\.)(\w+)$/i)[2];g=this.createNS(e[3].replace(/\.\w+$/,""),f);if(!g[l])if(e[2]=="static"){g[l]=b;this.onCreate&&this.onCreate(e[2],e[3],g[l])}else{if(!b[l]){b[l]=function(){};m=1}g[l]=b[l];this.extend(g[l].prototype,b);if(e[5]){h=this.resolve(e[5]).prototype;o=e[5].match(/\.(\w+)$/i)[1];p=g[l];g[l]=m?function(){return h[o].apply(this,arguments)}:function(){this.parent=h[o];return p.apply(this,arguments)};g[l].prototype[l]=g[l];this.each(h,function(n,q){g[l].prototype[q]=h[q]});this.each(b,
function(n,q){if(h[q])g[l].prototype[q]=function(){this.parent=h[q];return n.apply(this,arguments)};else if(q!=l)g[l].prototype[q]=n})}this.each(b["static"],function(n,q){g[l][q]=n});this.onCreate&&this.onCreate(e[2],e[3],g[l].prototype)}},walk:function(e,b,f,h){h=h||this;if(e){if(f)e=e[f];c.each(e,function(g,l){if(b.call(h,g,l,f)===false)return false;c.walk(g,b,f,h)})}},createNS:function(e,b){var f,h;b=b||k;e=e.split(".");for(f=0;f<e.length;f++){h=e[f];b[h]||(b[h]={});b=b[h]}return b},resolve:function(e,
b){var f,h;b=b||k;e=e.split(".");f=0;for(h=e.length;f<h;f++){b=b[e[f]];if(!b)break}return b},addUnload:function(e,b){var f=this;e={func:e,scope:b||this};if(f.unloads)f.unloads.push(e);else{var h=function(){var l=f.unloads,o,p;if(l){for(p in l)(o=l[p])&&o.func&&o.func.call(o.scope,1);if(k.detachEvent){k.detachEvent("onbeforeunload",g);k.detachEvent("onunload",h)}else k.removeEventListener&&k.removeEventListener("unload",h,false);f.unloads=w=h=0;k.CollectGarbage&&CollectGarbage()}},g=function(){var l=
document;if(l.readyState=="interactive"){var o=function(){l.detachEvent("onstop",o);h&&h();l=0};l&&l.attachEvent("onstop",o);k.setTimeout(function(){l&&l.detachEvent("onstop",o)},0)}};if(k.attachEvent){k.attachEvent("onunload",h);k.attachEvent("onbeforeunload",g)}else k.addEventListener&&k.addEventListener("unload",h,false);f.unloads=[e]}return e},removeUnload:function(e){var b=this.unloads,f=null;c.each(b,function(h,g){if(h&&h.func==e){b.splice(g,1);f=e;return false}});return f},explode:function(e,
b){return e?c.map(e.split(b||","),c.trim):e},_addVer:function(e){var b;if(!this.query)return e;b=(e.indexOf("?")==-1?"?":"&")+this.query;if(e.indexOf("#")==-1)return e+b;return e.replace("#",b+"#")},_replace:function(e,b,f){if(a)return f.replace(e,function(){var h=b,g=arguments,l;for(l=0;l<g.length-2;l++)h=g[l]===void 0?h.replace(new RegExp("\\$"+l,"g"),""):h.replace(new RegExp("\\$"+l,"g"),g[l]);return h});return f.replace(e,b)}};c._init();k.tinymce=k.tinyMCE=c})(window);
(function(k,d){var a=/^(href|src|style)$/i;if(!k)return alert("Some of the Javascript files required for Wikispaces did not load. Please reload this page and try again. If this problem continues, make sure an anti-virus program, firewall, or web filter is not blocking Wikispaces Javascript files.");d.$=k;d.adapter={patchEditor:function(e){function b(o,p){p&&this.removeAttr("data-mce-style");return l.css.apply(this,arguments)}function f(o,p){if(a.test(o))if(p!==void 0){this.each(function(m,n){e.dom.setAttrib(n,
o,p)});return this}else return this.attr("data-mce-"+o);return l.attr.apply(this,arguments)}function h(o){return function(p){if(p)p=e.dom.processHTML(p);return o.call(this,p)}}function g(o){if(o.css!==b){o.css=b;o.attr=f;o.html=h(l.html);o.append=h(l.append);o.prepend=h(l.prepend);o.after=h(l.after);o.before=h(l.before);o.replaceWith=h(l.replaceWith);o.tinymce=e;o.pushStack=function(){return g(l.pushStack.apply(this,arguments))}}return o}var l=k.fn;e.$=function(o,p){var m=e.getDoc();return g(k(o||
m,m||p))}}};d.extend=k.extend;d.extend(d,{map:k.map,grep:function(e,b){return k.grep(e,b||function(){return 1})},inArray:function(e,b){return k.inArray(b,e||[])}});var c={"tinymce.dom.DOMUtils":{select:function(e,b){return k.find(e,this.get(b)||this.get(this.settings.root_element)||this.doc,[])},is:function(e,b){return k(this.get(e)).is(b)}}};d.onCreate=function(e,b,f){d.extend(f,c[b])}})(window.jQuery,tinymce);
tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,Dispatcher:function(k){this.scope=k||this;this.listeners=[]},add:function(k,d){this.listeners.push({cb:k,scope:d||this.scope});return k},addToTop:function(k,d){this.listeners.unshift({cb:k,scope:d||this.scope});return k},remove:function(k){var d=this.listeners,a=null;tinymce.each(d,function(c,e){if(k==c.cb){a=k;d.splice(e,1);return false}});return a},dispatch:function(){var k,d=arguments,a,c=this.listeners;for(a=0;a<c.length;a++){k=
c[a];k=k.cb.apply(k.scope,d);if(k===false)break}return k}});
(function(){var k=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(d,a){var c=this;d=tinymce.trim(d);a=c.settings=a||{};if(/^(mailto|tel|news|javascript|about|data):/i.test(d)||/^\s*#/.test(d))c.source=d;else{if(d.indexOf("/")===0&&d.indexOf("//")!==0)d=(a.base_uri?a.base_uri.protocol||"http":"http")+"://mce_host"+d;/^\w*:?\/\//.test(d)||(d=(a.base_uri.protocol||"http")+"://mce_host"+c.toAbsPath(a.base_uri.path,d));d=d.replace(/@@/g,"(mce_at)");d=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(d);
k(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(e,b){if(b=d[b])b=b.replace(/\(mce_at\)/g,"@@");c[e]=b});if(a=a.base_uri){if(!c.protocol)c.protocol=a.protocol;if(!c.userInfo)c.userInfo=a.userInfo;if(!c.port&&c.host=="mce_host")c.port=a.port;if(!c.host||c.host=="mce_host")c.host=a.host;c.source=""}}},setPath:function(d){d=/^(.*?)\/?(\w+)?$/.exec(d);this.path=d[0];this.directory=d[1];this.file=d[2];this.source=
"";this.getURI()},toRelative:function(d){var a;if(d==="./")return d;d=new tinymce.util.URI(d,{base_uri:this});if(d.host!="mce_host"&&this.host!=d.host&&d.host||this.port!=d.port||this.protocol!=d.protocol)return d.getURI();a=this.toRelPath(this.path,d.path);if(d.query)a+="?"+d.query;if(d.anchor)a+="#"+d.anchor;return a},toAbsolute:function(d,a){d=new tinymce.util.URI(d,{base_uri:this});return d.getURI(this.host==d.host&&this.protocol==d.protocol?a:0)},toRelPath:function(d,a){var c,e=0,b="",f,h;d=
d.substring(0,d.lastIndexOf("/"));d=d.split("/");c=a.split("/");if(d.length>=c.length){f=0;for(h=d.length;f<h;f++)if(f>=c.length||d[f]!=c[f]){e=f+1;break}}if(d.length<c.length){f=0;for(h=c.length;f<h;f++)if(f>=d.length||d[f]!=c[f]){e=f+1;break}}if(e==1)return a;f=0;for(h=d.length-(e-1);f<h;f++)b+="../";f=e-1;for(h=c.length;f<h;f++)b+=f!=e-1?"/"+c[f]:c[f];return b},toAbsPath:function(d,a){var c,e=0,b=[],f;f=/\/$/.test(a)?"/":"";d=d.split("/");a=a.split("/");k(d,function(h){h&&b.push(h)});d=b;c=a.length-
1;for(b=[];c>=0;c--)if(!(a[c].length==0||a[c]=="."))if(a[c]=="..")e++;else if(e>0)e--;else b.push(a[c]);c=d.length-e;d=c<=0?b.reverse().join("/"):d.slice(0,c).join("/")+"/"+b.reverse().join("/");if(d.indexOf("/")!==0)d="/"+d;if(f&&d.lastIndexOf("/")!==d.length-1)d+=f;return d},getURI:function(d){var a;if(!this.source||d){a="";if(!d){if(this.protocol)a+=this.protocol+"://";if(this.userInfo)a+=this.userInfo+"@";if(this.host)a+=this.host;if(this.port)a+=":"+this.port}if(this.path)a+=this.path;if(this.query)a+=
"?"+this.query;if(this.anchor)a+="#"+this.anchor;this.source=a}return this.source}})})();
(function(){var k=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(d){d=this.get(d);var a;d&&k(d.split("&"),function(c){c=c.split("=");a=a||{};a[unescape(c[0])]=unescape(c[1])});return a},setHash:function(d,a,c,e,b,f){var h="";k(a,function(g,l){h+=(!h?"":"&")+escape(l)+"="+escape(g)});this.set(d,h,c,e,b,f)},get:function(d){var a=document.cookie,c=d+"=",e;if(a){e=a.indexOf("; "+c);if(e==-1){e=a.indexOf(c);if(e!=0)return null}else e+=2;d=a.indexOf(";",e);if(d==-1)d=a.length;
return unescape(a.substring(e+c.length,d))}},set:function(d,a,c,e,b,f){document.cookie=d+"="+escape(a)+(c?"; expires="+c.toGMTString():"")+(e?"; path="+escape(e):"")+(b?"; domain="+b:"")+(f?"; secure":"")},remove:function(d,a){var c=new Date;c.setTime(c.getTime()-1E3);this.set(d,"",c,a,c)}})})();
(function(){function k(d,a){var c,e,b;a=a||'"';if(d==null)return"null";b=typeof d;if(b=="string"){e="\u0008b\tt\nn\u000cf\rr\"\"''\\\\";return a+d.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(f,h){if(a==='"'&&f==="'")return f;c=e.indexOf(h);if(c+1)return"\\"+e.charAt(c+1);f=h.charCodeAt().toString(16);return"\\u"+"0000".substring(f.length)+f})+a}if(b=="object"){if(d.hasOwnProperty&&d instanceof Array){c=0;for(e="[";c<d.length;c++)e+=(c>0?",":"")+k(d[c],a);return e+"]"}e="{";for(c in d)e+=
typeof d[c]!="function"?(e.length>1?","+a:a)+c+a+":"+k(d[c],a):"";return e+"}"}return""+d}tinymce.util.JSON={serialize:k,parse:function(d){try{return eval("("+d+")")}catch(a){}}}})();
tinymce.create("static tinymce.util.XHR",{send:function(k){function d(f){a=0;try{a=new ActiveXObject(f)}catch(h){}return a}var a,c=window,e=0;k.scope=k.scope||this;k.success_scope=k.success_scope||k.scope;k.error_scope=k.error_scope||k.scope;k.async=k.async===false?false:true;k.data=k.data||"";if(a=c.XMLHttpRequest?new XMLHttpRequest:d("Microsoft.XMLHTTP")||d("Msxml2.XMLHTTP")){a.overrideMimeType&&a.overrideMimeType(k.content_type);a.open(k.type||(k.data?"POST":"GET"),k.url,k.async);k.content_type&&
a.setRequestHeader("Content-Type",k.content_type);a.setRequestHeader("X-Requested-With","XMLHttpRequest");a.send(k.data);var b=function(){if(!k.async||a.readyState==4||e++>1E4){if(k.success&&e<1E4&&a.status==200)k.success.call(k.success_scope,""+a.responseText,a,k);else if(k.error)k.error.call(k.error_scope,e>1E4?"TIMED_OUT":"GENERAL",a,k);a=null}else c.setTimeout(b,10)};if(!k.async)return b();c.setTimeout(b,10)}}});
(function(){var k=tinymce.extend,d=tinymce.util.JSON,a=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(c){this.settings=k({},c);this.count=0},send:function(c){var e=c.error,b=c.success;c=k(this.settings,c);c.success=function(f,h){f=d.parse(f);if(typeof f=="undefined")f={error:"JSON Parse error."};f.error?e.call(c.error_scope||c.scope,f.error,h):b.call(c.success_scope||c.scope,f.result)};c.error=function(f,h){if(e)e.call(c.error_scope||c.scope,f,h)};c.data=d.serialize({id:c.id||
"c"+this.count++,method:c.method,params:c.params});c.content_type="application/json";a.send(c)},"static":{sendRPC:function(c){return(new tinymce.util.JSONRequest).send(c)}}})})();
(function(k){function d(p){var m;m=document.createElement("div");m.innerHTML=p;return m.textContent||m.innerText||p}function a(p,m){var n,q,s,r={};if(p){p=p.split(",");m=m||10;for(n=0;n<p.length;n+=2){q=String.fromCharCode(parseInt(p[n],m));if(!e[q]){s="&"+p[n+1]+";";r[q]=s;r[s]=q}}return r}}var c,e,b,f=/[&\"\u007E-\uD7FF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,h=/[<>&\u007E-\uD7FF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=/[<>&\"\']/g,l=/&(#)?([\w]+);/g,o={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",
133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"};e={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};b={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};c=a("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",
32);k.html=k.html||{};k.html.Entities={encodeRaw:function(p,m){return p.replace(m?f:h,function(n){return e[n]||n})},encodeAllRaw:function(p){return(""+p).replace(g,function(m){return e[m]||m})},encodeNumeric:function(p,m){return p.replace(m?f:h,function(n){if(n.length>1)return"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";";return e[n]||"&#"+n.charCodeAt(0)+";"})},encodeNamed:function(p,m,n){n=n||c;return p.replace(m?f:h,function(q){return e[q]||n[q]||q})},getEncodeFunc:function(p,
m){function n(r,t){return r.replace(t?f:h,function(y){return e[y]||m[y]||"&#"+y.charCodeAt(0)+";"||y})}function q(r,t){return s.encodeNamed(r,t,m)}var s=k.html.Entities;m=a(m)||c;p=k.makeMap(p.replace(/\+/g,","));if(p.named&&p.numeric)return n;if(p.named){if(m)return q;return s.encodeNamed}if(p.numeric)return s.encodeNumeric;return s.encodeRaw},decode:function(p){return p.replace(l,function(m,n,q){if(n){q=parseInt(q);if(q>65535){q-=65536;return String.fromCharCode(55296+(q>>10),56320+(q&1023))}else return o[q]||
String.fromCharCode(q)}return b[m]||c[m]||d(m)})}}})(tinymce);
tinymce.html.Styles=function(k,d){function a(o,p,m,n){function q(s){s=parseInt(s).toString(16);return s.length>1?s:"0"+s}return"#"+q(p)+q(m)+q(n)}var c=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,e=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,b=/\s*([^:]+):\s*([^;]+);?/g,f=/\s+$/,h,g={},l;k=k||{};l="\\\" \\' \\; \\: ; : _".split(" ");for(h=0;h<l.length;h++){g[l[h]]="_"+h;g["_"+h]=l[h]}return{toHex:function(o){return o.replace(c,
a)},parse:function(o){function p(C,F){var K,L;if(K=r[C+"-top"+F]){L=r[C+"-right"+F];if(K==L){K=r[C+"-bottom"+F];if(L==K){L=r[C+"-left"+F];if(K==L){r[C+F]=L;delete r[C+"-top"+F];delete r[C+"-right"+F];delete r[C+"-bottom"+F];delete r[C+"-left"+F]}}}}}function m(C){var F=r[C],K;if(!(!F||F.indexOf(" ")<0)){F=F.split(" ");for(K=F.length;K--;)if(F[K]!==F[0])return false;r[C]=F[0];return true}}function n(C,F,K,L){if(m(F))if(m(K))if(m(L)){r[C]=r[F]+" "+r[K]+" "+r[L];delete r[F];delete r[K];delete r[L]}}
function q(C){v=true;return g[C]}function s(C,F){if(v)C=C.replace(/_[0-9]/g,function(K){return g[K]});F||(C=C.replace(/\\([\'\";:])/g,"$1"));return C}var r={},t,y,u,v,z=k.url_converter,A=k.url_converter_scope||this;if(o){for(o=o.replace(/\\[\"\';:_]/g,q).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(C){return C.replace(/[;:]/g,q)});t=b.exec(o);){y=t[1].replace(f,"").toLowerCase();u=t[2].replace(f,"");if(y&&u.length>0){if(y==="font-weight"&&u==="700")u="bold";else if(y==="color"||y==="background-color")u=
u.toLowerCase();u=u.replace(c,a);u=u.replace(e,function(C,F,K,L,M,W){if(M=M||W){M=s(M);return"'"+M.replace(/\'/g,"\\'")+"'"}F=s(F||K||L);if(z)F=z.call(A,F,"style");return"url('"+F.replace(/\'/g,"\\'")+"')"});r[y]=v?s(u,true):u}b.lastIndex=t.index+t[0].length}p("border","");p("border","-width");p("border","-color");p("border","-style");p("padding","");p("margin","");n("border","border-width","border-style","border-color");r.border==="medium none"&&delete r.border}return r},serialize:function(o,p){function m(s){var r,
t,y,u;if(r=d.styles[s]){t=0;for(y=r.length;t<y;t++){s=r[t];u=o[s];if(u!==void 0&&u.length>0)n+=(n.length>0?" ":"")+s+": "+u+";"}}}var n="",q;if(p&&d&&d.styles){m("*");m(q)}else for(q in o){p=o[q];if(p!==void 0&&p.length>0)n+=(n.length>0?" ":"")+q+": "+p+";"}return n}}};
(function(k){function d(m,n){return m.split(n||",")}function a(m,n){function q(t){return t.replace(/[A-Z]+/g,function(y){return q(m[y])})}var s,r={};for(s in m)if(m.hasOwnProperty(s))m[s]=q(m[s]);q(n).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(t,y,u,v){u=d(u,"|");r[y]={attributes:o(u),attributesOrder:u,children:o(v,"|",{"#comment":{}})}});return r}var c={},e,b,f,h,g,l,o=k.makeMap,p=k.each;b="h1,h2,h3,h4,h5,h6,hr,p,div,address,pre,form,table,tbody,thead,tfoot,th,tr,td,li,ol,ul,caption,blockquote,center,dl,dt,dd,dir,fieldset,noscript,menu,isindex,samp,header,footer,article,section,hgroup";
b=o(b,",",o(b.toUpperCase()));c=a({Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",
P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"},"script[id|charset|type|language|src|defer|xml:space][]style[B|id|type|media|title|xml:space][]object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]param[id|name|value|valuetype|type][]p[E|align][#|S]a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]br[A|clear][]span[E][#|S]bdo[A|C|B][#|S]applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]h1[E|align][#|S]img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]map[B|C|A|name][X|form|Q|area]h2[E|align][#|S]iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]h3[E|align][#|S]tt[E][#|S]i[E][#|S]b[E][#|S]u[E][#|S]s[E][#|S]strike[E][#|S]big[E][#|S]small[E][#|S]font[A|B|size|color|face][#|S]basefont[id|size|color|face][]em[E][#|S]strong[E][#|S]dfn[E][#|S]code[E][#|S]q[E|cite][#|S]samp[E][#|S]kbd[E][#|S]var[E][#|S]cite[E][#|S]abbr[E][#|S]acronym[E][#|S]sub[E][#|S]sup[E][#|S]input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]optgroup[E|disabled|label][option]option[E|selected|disabled|label|value][]textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]label[E|for|accesskey|onfocus|onblur][#|S]button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[E|align][#|S]ins[E|cite|datetime][#|Y]h5[E|align][#|S]del[E|cite|datetime][#|Y]h6[E|align][#|S]div[E|align][#|Y]ul[E|type|compact][li]li[E|type|value][#|Y]ol[E|type|compact|start][li]dl[E|compact][dt|dd]dt[E][#|S]dd[E][#|Y]menu[E|compact][li]dir[E|compact][li]pre[E|width|xml:space][#|ZA]hr[E|align|noshade|size|width][]blockquote[E|cite][#|Y]address[E][#|S|p]center[E][#|Y]noframes[E][#|Y]isindex[A|B|prompt][]fieldset[E][#|legend|Y]legend[E|accesskey|align][#|S]table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]caption[E|align][#|S]col[ZG][]colgroup[ZG][col]thead[ZF][tr]tr[ZF|bgcolor][th|td]th[E|ZE][#|Y]form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]noscript[E][#|Y]td[E|ZE][#|Y]tfoot[ZF][tr]tbody[ZF][tr]area[E|D|shape|coords|href|nohref|alt|target][]base[id|href|target][]body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]");
e=o("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected,preload,autoplay,loop,controls");f=o("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed,source");h=k.extend(o("td,th,iframe,video,object"),f);g=o("pre,script,style");l=o("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");k.html.Schema=function(m){function n(A){return new RegExp("^"+A.replace(/([?+*])/g,".$1")+"$")}function q(A){var C,F,K,L,M,W,X,D,N,H,ha,ja,Z,ba,ca,
ka,ma,da,fa=/^([#+-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,oa=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,la=/[*?+]/;if(A){A=d(A);if(y["@"]){ka=y["@"].attributes;ma=y["@"].attributesOrder}C=0;for(F=A.length;C<F;C++)if(M=fa.exec(A[C])){ba=M[1];N=M[2];ca=M[3];D=M[4];ja={};Z=[];W={attributes:ja,attributesOrder:Z};if(ba==="#")W.paddEmpty=true;if(ba==="-")W.removeEmpty=true;if(ka){for(da in ka)ja[da]=ka[da];Z.push.apply(Z,ma)}if(D){D=d(D,"|");K=0;for(L=D.length;K<L;K++)if(M=oa.exec(D[K])){X=
{};ha=M[1];H=M[2].replace(/::/g,":");ba=M[3];M=M[4];if(ha==="!"){W.attributesRequired=W.attributesRequired||[];W.attributesRequired.push(H);X.required=true}if(ha==="-"){delete ja[H];Z.splice(k.inArray(Z,H),1)}else{if(ba){if(ba==="="){W.attributesDefault=W.attributesDefault||[];W.attributesDefault.push({name:H,value:M});X.defaultValue=M}if(ba===":"){W.attributesForced=W.attributesForced||[];W.attributesForced.push({name:H,value:M});X.forcedValue=M}if(ba==="<")X.validValues=o(M,"?")}if(la.test(H)){W.attributePatterns=
W.attributePatterns||[];X.pattern=n(H);W.attributePatterns.push(X)}else{ja[H]||Z.push(H);ja[H]=X}}}}if(!ka&&N=="@"){ka=ja;ma=Z}if(ca){W.outputName=N;y[ca]=W}if(la.test(N)){W.pattern=n(N);v.push(W)}else y[N]=W}}}function s(A){y={};v=[];q(A);p(c,function(C,F){u[F]=C.children})}function r(A){var C=/^(~)?(.+)$/;A&&p(d(A),function(F){F=C.exec(F);var K=F[1]==="~"?"span":"div",L=F[2];u[L]=u[K];p(u,function(M){if(M[K])M[L]=M[K]})})}function t(A){var C=/^([+\-]?)(\w+)\[([^\]]+)\]$/;A&&p(d(A),function(F){F=
C.exec(F);var K,L;if(F){K=(L=F[1])?u[F[2]]:(u[F[2]]={"#comment":{}});K=u[F[2]];p(d(F[3],"|"),function(M){if(L==="-")delete K[M];else K[M]={}})}})}var y={},u={},v=[],z;m=m||{};if(m.verify_html===false)m.valid_elements="*[*]";if(m.valid_styles){z={};p(m.valid_styles,function(A,C){z[C]=k.explode(A)})}if(m.valid_elements)s(m.valid_elements);else{p(c,function(A,C){y[C]={attributes:A.attributes,attributesOrder:A.attributesOrder};u[C]=A.children});p(d("strong/b,em/i"),function(A){A=d(A,"/");y[A[1]].outputName=
A[0]});y.img.attributesDefault=[{name:"alt",value:""}];p(d("ol,ul,li,sub,sup,blockquote,tr,div,span,font,a,table,tbody"),function(A){y[A].removeEmpty=true});p(d("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(A){y[A].paddEmpty=true})}r(m.custom_elements);t(m.valid_children);q(m.extended_valid_elements);t("+ol[ul|ol],+ul[ul|ol]");m.invalid_elements&&k.each(k.explode(m.invalid_elements),function(A){y[A]&&delete y[A]});this.children=u;this.styles=z;this.getBoolAttrs=function(){return e};
this.getBlockElements=function(){return b};this.getShortEndedElements=function(){return f};this.getSelfClosingElements=function(){return l};this.getNonEmptyElements=function(){return h};this.getWhiteSpaceElements=function(){return g};this.isValidChild=function(A,C){A=u[A];return!!(A&&A[C])};this.getElementRule=function(A){var C=y[A],F;if(C)return C;for(F=v.length;F--;){C=v[F];if(C.pattern.test(A))return C}};this.addValidElements=q;this.setValidElements=s;this.addCustomElements=r;this.addValidChildren=
t};k.html.Schema.boolAttrMap=e;k.html.Schema.blockElementsMap=b})(tinymce);
(function(k){k.html.SaxParser=function(d,a){var c=this,e=function(){};d=d||{};c.schema=a=a||new k.html.Schema;if(d.fix_self_closing!==false)d.fix_self_closing=true;k.each("comment cdata text start end pi doctype".split(" "),function(b){if(b)c[b]=d[b]||e});c.parse=function(b){function f(Z){var ba,ca;for(ba=m.length;ba--;)if(m[ba].name===Z)break;if(ba>=0){for(ca=m.length-1;ca>=ba;ca--){Z=m[ca];Z.valid&&h.end(Z.name)}m.length=ba}}var h=this,g,l=0,o,p,m=[],n,q,s,r,t,y,u,v,z,A,C,F,K,L,M,W,X,D,N,H=0,ha=
k.html.Entities.decode,ja;X=new RegExp("<(?:(?:!--([\\w\\W]*?)--\>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([^\\s\\/<>]+)\\s*((?:[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*)>))","g");D=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;N={script:/<\/script[^>]*>/gi,style:/<\/style[^>]*>/gi,noscript:/<\/noscript[^>]*>/gi};r=a.getShortEndedElements();W=a.getSelfClosingElements();
t=a.getBoolAttrs();y=d.validate;for(ja=d.fix_self_closing;g=X.exec(b);){l<g.index&&h.text(ha(b.substr(l,g.index-l)));if(o=g[6])f(o.toLowerCase());else if(o=g[7]){o=o.toLowerCase();l=o in r;ja&&W[o]&&m.length>0&&m[m.length-1].name===o&&f(o);if(!y||(u=a.getElementRule(o))){v=true;if(y){C=u.attributes;F=u.attributePatterns}if(A=g[8]){n=[];n.map={};A.replace(D,function(Z,ba,ca,ka,ma){ba=ba.toLowerCase();ca=ba in t?ba:ha(ca||ka||ma||"");if(y&&ba.indexOf("data-")!==0){Z=C[ba];if(!Z&&F){for(ka=F.length;ka--;){Z=
F[ka];if(Z.pattern.test(ba))break}if(ka===-1)Z=null}if(!Z)return;if(Z.validValues&&!(ca in Z.validValues))return}n.map[ba]=ca;n.push({name:ba,value:ca})})}else{n=[];n.map={}}if(y){K=u.attributesRequired;L=u.attributesDefault;if(M=u.attributesForced)for(p=M.length;p--;){z=M[p];s=z.name;z=z.value;if(z==="{$uid}")z="mce_"+H++;n.map[s]=z;n.push({name:s,value:z})}if(L)for(p=L.length;p--;){z=L[p];s=z.name;if(!(s in n.map)){z=z.value;if(z==="{$uid}")z="mce_"+H++;n.map[s]=z;n.push({name:s,value:z})}}if(K){for(p=
K.length;p--;)if(K[p]in n.map)break;if(p===-1)v=false}if(n.map["data-mce-bogus"])v=false}v&&h.start(o,n,l)}else v=false;if(p=N[o]){p.lastIndex=l=g.index+g[0].length;if(g=p.exec(b)){if(v)q=b.substr(l,g.index-l);l=g.index+g[0].length}else{q=b.substr(l);l=b.length}v&&q.length>0&&h.text(q,true);v&&h.end(o);X.lastIndex=l;continue}if(!l)if(!A||A.indexOf("/")!=A.length-1)m.push({name:o,valid:v});else v&&h.end(o)}else if(o=g[1])h.comment(o);else if(o=g[2])h.cdata(o);else if(o=g[3])h.doctype(o);else if(o=
g[4])h.pi(o,g[5]);l=g.index+g[0].length}l<b.length&&h.text(ha(b.substr(l)));for(p=m.length-1;p>=0;p--){o=m[p];o.valid&&h.end(o.name)}}}})(tinymce);
(function(k){function d(b,f,h){var g;g=h?"lastChild":"firstChild";h=h?"prev":"next";if(b[g])return b[g];if(b!==f){if(g=b[h])return g;for(b=b.parent;b&&b!==f;b=b.parent)if(g=b[h])return g}}function a(b,f){this.name=b;this.type=f;if(f===1){this.attributes=[];this.attributes.map={}}}var c=/^[ \t\r\n]*$/,e={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};k.extend(a.prototype,{replace:function(b){b.parent&&b.remove();this.insert(b,this);this.remove();return this},attr:function(b,
f){var h,g;if(typeof b!=="string"){for(g in b)this.attr(g,b[g]);return this}if(h=this.attributes)if(f!==void 0){if(f===null){if(b in h.map){delete h.map[b];for(g=h.length;g--;)if(h[g].name===b){h.splice(g,1);return this}}return this}if(b in h.map)for(g=h.length;g--;){if(h[g].name===b){h[g].value=f;break}}else h.push({name:b,value:f});h.map[b]=f;return this}else return h.map[b]},clone:function(){var b=new a(this.name,this.type),f,h,g,l,o;if(g=this.attributes){o=[];o.map={};f=0;for(h=g.length;f<h;f++){l=
g[f];if(l.name!=="id"){o[o.length]={name:l.name,value:l.value};o.map[l.name]=l.value}}b.attributes=o}b.value=this.value;b.shortEnded=this.shortEnded;return b},wrap:function(b){this.parent.insert(b,this);b.append(this);return this},unwrap:function(){var b,f;for(b=this.firstChild;b;){f=b.next;this.insert(b,this,true);b=f}this.remove()},remove:function(){var b=this.parent,f=this.next,h=this.prev;if(b){if(b.firstChild===this){if(b.firstChild=f)f.prev=null}else h.next=f;if(b.lastChild===this){if(b.lastChild=
h)h.next=null}else f.prev=h;this.parent=this.next=this.prev=null}return this},append:function(b){var f;b.parent&&b.remove();if(f=this.lastChild){f.next=b;b.prev=f;this.lastChild=b}else this.lastChild=this.firstChild=b;b.parent=this;return b},insert:function(b,f,h){var g;b.parent&&b.remove();g=f.parent||this;if(h){if(f===g.firstChild)g.firstChild=b;else f.prev.next=b;b.prev=f.prev;b.next=f;f.prev=b}else{if(f===g.lastChild)g.lastChild=b;else f.next.prev=b;b.next=f.next;b.prev=f;f.next=b}b.parent=g;
return b},getAll:function(b){var f,h=[];for(f=this.firstChild;f;f=d(f,this))f.name===b&&h.push(f);return h},empty:function(){var b,f,h;if(this.firstChild){b=[];for(h=this.firstChild;h;h=d(h,this))b.push(h);for(f=b.length;f--;){h=b[f];h.parent=h.firstChild=h.lastChild=h.next=h.prev=null}}this.firstChild=this.lastChild=null;return this},isEmpty:function(b){var f=this.firstChild,h,g;if(f){do{if(f.type===1){if(f.attributes.map["data-mce-bogus"])continue;if(b[f.name])return false;for(h=f.attributes.length;h--;){g=
f.attributes[h].name;if(g==="name"||g.indexOf("data-")===0)return false}}if(f.type===3&&!c.test(f.value))return false}while(f=d(f,this))}return true}});k.extend(a,{create:function(b,f){var h;b=new a(b,e[b]||1);if(f)for(h in f)b.attr(h,f[h]);return b}});k.html.Node=a})(tinymce);
(function(k){var d=k.html.Node;k.html.DomParser=function(a,c){function e(o){var p,m,n,q,s,r,t,y,u,v,z;v=k.makeMap("tr,td,th,tbody,thead,tfoot,table");u=c.getNonEmptyElements();for(p=0;p<o.length;p++){m=o[p];if(m.parent){q=[m];for(n=m.parent;n&&!c.isValidChild(n.name,m.name)&&!v[n.name];n=n.parent)q.push(n);if(n&&q.length>1){q.reverse();s=r=b.filterNode(q[0].clone());for(y=0;y<q.length-1;y++){if(c.isValidChild(r.name,q[y].name)){t=b.filterNode(q[y].clone());r.append(t)}else t=r;for(r=q[y].firstChild;r&&
r!=q[y+1];){z=r.next;t.append(r);r=z}r=t}if(s.isEmpty(u))n.insert(m,q[0],true);else{n.insert(s,q[0],true);n.insert(m,s)}n=q[0];if(n.isEmpty(u)||n.firstChild===n.lastChild&&n.firstChild.name==="br")n.empty().remove()}else if(m.parent)if(m.name==="li")if((n=m.prev)&&(n.name==="ul"||n.name==="ul"))n.append(m);else(n=m.next)&&(n.name==="ul"||n.name==="ul")?n.insert(m,n.firstChild,true):m.wrap(b.filterNode(new d("ul",1)));else if(c.isValidChild(m.parent.name,"div")&&c.isValidChild("div",m.name))m.wrap(b.filterNode(new d("div",
1)));else m.name==="style"||m.name==="script"?m.empty().remove():m.unwrap()}}}var b=this,f={},h=[],g={},l={};a=a||{};a.validate="validate"in a?a.validate:true;a.root_name=a.root_name||"body";b.schema=c=c||new k.html.Schema;b.filterNode=function(o){var p,m,n;if(m in f)if(n=g[m])n.push(o);else g[m]=[o];for(p=h.length;p--;){m=h[p].name;if(m in o.attributes.map)if(n=l[m])n.push(o);else l[m]=[o]}return o};b.addNodeFilter=function(o,p){k.each(k.explode(o),function(m){var n=f[m];n||(f[m]=n=[]);n.push(p)})};
b.addAttributeFilter=function(o,p){k.each(k.explode(o),function(m){var n;for(n=0;n<h.length;n++)if(h[n].name===m){h[n].callbacks.push(p);return}h.push({name:m,callbacks:[p]})})};b.parse=function(o,p){function m(D,N){N=new d(D,N);var H;if(D in f)if(H=g[D])H.push(N);else g[D]=[N];return N}function n(D){var N;for(D=D.prev;D&&D.type===3;){N=D.value.replace(K,"");if(N.length>0){D.value=N;D=D.prev}else{N=D.prev;D.remove();D=N}}}var q,s,r,t,y,u,v,z,A,C,F=[],K,L,M,W,X;p=p||{};g={};l={};A=k.extend(k.makeMap("script,style,head,html,body,title,meta,param"),
c.getBlockElements());X=c.getNonEmptyElements();W=c.children;z=a.validate;M=c.getWhiteSpaceElements();C=/^[ \t\r\n]+/;K=/[ \t\r\n]+$/;L=/[ \t\r\n]+/g;q=new k.html.SaxParser({validate:z,fix_self_closing:!z,cdata:function(D){r.append(m("#cdata",4)).value=D},text:function(D,N){var H;if(!M[r.name]){D=D.replace(L," ");if(r.lastChild&&A[r.lastChild.name])D=D.replace(C,"")}if(D.length!==0){H=m("#text",3);H.raw=!!N;r.append(H).value=D}},comment:function(D){r.append(m("#comment",8)).value=D},pi:function(D,
N){r.append(m(D,7)).value=N;n(r)},doctype:function(D){r.append(m("#doctype",10)).value=D;n(r)},start:function(D,N,H){var ha,ja,Z;if(ha=z?c.getElementRule(D):{}){ha=m(ha.outputName||D,1);ha.attributes=N;ha.shortEnded=H;r.append(ha);(ja=W[r.name])&&W[ha.name]&&!ja[ha.name]&&F.push(ha);for(ja=h.length;ja--;){Z=h[ja].name;if(Z in N.map)if(v=l[Z])v.push(ha);else l[Z]=[ha]}A[D]&&n(ha);H||(r=ha)}},end:function(D){var N,H;if(N=z?c.getElementRule(D):{}){if(A[D]){if(!M[r.name]){for(D=r.firstChild;D&&D.type===
3;){H=D.value.replace(C,"");if(H.length>0){D.value=H;D=D.next}else{H=D.next;D.remove();D=H}}for(D=r.lastChild;D&&D.type===3;){H=D.value.replace(K,"");if(H.length>0){D.value=H;D=D.prev}else{H=D.prev;D.remove();D=H}}}if((D=r.prev)&&D.type===3){H=D.value.replace(C,"");if(H.length>0)D.value=H;else D.remove()}}if(N.removeEmpty||N.paddEmpty)if(r.isEmpty(X))if(N.paddEmpty)r.empty().append(new d("#text","3")).value="\u00a0";else if(!r.attributes.map.name){N=r.parent;r.empty().remove();r=N;return}r=r.parent}}},
c);s=r=new d(a.root_name,11);q.parse(o);z&&e(F);for(u in g){v=f[u];o=g[u];for(y=o.length;y--;)o[y].parent||o.splice(y,1);q=0;for(t=v.length;q<t;q++)v[q](o,u,p)}q=0;for(t=h.length;q<t;q++){v=h[q];if(v.name in l){o=l[v.name];for(y=o.length;y--;)o[y].parent||o.splice(y,1);y=0;for(u=v.callbacks.length;y<u;y++)v.callbacks[y](o,v.name,p)}}return s};a.remove_trailing_brs&&b.addNodeFilter("br",function(o){var p,m=o.length,n,q=c.getBlockElements(),s=c.getNonEmptyElements(),r,t,y;for(p=0;p<m;p++){n=o[p];r=
n.parent;if(q[n.parent.name]&&n===r.lastChild){for(t=n.prev;t;){y=t.name;if(y!=="span"||t.attr("data-mce-type")!=="bookmark"){if(y!=="br")break;if(y==="br"){n=null;break}}t=t.prev}if(n){n.remove();if(r.isEmpty(s)){elementRule=c.getElementRule(r.name);if(elementRule.removeEmpty)r.remove();else if(elementRule.paddEmpty)r.empty().append(new k.html.Node("#text",3)).value="\u00a0"}}}}})}})(tinymce);
tinymce.html.Writer=function(k){var d=[],a,c,e,b,f;k=k||{};a=k.indent;c=tinymce.makeMap(k.indent_before||"");e=tinymce.makeMap(k.indent_after||"");b=tinymce.html.Entities.getEncodeFunc(k.entity_encoding||"raw",k.entities);f=k.element_format=="html";return{start:function(h,g,l){var o,p,m;if(a&&c[h]&&d.length>0){o=d[d.length-1];o.length>0&&o!=="\n"&&d.push("\n")}d.push("<",h);if(g){o=0;for(p=g.length;o<p;o++){m=g[o];d.push(" ",m.name,'="',b(m.value,true),'"')}}d[d.length]=!l||f?">":" />";if(l&&a&&e[h]&&
d.length>0){o=d[d.length-1];o.length>0&&o!=="\n"&&d.push("\n")}},end:function(h){d.push("</",h,">");if(a&&e[h]&&d.length>0){h=d[d.length-1];h.length>0&&h!=="\n"&&d.push("\n")}},text:function(h,g){if(h.length>0)d[d.length]=g?h:b(h)},cdata:function(h){d.push("<![CDATA[",h,"]]\>")},comment:function(h){d.push("<!--",h,"--\>")},pi:function(h,g){g?d.push("<?",h," ",g,"?>"):d.push("<?",h,"?>");a&&d.push("\n")},doctype:function(h){d.push("<!DOCTYPE",h,">",a?"\n":"")},reset:function(){d.length=0},getContent:function(){return d.join("").replace(/\n$/,
"")}}};
(function(k){k.html.Serializer=function(d,a){var c=new k.html.Writer(d);d=d||{};d.validate="validate"in d?d.validate:true;this.schema=a=a||new k.html.Schema;this.writer=c;this.serialize=function(e){function b(g){var l=f[g.type],o,p,m,n,q,s,r,t;if(l)l(g);else{l=g.name;o=g.shortEnded;p=g.attributes;if(h&&p&&p.length>1){q=[];q.map={};t=a.getElementRule(g.name);s=0;for(r=t.attributesOrder.length;s<r;s++){m=t.attributesOrder[s];if(m in p.map){n=p.map[m];q.map[m]=n;q.push({name:m,value:n})}}s=0;for(r=p.length;s<
r;s++){m=p[s].name;if(!(m in q.map)){n=p.map[m];q.map[m]=n;q.push({name:m,value:n})}}p=q}c.start(g.name,p,o);if(!o){if(g=g.firstChild){do b(g);while(g=g.next)}c.end(l)}}}var f,h;h=d.validate;f={3:function(g){c.text(g.value,g.raw)},8:function(g){c.comment(g.value)},7:function(g){c.pi(g.name,g.value)},10:function(g){c.doctype(g.value)},4:function(g){c.cdata(g.value)},11:function(g){if(g=g.firstChild){do b(g);while(g=g.next)}}};c.reset();e.type==1&&!d.inner?b(e):f[11](e);return c.getContent()}}})(tinymce);
(function(k){var d=k.each,a=k.is,c=k.isWebKit,e=k.isIE,b=k.html.Entities,f=k.html.Schema.blockElementsMap,h=/^[ \t\r\n]*$/;k.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},DOMUtils:function(g,l){this.doc=g;this.win=
window;this.files={};this.cssFlicker=false;this.counter=0;this.stdMode=!k.isIE||g.documentMode>=8;this.boxModel=!k.isIE||g.compatMode=="CSS1Compat"||this.stdMode;this.hasOuterHTML="outerHTML"in g.createElement("a");this.settings=l=k.extend({keep_values:false,hex_colors:1},l);this.schema=l.schema;this.styles=new k.html.Styles({url_converter:l.url_converter,url_converter_scope:l.url_converter_scope},l.schema);if(k.isIE6)try{g.execCommand("BackgroundImageCache",false,true)}catch(o){this.cssFlicker=true}e&&
"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(p){g.createElement(p)});k.addUnload(this.destroy,this)},getRoot:function(){var g=this.settings;return g&&this.get(g.root_element)||this.doc.body},getViewPort:function(g){var l;g=!g?this.win:g;l=g.document;l=this.boxModel?l.documentElement:l.body;return{x:g.pageXOffset||l.scrollLeft,y:g.pageYOffset||l.scrollTop,w:g.innerWidth||l.clientWidth,
h:g.innerHeight||l.clientHeight}},getRect:function(g){var l;g=this.get(g);l=this.getPos(g);g=this.getSize(g);return{x:l.x,y:l.y,w:g.w,h:g.h}},getSize:function(g){var l,o;g=this.get(g);l=this.getStyle(g,"width");o=this.getStyle(g,"height");if(l.indexOf("px")===-1)l=0;if(o.indexOf("px")===-1)o=0;return{w:parseInt(l)||g.offsetWidth||g.clientWidth,h:parseInt(o)||g.offsetHeight||g.clientHeight}},getParent:function(g,l,o){return this.getParents(g,l,o,false)},getParents:function(g,l,o,p){var m=this,n,q=
m.settings,s=[];g=m.get(g);p=p===undefined;if(q.strict_root)o=o||m.getRoot();if(a(l,"string")){n=l;l=l==="*"?function(r){return r.nodeType==1}:function(r){return m.is(r,n)}}for(;g;){if(g==o||!g.nodeType||g.nodeType===9)break;if(!l||l(g))if(p)s.push(g);else return g;g=g.parentNode}return p?s:null},get:function(g){var l;if(g&&this.doc&&typeof g=="string"){l=g;if((g=this.doc.getElementById(g))&&g.id!==l)return this.doc.getElementsByName(l)[1]}return g},getNext:function(g,l){return this._findSib(g,l,
"nextSibling")},getPrev:function(g,l){return this._findSib(g,l,"previousSibling")},add:function(g,l,o,p,m){var n=this;return this.run(g,function(q){var s;s=a(l,"string")?n.doc.createElement(l):l;n.setAttribs(s,o);if(p)p.nodeType?s.appendChild(p):n.setHTML(s,p);return!m?q.appendChild(s):s})},create:function(g,l,o){return this.add(this.doc.createElement(g),g,l,o,1)},createHTML:function(g,l,o){var p="",m;p+="<"+g;for(m in l)if(l.hasOwnProperty(m))p+=" "+m+'="'+this.encode(l[m])+'"';if(typeof o!="undefined")return p+
">"+o+"</"+g+">";return p+" />"},remove:function(g,l){return this.run(g,function(o){var p,m=o.parentNode;if(!m)return null;if(l)for(;p=o.firstChild;)!k.isIE||p.nodeType!==3||p.nodeValue?m.insertBefore(p,o):o.removeChild(p);return m.removeChild(o)})},setStyle:function(g,l,o){var p=this;return p.run(g,function(m){var n;n=m.style;l=l.replace(/-(\D)/g,function(q,s){return s.toUpperCase()});if(p.pixelStyles.test(l)&&(k.is(o,"number")||/^[\-0-9\.]+$/.test(o)))o+="px";switch(l){case "opacity":if(e){n.filter=
o===""?"":"alpha(opacity="+o*100+")";if(!g.currentStyle||!g.currentStyle.hasLayout)n.display="inline-block"}n[l]=n["-moz-opacity"]=n["-khtml-opacity"]=o||"";break;case "float":e?(n.styleFloat=o):(n.cssFloat=o);break;default:n[l]=o||""}p.settings.update_styles&&p.setAttrib(m,"data-mce-style")})},getStyle:function(g,l,o){if(g=this.get(g)){if(this.doc.defaultView&&o){l=l.replace(/[A-Z]/g,function(m){return"-"+m});try{return this.doc.defaultView.getComputedStyle(g,null).getPropertyValue(l)}catch(p){return null}}l=
l.replace(/-(\D)/g,function(m,n){return n.toUpperCase()});if(l=="float")l=e?"styleFloat":"cssFloat";if(g.currentStyle&&o)return g.currentStyle[l];return g.style?g.style[l]:undefined}},setStyles:function(g,l){var o=this,p=o.settings,m;m=p.update_styles;p.update_styles=0;d(l,function(n,q){o.setStyle(g,q,n)});p.update_styles=m;p.update_styles&&o.setAttrib(g,p.cssText)},removeAllAttribs:function(g){return this.run(g,function(l){var o,p=l.attributes;for(o=p.length-1;o>=0;o--)l.removeAttributeNode(p.item(o))})},
setAttrib:function(g,l,o){var p=this;if(g&&l){if(p.settings.strict)l=l.toLowerCase();return this.run(g,function(m){var n=p.settings;switch(l){case "style":if(!a(o,"string")){d(o,function(q,s){p.setStyle(m,s,q)});return}if(n.keep_values)o&&!p._isRes(o)?m.setAttribute("data-mce-style",o,2):m.removeAttribute("data-mce-style",2);m.style.cssText=o;break;case "class":m.className=o||"";break;case "src":case "href":if(n.keep_values){if(n.url_converter)o=n.url_converter.call(n.url_converter_scope||p,o,l,m);
p.setAttrib(m,"data-mce-"+l,o,2)}break;case "shape":m.setAttribute("data-mce-style",o);break}a(o)&&o!==null&&o.length!==0?m.setAttribute(l,""+o,2):m.removeAttribute(l,2)})}},setAttribs:function(g,l){var o=this;return this.run(g,function(p){d(l,function(m,n){o.setAttrib(p,n,m)})})},getAttrib:function(g,l,o){var p;g=this.get(g);if(!g||g.nodeType!==1)return false;a(o)||(o="");if(/^(src|href|style|coords|shape)$/.test(l))if(p=g.getAttribute("data-mce-"+l))return p;if(e&&this.props[l])p=(p=g[this.props[l]])&&
p.nodeValue?p.nodeValue:p;p||(p=g.getAttribute(l,2));if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(l)){if(g[this.props[l]]===true&&p==="")return l;return p?l:""}if(g.nodeName==="FORM"&&g.getAttributeNode(l))return g.getAttributeNode(l).nodeValue;if(l==="style")if(p=p||g.style.cssText){p=this.serializeStyle(this.parseStyle(p),g.nodeName);this.settings.keep_values&&!this._isRes(p)&&g.setAttribute("data-mce-style",p)}if(c&&l==="class"&&p)p=
p.replace(/(apple|webkit)\-[a-z\-]+/gi,"");if(e)switch(l){case "rowspan":case "colspan":if(p===1)p="";break;case "size":if(p==="+0"||p===20||p===0)p="";break;case "width":case "height":case "vspace":case "checked":case "disabled":case "readonly":if(p===0)p="";break;case "hspace":if(p===-1)p="";break;case "maxlength":case "tabindex":if(p===32768||p===2147483647||p==="32768")p="";break;case "multiple":case "compact":case "noshade":case "nowrap":if(p===65535)return l;return o;case "shape":p=p.toLowerCase();
break;default:if(l.indexOf("on")===0&&p)p=k._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+p)}return p!==undefined&&p!==null&&p!==""?""+p:o},getPos:function(g,l){var o=0,p=0,m=this.doc;g=this.get(g);l=l||m.body;if(g){if(e&&!this.stdMode){g=g.getBoundingClientRect();l=this.boxModel?m.documentElement:m.body;o=this.getStyle(this.select("html")[0],"borderWidth");o=(o=="medium"||this.boxModel&&!this.isIE6)&&2||o;return{x:g.left+l.scrollLeft-o,y:g.top+l.scrollTop-o}}for(m=g;m&&m!=l&&m.nodeType;){o+=
m.offsetLeft||0;p+=m.offsetTop||0;m=m.offsetParent}for(m=g.parentNode;m&&m!=l&&m.nodeType;){o-=m.scrollLeft||0;p-=m.scrollTop||0;m=m.parentNode}}return{x:o,y:p}},parseStyle:function(g){return this.styles.parse(g)},serializeStyle:function(g,l){return this.styles.serialize(g,l)},loadCSS:function(g){var l=this,o=l.doc,p;g||(g="");p=l.select("head")[0];d(g.split(","),function(m){var n;if(!l.files[m]){l.files[m]=true;n=l.create("link",{rel:"stylesheet",href:k._addVer(m)});if(e&&o.documentMode&&o.recalc)n.onload=
function(){o.recalc&&o.recalc();n.onload=null};p.appendChild(n)}})},addClass:function(g,l){return this.run(g,function(o){var p;if(!l)return 0;if(this.hasClass(o,l))return o.className;p=this.removeClass(o,l);return o.className=(p!=""?p+" ":"")+l})},removeClass:function(g,l){var o=this,p;return o.run(g,function(m){var n;if(o.hasClass(m,l)){p||(p=new RegExp("(^|\\s+)"+l+"(\\s+|$)","g"));n=m.className.replace(p," ");n=k.trim(n!=" "?n:"");m.className=n;if(!n){m.removeAttribute("class");m.removeAttribute("className")}return n}return m.className})},
hasClass:function(g,l){g=this.get(g);if(!g||!l)return false;return(" "+g.className+" ").indexOf(" "+l+" ")!==-1},show:function(g){return this.setStyle(g,"display","block")},hide:function(g){return this.setStyle(g,"display","none")},isHidden:function(g){g=this.get(g);return!g||g.style.display=="none"||this.getStyle(g,"display")=="none"},uniqueId:function(g){return(!g?"mce_":g)+this.counter++},setHTML:function(g,l){var o=this;return o.run(g,function(p){if(e){for(;p.firstChild;)p.removeChild(p.firstChild);
try{p.innerHTML="<br />"+l;p.removeChild(p.firstChild)}catch(m){p=o.create("div");p.innerHTML="<br />"+l;d(p.childNodes,function(n,q){q&&p.appendChild(n)})}}else p.innerHTML=l;return l})},getOuterHTML:function(g){var l;g=this.get(g);if(!g)return null;if(g.nodeType===1&&this.hasOuterHTML)return g.outerHTML;l=(g.ownerDocument||this.doc).createElement("body");l.appendChild(g.cloneNode(true));return l.innerHTML},setOuterHTML:function(g,l,o){function p(n,q,s){s=s.createElement("body");s.innerHTML=q;for(q=
s.lastChild;q;){m.insertAfter(q.cloneNode(true),n);q=q.previousSibling}m.remove(n)}var m=this;return this.run(g,function(n){n=m.get(n);if(n.nodeType==1){o=o||n.ownerDocument||m.doc;if(e)try{if(e&&n.nodeType==1)n.outerHTML=l;else p(n,l,o)}catch(q){p(n,l,o)}else p(n,l,o)}})},decode:b.decode,encode:b.encodeAllRaw,insertAfter:function(g,l){l=this.get(l);return this.run(g,function(o){var p,m;p=l.parentNode;(m=l.nextSibling)?p.insertBefore(o,m):p.appendChild(o);return o})},isBlock:function(g){var l=g.nodeType;
if(l)return!!(l===1&&f[g.nodeName]);return!!f[g]},replace:function(g,l,o){if(a(l,"array"))g=g.cloneNode(true);return this.run(l,function(p){o&&d(k.grep(p.childNodes),function(m){g.appendChild(m)});return p.parentNode.replaceChild(g,p)})},rename:function(g,l){var o=this,p;if(g.nodeName!=l.toUpperCase()){p=o.create(l);d(o.getAttribs(g),function(m){o.setAttrib(p,m.nodeName,o.getAttrib(g,m.nodeName))});o.replace(p,g,1)}return p||g},findCommonAncestor:function(g,l){for(var o=g,p;o;){for(p=l;p&&o!=p;)p=
p.parentNode;if(o==p)break;o=o.parentNode}if(!o&&g.ownerDocument)return g.ownerDocument.documentElement;return o},toHex:function(g){function l(p){p=parseInt(p).toString(16);return p.length>1?p:"0"+p}var o=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(g);if(o)return g="#"+l(o[1])+l(o[2])+l(o[3]);return g},getClasses:function(){function g(q){d(q.imports,function(s){g(s)});d(q.cssRules||q.rules,function(s){switch(s.type||1){case 1:s.selectorText&&d(s.selectorText.split(","),
function(r){r=r.replace(/^\s*|\s*$|^\s\./g,"");if(!(/\.mce/.test(r)||!/\.[\w\-]+$/.test(r))){m=r;r=k._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",r);if(!(p&&!(r=p(r,m))))if(!o[r]){l.push({"class":r});o[r]=1}}});break;case 3:g(s.styleSheet);break}})}var l=[],o={},p=this.settings.class_filter,m;if(this.classes)return this.classes;try{d(this.doc.styleSheets,g)}catch(n){}if(l.length>0)this.classes=l;return l},run:function(g,l,o){var p=this,m;if(p.doc&&typeof g==="string")g=p.get(g);if(!g)return false;o=o||this;
if(!g.nodeType&&(g.length||g.length===0)){m=[];d(g,function(n,q){if(n){if(typeof n=="string")n=p.doc.getElementById(n);m.push(l.call(o,n,q))}});return m}return l.call(o,g)},getAttribs:function(g){var l;g=this.get(g);if(!g)return[];if(e){l=[];if(g.nodeName=="OBJECT")return g.attributes;g.nodeName==="OPTION"&&this.getAttrib(g,"selected")&&l.push({specified:1,nodeName:"selected"});g.cloneNode(false).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(o){l.push({specified:1,
nodeName:o})});return l}return g.attributes},isEmpty:function(g,l){var o,p,m,n;if(g=g.firstChild){m=new k.dom.TreeWalker(g);l=l||this.schema?this.schema.getNonEmptyElements():null;do{p=g.nodeType;if(p===1){if(g.getAttribute("data-mce-bogus"))continue;if(l&&l[g.nodeName.toLowerCase()])return false;this.getAttribs(g);for(o=g.attributes.length;o--;){n=g.attributes[o].nodeName;if(n==="name"||n.indexOf("data-")===0)return false}}if(p===3&&!h.test(g.nodeValue))return false}while(g=m.next())}return true},
destroy:function(g){this.events&&this.events.destroy();this.win=this.doc=this.root=this.events=null;g||k.removeUnload(this.destroy)},createRng:function(){var g=this.doc;return g.createRange?g.createRange():new k.dom.Range(this)},nodeIndex:function(g,l){var o=0,p,m,n;if(g){p=g.nodeType;for(g=g.previousSibling;g;g=g.previousSibling){m=g.nodeType;if(l&&m==3){n=false;try{n=g.nodeValue.length}catch(q){}if(m==p||!n)continue}o++;p=m}}return o},split:function(g,l,o){function p(r){var t,y=r.childNodes,u=r.nodeType;
if(!(u==1&&r.getAttribute("data-mce-type")=="bookmark")){for(t=y.length-1;t>=0;t--)p(y[t]);if(u!=9){if(u==3&&r.nodeValue.length>0){if(!m.isBlock(r.parentNode)||k.trim(r.nodeValue).length>0)return}else if(u==1){y=r.childNodes;y.length==1&&y[0]&&y[0].nodeType==1&&y[0].getAttribute("data-mce-type")=="bookmark"&&r.parentNode.insertBefore(y[0],r);if(y.length||/^(br|hr|input|img)$/i.test(r.nodeName))return}m.remove(r)}return r}}var m=this,n=m.createRng(),q,s;if(g&&l){n.setStart(g.parentNode,m.nodeIndex(g));
n.setEnd(l.parentNode,m.nodeIndex(l));q=n.extractContents();n=m.createRng();n.setStart(l.parentNode,m.nodeIndex(l)+1);n.setEnd(g.parentNode,m.nodeIndex(g)+1);n=n.extractContents();s=g.parentNode;s.insertBefore(p(q),g);o?s.replaceChild(o,l):s.insertBefore(l,g);s.insertBefore(p(n),g);m.remove(g);return o||l}},bind:function(g,l,o,p){if(!this.events)this.events=new k.dom.EventUtils;return this.events.add(g,l,o,p||this)},unbind:function(g,l,o){if(!this.events)this.events=new k.dom.EventUtils;return this.events.remove(g,
l,o)},_findSib:function(g,l,o){var p=this,m=l;if(g){if(a(m,"string"))m=function(n){return p.is(n,l)};for(g=g[o];g;g=g[o])if(m(g))return g}return null},_isRes:function(g){return/^(top|left|bottom|right|width|height)/i.test(g)||/;\s*(top|left|bottom|right|width|height)/i.test(g)}});k.DOM=new k.dom.DOMUtils(document,{process_html:0})})(tinymce);
(function(k){function d(a){function c(I,x){A(ca,I,x)}function e(I,x){A(ka,I,x)}function b(I){c(I.parentNode,ra(I))}function f(I){c(I.parentNode,ra(I)+1)}function h(I){e(I.parentNode,ra(I))}function g(I){e(I.parentNode,ra(I)+1)}function l(I){if(I){H[fa]=H[da];H[oa]=H[ma]}else{H[da]=H[fa];H[ma]=H[oa]}H.collapsed=ca}function o(I){b(I);g(I)}function p(I){c(I,0);e(I,I.nodeType===1?I.childNodes.length:I.nodeValue.length)}function m(I,x){var B=H[da],E=H[ma],G=H[fa],J=H[oa],R=x.startContainer,O=x.startOffset,
V=x.endContainer;x=x.endOffset;if(I===0)return z(B,E,R,O);if(I===1)return z(G,J,R,O);if(I===2)return z(G,J,V,x);if(I===3)return z(B,E,V,x)}function n(){C(ba)}function q(){return C(ja)}function s(){return C(Z)}function r(I){var x=this[da],B=this[ma],E;if((x.nodeType===3||x.nodeType===4)&&x.nodeValue)if(B)if(B>=x.nodeValue.length)a.insertAfter(I,x);else{B=x.splitText(B);x.parentNode.insertBefore(I,B)}else x.parentNode.insertBefore(I,x);else{if(x.childNodes.length>0)E=x.childNodes[B];E?x.insertBefore(I,
E):x.appendChild(I)}}function t(I){var x=H.extractContents();H.insertNode(I);I.appendChild(x);H.selectNode(I)}function y(){return la(new d(a),{startContainer:H[da],startOffset:H[ma],endContainer:H[fa],endOffset:H[oa],collapsed:H.collapsed,commonAncestorContainer:H.commonAncestorContainer})}function u(I,x){var B;if(I.nodeType==3)return I;if(x<0)return I;for(B=I.firstChild;B&&x>0;){--x;B=B.nextSibling}if(B)return B;return I}function v(){return H[da]==H[fa]&&H[ma]==H[oa]}function z(I,x,B,E){var G,J;
if(I==B){if(x==E)return 0;if(x<E)return-1;return 1}for(G=B;G&&G.parentNode!=I;)G=G.parentNode;if(G){J=0;for(B=I.firstChild;B!=G&&J<x;){J++;B=B.nextSibling}if(x<=J)return-1;return 1}for(G=I;G&&G.parentNode!=B;)G=G.parentNode;if(G){J=0;for(B=B.firstChild;B!=G&&J<E;){J++;B=B.nextSibling}if(J<E)return-1;return 1}x=a.findCommonAncestor(I,B);for(I=I;I&&I.parentNode!=x;)I=I.parentNode;I||(I=x);for(E=B;E&&E.parentNode!=x;)E=E.parentNode;E||(E=x);if(I==E)return 0;for(B=x.firstChild;B;){if(B==I)return-1;if(B==
E)return 1;B=B.nextSibling}}function A(I,x,B){if(I){H[da]=x;H[ma]=B}else{H[fa]=x;H[oa]=B}for(x=H[fa];x.parentNode;)x=x.parentNode;for(B=H[da];B.parentNode;)B=B.parentNode;if(B==x)z(H[da],H[ma],H[fa],H[oa])>0&&H.collapse(I);else H.collapse(I);H.collapsed=v();H.commonAncestorContainer=a.findCommonAncestor(H[da],H[fa])}function C(I){var x,B=0,E=0,G;if(H[da]==H[fa])return F(I);x=H[fa];for(G=x.parentNode;G;x=G,G=G.parentNode){if(G==H[da])return K(x,I);++B}x=H[da];for(G=x.parentNode;G;x=G,G=G.parentNode){if(G==
H[fa])return L(x,I);++E}E=E-B;for(x=H[da];E>0;){x=x.parentNode;E--}for(B=H[fa];E<0;){B=B.parentNode;E++}E=x.parentNode;for(G=B.parentNode;E!=G;E=E.parentNode,G=G.parentNode){x=E;B=G}return M(x,B,I)}function F(I){var x,B,E,G;if(I!=ba)x=ha.createDocumentFragment();if(H[ma]==H[oa])return x;if(H[da].nodeType==3){B=H[da].nodeValue;B=B.substring(H[ma],H[oa]);if(I!=Z){H[da].deleteData(H[ma],H[oa]-H[ma]);H.collapse(ca)}if(I==ba)return;x.appendChild(ha.createTextNode(B));return x}E=u(H[da],H[ma]);for(B=H[oa]-
H[ma];B>0;){G=E.nextSibling;E=N(E,I);x&&x.appendChild(E);--B;E=G}I!=Z&&H.collapse(ca);return x}function K(I,x){var B,E,G,J;if(x!=ba)B=ha.createDocumentFragment();E=W(I,x);B&&B.appendChild(E);G=ra(I)-H[ma];if(G<=0){if(x!=Z){H.setEndBefore(I);H.collapse(ka)}return B}for(E=I.previousSibling;G>0;){J=E.previousSibling;E=N(E,x);B&&B.insertBefore(E,B.firstChild);--G;E=J}if(x!=Z){H.setEndBefore(I);H.collapse(ka)}return B}function L(I,x){var B,E,G,J;if(x!=ba)B=ha.createDocumentFragment();G=X(I,x);B&&B.appendChild(G);
E=ra(I);++E;E=H[oa]-E;for(G=I.nextSibling;E>0;){J=G.nextSibling;G=N(G,x);B&&B.appendChild(G);--E;G=J}if(x!=Z){H.setStartAfter(I);H.collapse(ca)}return B}function M(I,x,B){var E,G,J,R;if(B!=ba)G=ha.createDocumentFragment();E=X(I,B);G&&G.appendChild(E);J=ra(I);R=ra(x);++J;J=R-J;for(E=I.nextSibling;J>0;){R=E.nextSibling;E=N(E,B);G&&G.appendChild(E);E=R;--J}E=W(x,B);G&&G.appendChild(E);if(B!=Z){H.setStartAfter(I);H.collapse(ca)}return G}function W(I,x){var B=u(H[fa],H[oa]-1),E,G,J,R=B!=H[fa];if(B==I)return D(B,
R,ka,x);E=B.parentNode;for(G=D(E,ka,ka,x);E;){for(;B;){J=B.previousSibling;B=D(B,R,ka,x);x!=ba&&G.insertBefore(B,G.firstChild);R=ca;B=J}if(E==I)return G;B=E.previousSibling;E=E.parentNode;J=D(E,ka,ka,x);x!=ba&&J.appendChild(G);G=J}}function X(I,x){var B=u(H[da],H[ma]),E=B!=H[da],G,J,R;if(B==I)return D(B,E,ca,x);G=B.parentNode;for(J=D(G,ka,ca,x);G;){for(;B;){R=B.nextSibling;B=D(B,E,ca,x);x!=ba&&J.appendChild(B);E=ca;B=R}if(G==I)return J;B=G.nextSibling;G=G.parentNode;R=D(G,ka,ca,x);x!=ba&&R.appendChild(J);
J=R}}function D(I,x,B,E){var G;if(x)return N(I,E);if(I.nodeType==3){x=I.nodeValue;if(B){G=H[ma];B=x.substring(G);x=x.substring(0,G)}else{G=H[oa];B=x.substring(0,G);x=x.substring(G)}if(E!=Z)I.nodeValue=x;if(E==ba)return;I=I.cloneNode(ka);I.nodeValue=B;return I}if(E!=ba)return I.cloneNode(ka)}function N(I,x){if(x!=ba)return x==Z?I.cloneNode(ca):I;I.parentNode.removeChild(I)}var H=this,ha=a.doc,ja=0,Z=1,ba=2,ca=true,ka=false,ma="startOffset",da="startContainer",fa="endContainer",oa="endOffset",la=tinymce.extend,
ra=a.nodeIndex;la(H,{startContainer:ha,startOffset:0,endContainer:ha,endOffset:0,collapsed:ca,commonAncestorContainer:ha,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:c,setEnd:e,setStartBefore:b,setStartAfter:f,setEndBefore:h,setEndAfter:g,collapse:l,selectNode:o,selectNodeContents:p,compareBoundaryPoints:m,deleteContents:n,extractContents:q,cloneContents:s,insertNode:r,surroundContents:t,cloneRange:y})}k.Range=d})(tinymce.dom);
(function(){function k(d){function a(){function g(n){var q,s,r,t=0,y,u,v,z;r=l.duplicate();r.collapse(n);q=f.create("a");v=r.parentElement();if(v.hasChildNodes()){v.appendChild(q);r.moveToElementText(q);z=l.compareEndPoints(n?"StartToStart":"EndToEnd",r);if(z>0){o[n?"setStartAfter":"setEndAfter"](v);f.remove(q)}else{s=tinymce.grep(v.childNodes);for(y=s.length-1;t<=y;){u=Math.floor((t+y)/2);v.insertBefore(q,s[u]);r.moveToElementText(q);z=l.compareEndPoints(n?"StartToStart":"EndToEnd",r);if(z>0)t=u+
1;else if(z<0)y=u-1;else{found=true;break}}s=z>0||u==0?q.nextSibling:q.previousSibling;if(s.nodeType==1){f.remove(q);r=f.nodeIndex(s);s=s.parentNode;if(!n||u>0)r++}else{if(z>0||u==0){r.setEndPoint(n?"StartToStart":"EndToEnd",l);r=r.text.length}else{r.setEndPoint(n?"StartToStart":"EndToEnd",l);r=s.nodeValue.length-r.text.length}f.remove(q)}o[n?"setStart":"setEnd"](s,r)}}else o[n?"setStart":"setEnd"](v,0)}var l=d.getRng(),o=f.createRng(),p,m;p=l.item?l.item(0):l.parentElement();if(p.ownerDocument!=
f.doc)return o;m=d.isCollapsed();if(l.item||!p.hasChildNodes()){if(m){o.setStart(p,0);o.setEnd(p,0)}else{o.setStart(p.parentNode,f.nodeIndex(p));o.setEnd(o.startContainer,o.startOffset+1)}return o}g(true);m||g();return o}var c="\ufeff",e,b,f=d.dom,h=true;this.addRange=function(g){function l(u){var v,z,A,C,F;A=f.create("a");v=u?m:q;z=u?n:s;C=o.duplicate();if(v==r||v==r.documentElement){v=t;z=0}if(v.nodeType==3){v.parentNode.insertBefore(A,v);C.moveToElementText(A);C.moveStart("character",z);f.remove(A);
o.setEndPoint(u?"StartToStart":"EndToEnd",C)}else{F=v.childNodes;if(F.length){z>=F.length?f.insertAfter(A,F[F.length-1]):v.insertBefore(A,F[z]);C.moveToElementText(A)}else{A=r.createTextNode(c);v.appendChild(A);C.moveToElementText(A.parentNode);C.collapse(h)}o.setEndPoint(u?"StartToStart":"EndToEnd",C);f.remove(A)}}var o,p,m,n,q,s,r=d.dom.doc,t=r.body;this.destroy();m=g.startContainer;n=g.startOffset;q=g.endContainer;s=g.endOffset;o=t.createTextRange();if(m==q&&m.nodeType==1&&n==s-1)if(n==s-1)try{p=
t.createControlRange();p.addElement(m.childNodes[n]);p.select();return}catch(y){}l(true);l();o.select()};this.getRangeAt=function(){if(!e||!tinymce.dom.RangeUtils.compareRanges(b,d.getRng())){e=a();b=d.getRng()}return e};this.destroy=function(){b=e=null}}tinymce.dom.TridentSelection=k})();
(function(k){var d=k.each,a=k.DOM,c=k.isIE,e;k.create("tinymce.dom.EventUtils",{EventUtils:function(){this.inits=[];this.events=[]},add:function(b,f,h,g){var l,o=this,p=o.events,m;if(f instanceof Array){m=[];d(f,function(n){m.push(o.add(b,n,h,g))});return m}if(b&&b.hasOwnProperty&&b instanceof Array){m=[];d(b,function(n){n=a.get(n);m.push(o.add(n,f,h,g))});return m}if(b=a.get(b)){l=function(n){if(!o.disabled){if((n=n||window.event)&&c){if(!n.target)n.target=n.srcElement;k.extend(n,o._stoppers)}if(!g)return h(n);
return h.call(g,n)}};if(f=="unload"){k.unloads.unshift({func:l});return l}if(f=="init"){o.domLoaded?l():o.inits.push(l);return l}p.push({obj:b,name:f,func:h,cfunc:l,scope:g});o._add(b,f,l);return h}},remove:function(b,f,h){var g=this,l=g.events,o=false,p;if(b&&b.hasOwnProperty&&b instanceof Array){p=[];d(b,function(m){m=a.get(m);p.push(g.remove(m,f,h))});return p}b=a.get(b);d(l,function(m,n){if(m.obj==b&&m.name==f&&(!h||m.func==h||m.cfunc==h)){l.splice(n,1);g._remove(b,f,m.cfunc);o=true;return false}});
return o},clear:function(b){var f=this.events,h,g;if(b){b=a.get(b);for(h=f.length-1;h>=0;h--){g=f[h];if(g.obj===b){this._remove(g.obj,g.name,g.cfunc);g.obj=g.cfunc=null;f.splice(h,1)}}}},cancel:function(b){if(!b)return false;this.stop(b);return this.prevent(b)},stop:function(b){if(b.stopPropagation)b.stopPropagation();else b.cancelBubble=true;return false},prevent:function(b){if(b.preventDefault)b.preventDefault();else b.returnValue=false;return false},destroy:function(){var b=this;d(b.events,function(f){b._remove(f.obj,
f.name,f.cfunc);f.obj=f.cfunc=null});b.events=[];b=null},_add:function(b,f,h){if(b.attachEvent)b.attachEvent("on"+f,h);else if(b.addEventListener)b.addEventListener(f,h,false);else b["on"+f]=h},_remove:function(b,f,h){if(b)try{if(b.detachEvent)b.detachEvent("on"+f,h);else if(b.removeEventListener)b.removeEventListener(f,h,false);else b["on"+f]=null}catch(g){}},_pageInit:function(){if(!this.domLoaded){this.domLoaded=true;d(this.inits,function(b){b()});this.inits=[]}},_wait:function(b){var f=this,h=
b.document;if(b.tinyMCE_GZ&&tinyMCE_GZ.loaded)f.domLoaded=1;else{if(h.attachEvent){h.attachEvent("onreadystatechange",function(){if(h.readyState==="complete"){h.detachEvent("onreadystatechange",arguments.callee);f._pageInit(b)}});h.documentElement.doScroll&&b==b.top&&function(){if(!f.domLoaded){try{h.documentElement.doScroll("left")}catch(g){setTimeout(arguments.callee,0);return}f._pageInit(b)}}()}else h.addEventListener&&f._add(b,"DOMContentLoaded",function(){f._pageInit(b)});f._add(b,"load",function(){f._pageInit(b)})}},
_stoppers:{preventDefault:function(){this.returnValue=false},stopPropagation:function(){this.cancelBubble=true}}});e=k.dom.Event=new k.dom.EventUtils;e._wait(window);k.addUnload(function(){e.destroy()})})(tinymce);
(function(k){k.dom.Element=function(d,a){var c=this,e;c.settings=a=a||{};c.id=d;c.dom=e=a.dom||k.DOM;k.isIE||e.get(c.id);k.each("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get".split(/,/),function(b){c[b]=function(){var f=[d],h;for(h=0;h<arguments.length;h++)f.push(arguments[h]);f=e[b].apply(e,f);c.update(b);return f}});k.extend(c,{on:function(b,f,h){return k.dom.Event.add(c.id,
b,f,h)},getXY:function(){return{x:parseInt(c.getStyle("left")),y:parseInt(c.getStyle("top"))}},getSize:function(){var b=e.get(c.id);return{w:parseInt(c.getStyle("width")||b.clientWidth),h:parseInt(c.getStyle("height")||b.clientHeight)}},moveTo:function(b,f){c.setStyles({left:b,top:f})},moveBy:function(b,f){var h=c.getXY();c.moveTo(h.x+b,h.y+f)},resizeTo:function(b,f){c.setStyles({width:b,height:f})},resizeBy:function(b,f){var h=c.getSize();c.resizeTo(h.w+b,h.h+f)},update:function(b){if(k.isIE6&&a.blocker){b=
b||"";if(!(b.indexOf("get")===0||b.indexOf("has")===0||b.indexOf("is")===0))if(b=="remove")e.remove(c.blocker);else{if(c.blocker)b=e.get(c.blocker);else{c.blocker=e.uniqueId();b=e.add(a.container||e.getRoot(),"iframe",{id:c.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'});e.setStyle(b,"opacity",0)}e.setStyles(b,{left:c.getStyle("left",1),top:c.getStyle("top",1),width:c.getStyle("width",1),height:c.getStyle("height",1),display:c.getStyle("display",1),zIndex:parseInt(c.getStyle("zIndex",
1)||0)-1})}}}})}})(tinymce);
(function(k){var d=k.is,a=k.isIE,c=k.each;k.create("tinymce.dom.Selection",{Selection:function(e,b,f){var h=this;h.dom=e;h.win=b;h.serializer=f;c(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(g){h[g]=new k.util.Dispatcher(h)});if(!h.win.getSelection)h.tridentSel=new k.dom.TridentSelection(h);k.isIE&&e.boxModel&&this._fixIESelection();k.addUnload(h.destroy,h)},getContent:function(e){var b=this.getRng(),f=this.dom.create("body"),h=this.getSel(),g,l;e=e||{};g=l="";
e.get=true;e.format=e.format||"html";this.onBeforeGetContent.dispatch(this,e);if(e.format=="text")return this.isCollapsed()?"":b.text||(h.toString?h.toString():"");if(b.cloneContents)(b=b.cloneContents())&&f.appendChild(b);else f.innerHTML=d(b.item)||d(b.htmlText)?b.item?b.item(0).outerHTML:b.htmlText:b.toString();if(/^\s/.test(f.innerHTML))g=" ";if(/\s+$/.test(f.innerHTML))l=" ";e.getInner=true;e.content=this.isCollapsed()?"":g+this.serializer.serialize(f,e)+l;this.onGetContent.dispatch(this,e);
return e.content},setContent:function(e,b){var f=this.getRng(),h=this.win.document,g,l;b=b||{format:"html"};b.set=true;b.content=e;b.no_events||this.onBeforeSetContent.dispatch(this,b);e=b.content;if(f.insertNode){e+='<span id="__caret">_</span>';if(f.startContainer==h&&f.endContainer==h)h.body.innerHTML=e;else{f.deleteContents();if(h.body.childNodes.length==0)h.body.innerHTML=e;else if(f.createContextualFragment)f.insertNode(f.createContextualFragment(e));else{g=h.createDocumentFragment();l=h.createElement("div");
g.appendChild(l);l.outerHTML=e;f.insertNode(g)}}e=this.dom.get("__caret");f=h.createRange();f.setStartBefore(e);f.setEndBefore(e);this.setRng(f);this.dom.remove("__caret");this.setRng(f)}else{if(f.item){h.execCommand("Delete",false,null);f=this.getRng()}f.pasteHTML(e)}b.no_events||this.onSetContent.dispatch(this,b)},getStart:function(){var e=this.getRng(),b,f;if(e.duplicate||e.item){if(e.item)return e.item(0);b=e.duplicate();b.collapse(1);b=b.parentElement();for(e=f=e.parentElement();f=f.parentNode;)if(f==
b){b=e;break}}else{b=e.startContainer;if(b.nodeType==1&&b.hasChildNodes())b=b.childNodes[Math.min(b.childNodes.length-1,e.startOffset)];if(b&&b.nodeType==3)return b.parentNode}return b},getEnd:function(){var e=this.getRng(),b;if(e.duplicate||e.item){if(e.item)return e.item(0);e=e.duplicate();e.collapse(0);if((b=e.parentElement())&&b.nodeName=="BODY")return b.lastChild||b}else{b=e.endContainer;e=e.endOffset;if(b.nodeType==1&&b.hasChildNodes())b=b.childNodes[e>0?e-1:e];if(b&&b.nodeType==3)return b.parentNode}return b},
getBookmark:function(e,b){function f(q,s){var r=0;c(g.select(q),function(t,y){if(t==s)r=y});return r}var h=this,g=h.dom,l,o,p,m;if(e==2)return function(){function q(y,u){var v=y[u?"startContainer":"endContainer"];y=y[u?"startOffset":"endOffset"];u=[];var z,A=0;if(v.nodeType==3){if(b)for(z=v.previousSibling;z&&z.nodeType==3;z=z.previousSibling)y+=z.nodeValue.length;u.push(y)}else{z=v.childNodes;if(y>=z.length&&z.length){A=1;y=Math.max(0,z.length-1)}u.push(h.dom.nodeIndex(z[y],b)+A)}for(;v&&v!=r;v=
v.parentNode)u.push(h.dom.nodeIndex(v,b));return u}var s=h.getRng(true),r=g.getRoot(),t={};t.start=q(s,true);if(!h.isCollapsed())t.end=q(s);return t}();if(e)return{rng:h.getRng()};e=h.getRng();o=g.uniqueId();p=tinyMCE.activeEditor.selection.isCollapsed();if(e.duplicate||e.item)if(e.item){m=e.item(0);l=m.nodeName;return{name:l,index:f(l,m)}}else{l=e.duplicate();try{e.collapse();e.pasteHTML('<span data-mce-type="bookmark" id="'+o+'_start" style="overflow:hidden;line-height:0px">\ufeff</span>');if(!p){l.collapse(false);
e.moveToElementText(l.parentElement());e.compareEndPoints("StartToEnd",l)==0&&l.move("character",-1);l.pasteHTML('<span data-mce-type="bookmark" id="'+o+'_end" style="overflow:hidden;line-height:0px">\ufeff</span>')}}catch(n){return null}}else{m=h.getNode();l=m.nodeName;if(l=="IMG")return{name:l,index:f(l,m)};l=e.cloneRange();if(!p){l.collapse(false);l.insertNode(g.create("span",{"data-mce-type":"bookmark",id:o+"_end",style:"overflow:hidden;line-height:0px"},"\ufeff"))}e.collapse(true);e.insertNode(g.create("span",
{"data-mce-type":"bookmark",id:o+"_start",style:"overflow:hidden;line-height:0px"},"\ufeff"))}h.moveToBookmark({id:o,keep:1});return{id:o}},moveToBookmark:function(e){var b=this.dom,f,h,g,l,o,p;this.tridentSel&&this.tridentSel.destroy();if(e)if(e.start){f=b.createRng();h=b.getRoot();var m=function(q){var s=e[q?"start":"end"],r,t,y;if(s){y=s[0];t=h;for(r=s.length-1;r>=1;r--){t=t.childNodes;if(s[r]>t.length-1)return;t=t[s[r]]}if(t.nodeType===3)y=Math.min(s[0],t.nodeValue.length);if(t.nodeType===1)y=
Math.min(s[0],t.childNodes.length);q?f.setStart(t,y):f.setEnd(t,y)}return true};m(true)&&m()&&this.setRng(f)}else if(e.id){m=function(q){var s=b.get(e.id+"_"+q),r,t,y;y=e.keep;if(s){r=s.parentNode;if(q=="start"){if(y){r=s.firstChild;t=1}else t=b.nodeIndex(s);g=l=r;o=p=t}else{if(y){r=s.firstChild;t=1}else t=b.nodeIndex(s);l=r;p=t}if(!y){y=s.previousSibling;r=s.nextSibling;for(c(k.grep(s.childNodes),function(u){if(u.nodeType==3)u.nodeValue=u.nodeValue.replace(/\uFEFF/g,"")});s=b.get(e.id+"_"+q);)b.remove(s,
1);if(y&&r&&y.nodeType==r.nodeType&&y.nodeType==3&&!k.isOpera){t=y.nodeValue.length;y.appendData(r.nodeValue);b.remove(r);if(q=="start"){g=l=y;o=p=t}else{l=y;p=t}}}}};var n=function(q){if(b.isBlock(q)&&!q.innerHTML)q.innerHTML=!a?'<br data-mce-bogus="1" />':" ";return q};m("start");m("end");if(g){f=b.createRng();f.setStart(n(g),o);f.setEnd(n(l),p);this.setRng(f)}}else if(e.name)this.select(b.select(e.name)[e.index]);else e.rng&&this.setRng(e.rng)},select:function(e,b){var f=this.dom,h=f.createRng();
if(e){f=f.nodeIndex(e);h.setStart(e.parentNode,f);h.setEnd(e.parentNode,f+1);if(b){b=function(g,l){var o=new k.dom.TreeWalker(g,g);do{if(g.nodeType==3&&k.trim(g.nodeValue).length!=0){l?h.setStart(g,0):h.setEnd(g,g.nodeValue.length);return}if(g.nodeName=="BR"){l?h.setStartBefore(g):h.setEndBefore(g);return}}while(g=l?o.next():o.prev())};b(e,1);b(e)}this.setRng(h)}return e},isCollapsed:function(){var e=this.getRng(),b=this.getSel();if(!e||e.item)return false;if(e.compareEndPoints)return e.compareEndPoints("StartToEnd",
e)===0;return!b||e.collapsed},collapse:function(e){var b=this.getRng(),f;if(b.item){f=b.item(0);b=this.win.document.body.createTextRange();b.moveToElementText(f)}b.collapse(!!e);this.setRng(b)},getSel:function(){var e=this.win;return e.getSelection?e.getSelection():e.document.selection},getRng:function(e){var b,f,h=this.win.document;if(e&&this.tridentSel)return this.tridentSel.getRangeAt(0);try{if(b=this.getSel())f=b.rangeCount>0?b.getRangeAt(0):b.createRange?b.createRange():h.createRange()}catch(g){}if(k.isIE&&
f&&f.setStart&&h.selection.createRange().item){e=h.selection.createRange().item(0);f=h.createRange();f.setStartBefore(e);f.setEndAfter(e)}f||(f=h.createRange?h.createRange():h.body.createTextRange());if(this.selectedRange&&this.explicitRange)if(f.compareBoundaryPoints(f.START_TO_START,this.selectedRange)===0&&f.compareBoundaryPoints(f.END_TO_END,this.selectedRange)===0)f=this.explicitRange;else this.explicitRange=this.selectedRange=null;return f},setRng:function(e){var b;if(this.tridentSel)if(e.cloneRange)this.tridentSel.addRange(e);
else try{e.select()}catch(f){}else if(b=this.getSel()){this.explicitRange=e;try{b.removeAllRanges()}catch(h){}b.addRange(e);this.selectedRange=b.getRangeAt(0)}},setNode:function(e){this.setContent(this.dom.getOuterHTML(e));return e},getNode:function(){var e=this.getRng();this.getSel();var b,f=e.startContainer,h=e.endContainer;if(!e)return this.dom.getRoot();if(e.setStart){b=e.commonAncestorContainer;if(!e.collapsed){if(e.startContainer==e.endContainer)if(e.endOffset-e.startOffset<2)if(e.startContainer.hasChildNodes())b=
e.startContainer.childNodes[e.startOffset];if(f.nodeType===3&&h.nodeType===3){var g=function(l,o){for(var p=l;l&&l.nodeType===3&&l.length===0;)l=o?l.nextSibling:l.previousSibling;return l||p};f=f.length===e.startOffset?g(f.nextSibling,true):f.parentNode;h=e.endOffset===0?g(h.previousSibling,false):h.parentNode;if(f&&f===h)return f}}if(b&&b.nodeType==3)return b.parentNode;return b}return e.item?e.item(0):e.parentElement()},getSelectedBlocks:function(e,b){var f=this.dom,h,g=[];e=f.getParent(e||this.getStart(),
f.isBlock);b=f.getParent(b||this.getEnd(),f.isBlock);e&&g.push(e);if(e&&b&&e!=b)for(h=e;(h=h.nextSibling)&&h!=b;)f.isBlock(h)&&g.push(h);b&&e!=b&&g.push(b);return g},destroy:function(e){this.win=null;this.tridentSel&&this.tridentSel.destroy();e||k.removeUnload(this.destroy)},_fixIESelection:function(){function e(n,q){var s=l.createTextRange();try{s.moveToPoint(n,q)}catch(r){s=null}return s}function b(n){if(n.button){if(n=e(n.x,n.y)){n.compareEndPoints("StartToStart",p)>0?n.setEndPoint("StartToStart",
p):n.setEndPoint("EndToEnd",p);n.select()}}else f()}function f(){var n=g.selection.createRange();p&&!n.item&&n.compareEndPoints("StartToEnd",n)===0&&p.select();h.unbind(g,"mouseup",f);h.unbind(g,"mousemove",b);p=o=0}var h=this.dom,g=h.doc,l=g.body,o,p,m;g.documentElement.unselectable=true;h.bind(g,["mousedown","contextmenu"],function(n){if(n.target.nodeName==="HTML"){o&&f();m=g.documentElement;if(!(m.scrollHeight>m.clientHeight)){o=1;if(p=e(n.x,n.y)){h.bind(g,"mouseup",f);h.bind(g,"mousemove",b);
h.win.focus();p.select()}}}})}})})(tinymce);
(function(k){k.dom.Serializer=function(d,a,c){var e,b,f=k.isIE,h=k.each,g;if(!d.apply_source_formatting)d.indent=false;d.remove_trailing_brs=true;a=a||k.DOM;c=c||new k.html.Schema(d);d.entity_encoding=d.entity_encoding||"named";e=new k.util.Dispatcher(self);b=new k.util.Dispatcher(self);g=new k.html.DomParser(d,c);g.addAttributeFilter("src,href,style",function(l,o){for(var p=l.length,m,n,q="data-mce-"+o,s=d.url_converter,r=d.url_converter_scope;p--;){m=l[p];n=m.attributes.map[q];if(n!==void 0){m.attr(o,
n.length>0?n:null);m.attr(q,null)}else{n=m.attributes.map[o];if(o==="style")n=a.serializeStyle(a.parseStyle(n),m.name);else if(s)n=s.call(r,n,o,m.name);m.attr(o,n.length>0?n:null)}}});g.addAttributeFilter("class",function(l){for(var o=l.length,p,m;o--;){p=l[o];m=p.attr("class").replace(/\s*mce(Item\w+|Selected)\s*/g,"");p.attr("class",m.length>0?m:null)}});g.addAttributeFilter("data-mce-type",function(l,o,p){o=l.length;for(var m;o--;){m=l[o];m.attributes.map["data-mce-type"]==="bookmark"&&!p.cleanup&&
m.remove()}});g.addNodeFilter("script,style",function(l,o){function p(s){return s.replace(/(<!--\[CDATA\[|\]\]--\>)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*(\/\/\s*<!--|\/\/\s*<!\[CDATA\[|<!--|<!\[CDATA\[)[\r\n]*/g,"").replace(/\s*(\/\/\s*\]\]>|\/\/\s*--\>|\]\]>|--\>|\]\]--\>)\s*$/g,"")}for(var m=l.length,n,q;m--;){n=l[m];q=n.firstChild?n.firstChild.value:"";if(o==="script"){n.attr("type",(n.attr("type")||"text/javascript").replace(/^mce\-/,""));if(q.length>0)n.firstChild.value="// <![CDATA[\n"+
p(q)+"\n// ]]\>"}else if(q.length>0)n.firstChild.value="<!--\n"+p(q)+"\n--\>"}});g.addNodeFilter("#comment",function(l){for(var o=l.length,p;o--;){p=l[o];if(p.value.indexOf("[CDATA[")===0){p.name="#cdata";p.type=4;p.value=p.value.replace(/^\[CDATA\[|\]\]$/g,"")}else if(p.value.indexOf("mce:protected ")===0){p.name="#text";p.type=3;p.raw=true;p.value=unescape(p.value).substr(14)}}});g.addNodeFilter("xml:namespace,input",function(l,o){for(var p=l.length,m;p--;){m=l[p];if(m.type===7)m.remove();else m.type===
1&&o==="input"&&!("type"in m.attributes.map)&&m.attr("type","text")}});d.fix_list_elements&&g.addNodeFilter("ul,ol",function(l){for(var o=l.length,p,m;o--;){p=l[o];m=p.parent;if(m.name==="ul"||m.name==="ol")p.prev&&p.prev.name==="li"&&p.prev.append(p)}});g.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(l,o){for(var p=l.length;p--;)l[p].attr(o,null)});return{schema:c,addNodeFilter:g.addNodeFilter,addAttributeFilter:g.addAttributeFilter,onPreProcess:e,onPostProcess:b,serialize:function(l,
o){var p,m,n;if(f&&a.select("script,style,select").length>0){p=l.innerHTML;l=l.cloneNode(false);a.setHTML(l,p)}else l=l.cloneNode(true);p=l.ownerDocument.implementation;if(p.createHTMLDocument){m=p.createHTMLDocument("");h(l.nodeName=="BODY"?l.childNodes:[l],function(q){m.body.appendChild(m.importNode(q,true))});l=l.nodeName!="BODY"?m.body.firstChild:m.body;n=a.doc;a.doc=m}o=o||{};o.format=o.format||"html";if(!o.no_events){o.node=l;e.dispatch(self,o)}p=new k.html.Serializer(d,c);o.content=p.serialize(g.parse(o.getInner?
l.innerHTML:k.trim(a.getOuterHTML(l),o),o));if(!o.cleanup)o.content=o.content.replace(/\uFEFF/g,"");o.no_events||b.dispatch(self,o);if(n)a.doc=n;o.node=null;return o.content},addRules:function(l){c.addValidElements(l)},setRules:function(l){c.setValidElements(l)}}}})(tinymce);
(function(k){k.dom.ScriptLoader=function(){function d(h,g){function l(){p.remove(s);if(m)m.onreadystatechange=m.onload=m=null;g()}function o(){typeof console!=="undefined"&&console.log&&console.log("Failed to load: "+h)}var p=k.DOM,m,n,q,s;s=p.uniqueId();if(k.isIE6){n=new k.util.URI(h);q=location;if(n.host==q.hostname&&n.port==q.port&&n.protocol+":"==q.protocol&&n.protocol.toLowerCase()!="file"){k.util.XHR.send({url:k._addVer(n.getURI()),success:function(r){var t=p.create("script",{type:"text/javascript"});
t.text=r;document.getElementsByTagName("head")[0].appendChild(t);p.remove(t);l()},error:o});return}}m=p.create("script",{id:s,type:"text/javascript",src:k._addVer(h)});if(!k.isIE)m.onload=l;m.onerror=o;if(!k.isOpera)m.onreadystatechange=function(){var r=m.readyState;if(r=="complete"||r=="loaded")l()};(document.getElementsByTagName("head")[0]||document.body).appendChild(m)}var a={},c=[],e={},b=[],f=0;this.isDone=function(h){return a[h]==2};this.markDone=function(h){a[h]=2};this.add=this.load=function(h,
g,l){if(a[h]==void 0){c.push(h);a[h]=0}if(g){e[h]||(e[h]=[]);e[h].push({func:g,scope:l||this})}};this.loadQueue=function(h,g){this.loadScripts(c,h,g)};this.loadScripts=function(h,g,l){function o(m){k.each(e[m],function(n){n.func.call(n.scope)});e[m]=void 0}var p;b.push({func:g,scope:l||this});p=function(){var m=k.grep(h);h.length=0;k.each(m,function(n){if(a[n]==2)o(n);else if(a[n]!=1){a[n]=1;f++;d(n,function(){a[n]=2;f--;o(n);p()})}});if(!f){k.each(b,function(n){n.func.call(n.scope)});b.length=0}};
p()}};k.ScriptLoader=new k.dom.ScriptLoader})(tinymce);tinymce.dom.TreeWalker=function(k,d){function a(e,b,f,h){if(e){if(!h&&e[b])return e[b];if(e!=d){if(b=e[f])return b;for(e=e.parentNode;e&&e!=d;e=e.parentNode)if(b=e[f])return b}}}var c=k;this.current=function(){return c};this.next=function(e){return c=a(c,"firstChild","nextSibling",e)};this.prev=function(e){return c=a(c,"lastChild","previousSibling",e)}};
(function(k){k.dom.RangeUtils=function(d){this.walk=function(a,c){function e(q,s,r){for(var t=[];q&&q!=r;q=q[s])t.push(q);return t}function b(q,s){do{if(q.parentNode==s)return q;q=q.parentNode}while(q)}function f(q,s,r){var t=r?"nextSibling":"previousSibling";o=q;for(p=o.parentNode;o&&o!=s;o=p){p=o.parentNode;m=e(o==q?o:o[t],t);if(m.length){r||m.reverse();c(m)}}}var h=a.startContainer,g=a.startOffset,l=a.endContainer;a=a.endOffset;var o,p,m,n;n=d.select("td.mceSelected,th.mceSelected");if(n.length>
0)k.each(n,function(q){c([q])});else{if(h.nodeType==1&&h.hasChildNodes())h=h.childNodes[g];if(l.nodeType==1&&l.hasChildNodes())l=l.childNodes[Math.min(a-1,l.childNodes.length-1)];a=d.findCommonAncestor(h,l);if(h==l)return c([h]);for(o=h;o;o=o.parentNode){if(o==l)return f(h,a,true);if(o==a)break}for(o=l;o;o=o.parentNode){if(o==h)return f(l,a);if(o==a)break}g=b(h,a)||h;a=b(l,a)||l;f(h,g,true);m=e(g==h?g:g.nextSibling,"nextSibling",a==l?a.nextSibling:a);m.length&&c(m);f(l,a)}}};k.dom.RangeUtils.compareRanges=
function(d,a){if(d&&a)if(d.item||d.duplicate){if(d.item&&a.item&&d.item(0)===a.item(0))return true;if(d.isEqual&&a.isEqual&&a.isEqual(d))return true}else return d.startContainer==a.startContainer&&d.startOffset==a.startOffset;return false}})(tinymce);
(function(k){var d=k.dom.Event,a=k.each;k.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(c,e){var b=this,f=c.root,h=c.items,g=c.enableUpDown,l=c.enableLeftRight||!c.enableUpDown,o=c.excludeFromTabOrder,p,m,n,q,s;e=e||k.DOM;p=function(r){s=r.target.id};m=function(r){e.setAttrib(r.target.id,"tabindex","-1")};q=function(){var r=e.get(s);e.setAttrib(r,"tabindex","0");r.focus()};b.focus=function(){e.get(s).focus()};b.destroy=function(){a(h,function(r){e.unbind(e.get(r.id),"focus",
p);e.unbind(e.get(r.id),"blur",m)});e.unbind(e.get(f),"focus",q);e.unbind(e.get(f),"keydown",n);h=e=f=b.focus=p=m=n=q=null;b.destroy=function(){}};b.moveFocus=function(r,t){var y=-1;if(s){a(h,function(u,v){if(u.id===s){y=v;return false}});y+=r;if(y<0)y=h.length-1;else if(y>=h.length)y=0;r=h[y];e.setAttrib(s,"tabindex","-1");e.setAttrib(r.id,"tabindex","0");e.get(r.id).focus();c.actOnFocus&&c.onAction(r.id);t&&d.cancel(t)}};n=function(r){switch(r.keyCode){case 37:l&&b.moveFocus(-1);break;case 39:l&&
b.moveFocus(1);break;case 38:g&&b.moveFocus(-1);break;case 40:g&&b.moveFocus(1);break;case 27:if(c.onCancel){c.onCancel();d.cancel(r)}break;case 14:case 13:case 32:if(c.onAction){c.onAction(s);d.cancel(r)}break}};a(h,function(r,t){if(!r.id)r.id=e.uniqueId("_mce_item_");if(o){e.bind(r.id,"blur",m);t="-1"}else t=t===0?"0":"-1";e.setAttrib(r.id,"tabindex",t);e.bind(e.get(r.id),"focus",p)});if(h[0])s=h[0].id;e.setAttrib(f,"tabindex","-1");e.bind(e.get(f),"focus",q);e.bind(e.get(f),"keydown",n)}})})(tinymce);
(function(k){var d=k.DOM,a=k.is;k.create("tinymce.ui.Control",{Control:function(c,e,b){this.id=c;this.settings=e=e||{};this.rendered=false;this.onRender=new k.util.Dispatcher(this);this.classPrefix="";this.scope=e.scope||this;this.active=this.disabled=0;this.editor=b},setAriaProperty:function(c,e){var b=d.get(this.id+"_aria")||d.get(this.id);b&&d.setAttrib(b,"aria-"+c,!!e)},focus:function(){d.get(this.id).focus()},setDisabled:function(c){if(c!=this.disabled){this.setAriaProperty("disabled",c);this.setState("Disabled",
c);this.setState("Enabled",!c);this.disabled=c}},isDisabled:function(){return this.disabled},setActive:function(c){if(c!=this.active){this.setState("Active",c);this.active=c;this.setAriaProperty("pressed",c)}},isActive:function(){return this.active},setState:function(c,e){var b=d.get(this.id);c=this.classPrefix+c;e?d.addClass(b,c):d.removeClass(b,c)},isRendered:function(){return this.rendered},renderHTML:function(){},renderTo:function(c){d.setHTML(c,this.renderHTML())},postRender:function(){var c;
if(a(this.disabled)){c=this.disabled;this.disabled=-1;this.setDisabled(c)}if(a(this.active)){c=this.active;this.active=-1;this.setActive(c)}},remove:function(){d.remove(this.id);this.destroy()},destroy:function(){k.dom.Event.clear(this.id)}})})(tinymce);tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(k,d,a){this.parent(k,d,a);this.controls=[];this.lookup={}},add:function(k){this.lookup[k.id]=k;this.controls.push(k);return k},get:function(k){return this.lookup[k]}});
tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(k,d){this.parent(k,d);this.classPrefix="mceSeparator";this.setDisabled(true)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}});
(function(k){var d=k.is;k.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(a,c){this.parent(a,c);this.classPrefix="mceMenuItem"},setSelected:function(a){this.setState("Selected",a);this.setAriaProperty("checked",!!a);this.selected=a},isSelected:function(){return this.selected},postRender:function(){this.parent();d(this.selected)&&this.setSelected(this.selected)}})})(tinymce);
(function(k){var d=k.DOM,a=k.walk;k.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(c,e){this.parent(c,e);this.items={};this.collapsed=false;this.menuCount=0;this.onAddItem=new k.util.Dispatcher(this)},expand:function(c){c&&a(this,function(e){e.expand&&e.expand()},"items",this);this.collapsed=false},collapse:function(c){c&&a(this,function(e){e.collapse&&e.collapse()},"items",this);this.collapsed=true},isCollapsed:function(){return this.collapsed},add:function(c){c.settings||(c=new k.ui.MenuItem(c.id||
d.uniqueId(),c));this.onAddItem.dispatch(this,c);return this.items[c.id]=c},addSeparator:function(){return this.add({separator:true})},addMenu:function(c){c.collapse||(c=this.createMenu(c));this.menuCount++;return this.add(c)},hasMenus:function(){return this.menuCount!==0},remove:function(c){delete this.items[c.id]},removeAll:function(){a(this,function(c){c.removeAll?c.removeAll():c.remove();c.destroy()},"items",this);this.items={}},createMenu:function(c){c=new k.ui.Menu(c.id||d.uniqueId(),c);c.onAddItem.add(this.onAddItem.dispatch,
this.onAddItem);return c}})})(tinymce);
(function(k){var d=k.is,a=k.DOM,c=k.each,e=k.dom.Event,b=k.dom.Element;k.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(f,h){h=h||{};h.container=h.container||a.doc.body;h.offset_x=h.offset_x||0;h.offset_y=h.offset_y||0;h.vp_offset_x=h.vp_offset_x||0;h.vp_offset_y=h.vp_offset_y||0;if(d(h.icons)&&!h.icons)h["class"]+=" mceNoIcons";this.parent(f,h);this.onShowMenu=new k.util.Dispatcher(this);this.onHideMenu=new k.util.Dispatcher(this);this.classPrefix="mceMenu"},createMenu:function(f){var h=
this.settings;f.container=f.container||h.container;f.parent=this;f.constrain=f.constrain||h.constrain;f["class"]=f["class"]||h["class"];f.vp_offset_x=f.vp_offset_x||h.vp_offset_x;f.vp_offset_y=f.vp_offset_y||h.vp_offset_y;f.keyboard_focus=h.keyboard_focus;f=new k.ui.DropMenu(f.id||a.uniqueId(),f);f.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return f},focus:function(){this.keyboardNav&&this.keyboardNav.focus()},update:function(){var f=this.settings,h=a.get("menu_"+this.id+"_tbl"),g=a.get("menu_"+
this.id+"_co"),l,o;l=f.max_width?Math.min(h.clientWidth,f.max_width):h.clientWidth;o=f.max_height?Math.min(h.clientHeight,f.max_height):h.clientHeight;a.boxModel?this.element.setStyles({width:l,height:o}):this.element.setStyles({width:l+2,height:o+2});f.max_width&&a.setStyle(g,"width",l);if(f.max_height){a.setStyle(g,"height",o);h.clientHeight<f.max_height&&a.setStyle(g,"overflow","hidden")}},showMenu:function(f,h,g){var l=this,o=l.settings,p,m=a.getViewPort(),n,q,s,r,t=l.classPrefix;l.collapse(1);
if(!l.isMenuVisible){if(l.rendered)p=a.get("menu_"+l.id);else{p=a.add(l.settings.container,l.renderNode());c(l.items,function(y){y.postRender()});l.element=new b("menu_"+l.id,{blocker:1,container:o.container})}k.isOpera||a.setStyles(p,{left:-65535,top:-65535});a.show(p);l.update();f+=o.offset_x||0;h+=o.offset_y||0;m.w-=4;m.h-=4;if(o.constrain){n=p.clientWidth-2;q=p.clientHeight-2;s=m.x+m.w;m=m.y+m.h;if(f+o.vp_offset_x+n>s)f=g?g-n:Math.max(0,s-o.vp_offset_x-n);if(h+o.vp_offset_y+q>m)h=Math.max(0,m-
o.vp_offset_y-q)}a.setStyles(p,{left:f,top:h});l.element.update();l.isMenuVisible=1;l.mouseClickFunc=e.add(p,"click",function(y){var u;if((y=y.target)&&(y=a.getParent(y,"tr"))&&!a.hasClass(y,t+"ItemSub")){u=l.items[y.id];if(!u.isDisabled()){for(r=l;r;){r.hideMenu&&r.hideMenu();r=r.settings.parent}u.settings.onclick&&u.settings.onclick(y);return e.cancel(y)}}});if(l.hasMenus())l.mouseOverFunc=e.add(p,"mouseover",function(y){var u;if((y=y.target)&&(y=a.getParent(y,"tr"))){u=l.items[y.id];l.lastMenu&&
l.lastMenu.collapse(1);if(!u.isDisabled())if(y&&a.hasClass(y,t+"ItemSub")){y=a.getRect(y);u.showMenu(y.x+y.w-2,y.y-2,y.x);l.lastMenu=u;a.addClass(a.get(u.id).firstChild,t+"ItemActive")}}});e.add(p,"keydown",l._keyHandler,l);l.onShowMenu.dispatch(l);o.keyboard_focus&&l._setupKeyboardNav()}},hideMenu:function(f){var h=a.get("menu_"+this.id);if(this.isMenuVisible){this.keyboardNav&&this.keyboardNav.destroy();e.remove(h,"mouseover",this.mouseOverFunc);e.remove(h,"click",this.mouseClickFunc);e.remove(h,
"keydown",this._keyHandler);a.hide(h);this.isMenuVisible=0;f||this.collapse(1);this.element&&this.element.hide();if(f=a.get(this.id))a.removeClass(f.firstChild,this.classPrefix+"ItemActive");this.onHideMenu.dispatch(this)}},add:function(f){var h;f=this.parent(f);if(this.isRendered&&(h=a.get("menu_"+this.id)))this._add(a.select("tbody",h)[0],f);return f},collapse:function(f){this.parent(f);this.hideMenu(1)},remove:function(f){a.remove(f.id);this.destroy();return this.parent(f)},destroy:function(){var f=
a.get("menu_"+this.id);this.keyboardNav&&this.keyboardNav.destroy();e.remove(f,"mouseover",this.mouseOverFunc);e.remove(a.select("a",f),"focus",this.mouseOverFunc);e.remove(f,"click",this.mouseClickFunc);e.remove(f,"keydown",this._keyHandler);this.element&&this.element.remove();a.remove(f)},renderNode:function(){var f=this,h=f.settings,g,l,o;o=a.create("div",{role:"listbox",id:"menu_"+f.id,"class":h["class"],style:"position:absolute;left:0;top:0;z-index:200000;outline:0"});f.settings.parent&&a.setAttrib(o,
"aria-parent","menu_"+f.settings.parent.id);l=a.add(o,"div",{role:"presentation",id:"menu_"+f.id+"_co","class":f.classPrefix+(h["class"]?" "+h["class"]:"")});f.element=new b("menu_"+f.id,{blocker:1,container:h.container});h.menu_line&&a.add(l,"span",{"class":f.classPrefix+"Line"});h=a.add(l,"table",{role:"presentation",id:"menu_"+f.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});g=a.add(h,"tbody");c(f.items,function(p){f._add(g,p)});f.rendered=true;return o},_setupKeyboardNav:function(){var f,h,
g=this;f=a.select("#menu_"+g.id)[0];h=a.select("a[role=option]","menu_"+g.id);h.splice(0,0,f);g.keyboardNav=new k.ui.KeyboardNavigation({root:"menu_"+g.id,items:h,onCancel:function(){g.hideMenu()},enableUpDown:true});f.focus()},_keyHandler:function(f){switch(f.keyCode){case 37:if(this.settings.parent){this.hideMenu();this.settings.parent.focus();e.cancel(f)}break;case 39:this.mouseOverFunc&&this.mouseOverFunc(f);break;case 38:case 40:k.dom.Event.cancel(f);return}},_add:function(f,h){var g,l=h.settings,
o,p,m,n=this.classPrefix;if(l.separator){p=a.add(f,"tr",{id:h.id,"class":n+"ItemSeparator"});a.add(p,"td",{"class":n+"ItemSeparator"});if(g=p.previousSibling)a.addClass(g,"mceLast")}else{g=p=a.add(f,"tr",{id:h.id,"class":n+"Item "+n+"ItemEnabled"});g=m=a.add(g,l.titleItem?"th":"td");g=o=a.add(g,"a",{id:h.id+"_aria",role:l.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"});if(l.parent){a.setAttrib(o,"aria-haspopup","true");a.setAttrib(o,"aria-owns",
"menu_"+h.id)}a.addClass(m,l["class"]);o=a.add(g,"span",{"class":"mceIcon"+(l.icon?" mce_"+l.icon:"")});l.icon_src&&a.add(o,"img",{src:l.icon_src});g=a.add(g,l.element||"span",{"class":"mceText",title:h.settings.title},h.settings.title);h.settings.style&&a.setAttrib(g,"style",h.settings.style);f.childNodes.length==1&&a.addClass(p,"mceFirst");if((g=p.previousSibling)&&a.hasClass(g,n+"ItemSeparator"))a.addClass(p,"mceFirst");h.collapse&&a.addClass(p,n+"ItemSub");if(g=p.previousSibling)a.removeClass(g,
"mceLast");a.addClass(p,"mceLast")}}})})(tinymce);
(function(k){var d=k.DOM;k.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(a,c,e){this.parent(a,c,e);this.classPrefix="mceButton"},renderHTML:function(){var a=this.classPrefix,c=this.settings,e,b;b=d.encode(c.label||"");e='<a role="button" id="'+this.id+'" href="javascript:;" class="'+a+" "+a+"Enabled "+c["class"]+(b?" "+a+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+d.encode(c.title)+'">';e+=c.image?'<img class="mceIcon" src="'+
c.image+'" alt="'+d.encode(c.title)+'" />'+b:'<span class="mceIcon '+c["class"]+'"></span>'+(b?'<span class="'+a+'Label">'+b+"</span>":"");e+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+c.title+"</span>";e+="</a>";return e},postRender:function(){var a=this,c=a.settings;k.dom.Event.add(a.id,"click",function(e){if(!a.isDisabled())return c.onclick.call(c.scope,e)})}})})(tinymce);
(function(k){var d=k.DOM,a=k.dom.Event,c=k.each,e=k.util.Dispatcher;k.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(b,f,h){this.parent(b,f,h);this.items=[];this.onChange=new e(this);this.onPostRender=new e(this);this.onAdd=new e(this);this.onRenderMenu=new k.util.Dispatcher(this);this.classPrefix="mceListBox"},select:function(b){var f=this,h,g;if(b==undefined)return f.selectByIndex(-1);g=b&&b.call?b:function(l){return l==b};if(b!=f.selectedValue){c(f.items,function(l,o){if(g(l.value)){h=
1;f.selectByIndex(o);return false}});h||f.selectByIndex(-1)}},selectByIndex:function(b){var f,h;if(b!=this.selectedIndex){f=d.get(this.id+"_text");if(h=this.items[b]){this.selectedValue=h.value;this.selectedIndex=b;d.setHTML(f,d.encode(h.title));d.removeClass(f,"mceTitle");d.setAttrib(this.id,"aria-valuenow",h.title)}else{d.setHTML(f,d.encode(this.settings.title));d.addClass(f,"mceTitle");this.selectedValue=this.selectedIndex=null;d.setAttrib(this.id,"aria-valuenow",this.settings.title)}}},add:function(b,
f,h){h=h||{};h=k.extend(h,{title:b,value:f});this.items.push(h);this.onAdd.dispatch(this,h)},getLength:function(){return this.items.length},renderHTML:function(){var b="";b=this.settings;var f=this.classPrefix;b='<span role="button" aria-haspopup="true" aria-labelledby="'+this.id+'_text" aria-describedby="'+this.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+this.id+'" cellpadding="0" cellspacing="0" class="'+f+" "+f+"Enabled"+(b["class"]?" "+b["class"]:"")+'"><tbody><tr>';b+="<td>"+
d.createHTML("span",{id:this.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},this.settings.title);b+=d.createHTML("a",{id:this.id+"_text",tabindex:-1,href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"},d.encode(this.settings.title))+"</td>";b+="<td>"+d.createHTML("a",{id:this.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span></span>')+
"</td>";b+="</tr></tbody></table></span>";return b},showMenu:function(){var b=this,f,h=d.get(this.id),g;if(!(b.isDisabled()||b.items.length==0)){if(b.menu&&b.menu.isMenuVisible)return b.hideMenu();if(!b.isMenuRendered){b.renderMenu();b.isMenuRendered=true}d.getPos(this.settings.menu_container);f=d.getPos(h);g=b.menu;g.settings.offset_x=f.x;g.settings.offset_y=f.y;g.settings.keyboard_focus=!k.isOpera;b.oldID&&g.items[b.oldID].setSelected(0);c(b.items,function(l){if(l.value===b.selectedValue){g.items[l.id].setSelected(1);
b.oldID=l.id}});g.showMenu(0,h.clientHeight);a.add(d.doc,"mousedown",b.hideMenu,b);d.addClass(b.id,b.classPrefix+"Selected")}},hideMenu:function(b){if(this.menu&&this.menu.isMenuVisible){d.removeClass(this.id,this.classPrefix+"Selected");if(!(b&&b.type=="mousedown"&&(b.target.id==this.id+"_text"||b.target.id==this.id+"_open")))if(!b||!d.getParent(b.target,".mceMenu")){d.removeClass(this.id,this.classPrefix+"Selected");a.remove(d.doc,"mousedown",this.hideMenu,this);this.menu.hideMenu()}}},renderMenu:function(){var b=
this,f;f=b.settings.control_manager.createDropMenu(b.id+"_menu",{menu_line:1,"class":b.classPrefix+"Menu mceNoIcons",max_width:150,max_height:150});f.onHideMenu.add(function(){b.hideMenu();b.focus()});f.add({title:b.settings.title,"class":"mceMenuItemTitle",onclick:function(){b.settings.onselect("")!==false&&b.select("")}});c(b.items,function(h){if(h.value===undefined)f.add({title:h.title,"class":"mceMenuItemTitle",onclick:function(){b.settings.onselect("")!==false&&b.select("")}});else{h.id=d.uniqueId();
h.onclick=function(){b.settings.onselect(h.value)!==false&&b.select(h.value)};f.add(h)}});b.onRenderMenu.dispatch(b,f);b.menu=f},postRender:function(){var b=this,f=b.classPrefix;a.add(b.id,"click",b.showMenu,b);a.add(b.id,"keydown",function(h){if(h.keyCode==32){b.showMenu(h);a.cancel(h)}});a.add(b.id,"focus",function(){if(!b._focused){b.keyDownHandler=a.add(b.id,"keydown",function(h){if(h.keyCode==40){b.showMenu();a.cancel(h)}});b.keyPressHandler=a.add(b.id,"keypress",function(h){var g;if(h.keyCode==
13){g=b.selectedValue;b.selectedValue=null;a.cancel(h);b.settings.onselect(g)}})}b._focused=1});a.add(b.id,"blur",function(){a.remove(b.id,"keydown",b.keyDownHandler);a.remove(b.id,"keypress",b.keyPressHandler);b._focused=0});if(k.isIE6||!d.boxModel){a.add(b.id,"mouseover",function(){d.hasClass(b.id,f+"Disabled")||d.addClass(b.id,f+"Hover")});a.add(b.id,"mouseout",function(){d.hasClass(b.id,f+"Disabled")||d.removeClass(b.id,f+"Hover")})}b.onPostRender.dispatch(b,d.get(b.id))},destroy:function(){this.parent();
a.clear(this.id+"_text");a.clear(this.id+"_open")}})})(tinymce);
(function(k){var d=k.DOM,a=k.dom.Event,c=k.each;k.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(e,b){this.parent(e,b);this.classPrefix="mceNativeListBox"},setDisabled:function(e){d.get(this.id).disabled=e;this.setAriaProperty("disabled",e)},isDisabled:function(){return d.get(this.id).disabled},select:function(e){var b=this,f,h;if(e==undefined)return b.selectByIndex(-1);h=e&&e.call?e:function(g){return g==e};if(e!=b.selectedValue){c(b.items,function(g,l){if(h(g.value)){f=
1;b.selectByIndex(l);return false}});f||b.selectByIndex(-1)}},selectByIndex:function(e){d.get(this.id).selectedIndex=e+1;this.selectedValue=this.items[e]?this.items[e].value:null},add:function(e,b,f){f=f||{};f.value=b;this.isRendered()&&d.add(d.get(this.id),"option",f,e);e={title:e,value:b,attribs:f};this.items.push(e);this.onAdd.dispatch(this,e)},getLength:function(){return this.items.length},renderHTML:function(){var e;e=d.createHTML("option",{value:""},"-- "+this.settings.title+" --");c(this.items,
function(b){e+=d.createHTML("option",{value:b.value},b.title)});e=d.createHTML("select",{id:this.id,"class":"mceNativeListBox","aria-labelledby":this.id+"_aria"},e);e+=d.createHTML("span",{id:this.id+"_aria",style:"display: none"},this.settings.title);return e},postRender:function(){function e(h){if((h=b.items[h.target.selectedIndex-1])&&(h=h.value)){b.onChange.dispatch(b,h);b.settings.onselect&&b.settings.onselect(h)}}var b=this,f=true;b.rendered=true;a.add(b.id,"change",e);a.add(b.id,"keydown",
function(h){var g;a.remove(b.id,"change",void 0);f=false;g=a.add(b.id,"blur",function(){if(!f){f=true;a.add(b.id,"change",e);a.remove(b.id,"blur",g)}});if(h.keyCode==13||h.keyCode==32){e(h);return a.cancel(h)}});b.onPostRender.dispatch(b,d.get(b.id))}})})(tinymce);
(function(k){var d=k.DOM,a=k.dom.Event;k.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(c,e,b){this.parent(c,e,b);this.onRenderMenu=new k.util.Dispatcher(this);e.menu_container=e.menu_container||d.doc.body},showMenu:function(){var c,e=d.get(this.id),b;if(!this.isDisabled()){if(!this.isMenuRendered){this.renderMenu();this.isMenuRendered=true}if(this.isMenuVisible)return this.hideMenu();d.getPos(this.settings.menu_container);c=d.getPos(e);b=this.menu;b.settings.offset_x=c.x;b.settings.offset_y=
c.y;b.settings.vp_offset_x=c.x;b.settings.vp_offset_y=c.y;b.settings.keyboard_focus=this._focused;b.showMenu(0,e.clientHeight);a.add(d.doc,"mousedown",this.hideMenu,this);this.setState("Selected",1);this.isMenuVisible=1}},renderMenu:function(){var c=this,e;e=c.settings.control_manager.createDropMenu(c.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:c.settings.icons});e.onHideMenu.add(function(){c.hideMenu();c.focus()});c.onRenderMenu.dispatch(c,e);c.menu=e},hideMenu:function(c){var e=
this;if(!(c&&c.type=="mousedown"&&d.getParent(c.target,function(b){return b.id===e.id||b.id===e.id+"_open"}))){if(!c||!d.getParent(c.target,".mceMenu")){e.setState("Selected",0);a.remove(d.doc,"mousedown",e.hideMenu,e);e.menu&&e.menu.hideMenu()}e.isMenuVisible=0}},postRender:function(){var c=this,e=c.settings;a.add(c.id,"click",function(){if(!c.isDisabled()){e.onclick&&e.onclick(c.value);c.showMenu()}})}})})(tinymce);
(function(k){var d=k.DOM,a=k.dom.Event;k.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(c,e,b){this.parent(c,e,b);this.classPrefix="mceSplitButton"},renderHTML:function(){var c=this.classPrefix,e,b=this.settings,f;e="<tbody><tr>";var h=d.encode(b.label||"");f=b.image?d.createHTML("img ",{src:b.image,role:"presentation","class":"mceAction "+b["class"]})+1:d.createHTML("span",{"class":"mceAction "+b["class"]},"")+(h?'<span class="'+c+'Label">'+h+"</span>":"");f+=d.createHTML("span",
{"class":"mceVoiceLabel mceIconOnly",id:this.id+"_voice",style:"display:none;"},b.title);e+="<td >"+d.createHTML("a",{role:"button",id:this.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+b["class"],onclick:"return false;",onmousedown:"return false;",title:b.title},f)+"</td>";f=d.createHTML("span",{"class":"mceOpen "+b["class"]},"");e+="<td>"+d.createHTML("a",{id:this.id+"_open",href:"javascript:;","class":"mceOpen "+b["class"],onclick:"return false;",onmousedown:"return false;",
title:b.title},f)+"</td>";e+="</tr></tbody>";return d.createHTML("table",{id:this.id,"class":c+" "+c+"Enabled "+b["class"]+(h?" "+c+"Labeled":""),cellpadding:"0",cellspacing:"0",onmousedown:"return false;",title:b.title},e)},postRender:function(){var c=this,e=c.settings,b;if(e.onclick){b=function(f){if(!c.isDisabled()){e.onclick(c.value);a.cancel(f)}};a.add(c.id+"_action","click",b);a.add(c.id,["click","keydown"],function(f){if((f.keyCode===32||f.keyCode===13||f.keyCode===14)&&!f.altKey&&!f.ctrlKey&&
!f.metaKey){b();a.cancel(f)}else if(f.type==="click"||f.keyCode===40){c.showMenu();a.cancel(f)}})}a.add(c.id+"_open","click",function(f){c.showMenu();a.cancel(f)});a.add([c.id,c.id+"_open"],"focus",function(){c._focused=1});a.add([c.id,c.id+"_open"],"blur",function(){c._focused=0});if(k.isIE6||!d.boxModel){a.add(c.id,"mouseover",function(){d.hasClass(c.id,"mceSplitButtonDisabled")||d.addClass(c.id,"mceSplitButtonHover")});a.add(c.id,"mouseout",function(){d.hasClass(c.id,"mceSplitButtonDisabled")||
d.removeClass(c.id,"mceSplitButtonHover")})}},destroy:function(){this.parent();a.clear(this.id+"_action");a.clear(this.id+"_open");a.clear(this.id)}})})(tinymce);
(function(k){var d=k.DOM,a=k.dom.Event,c=k.is,e=k.each;k.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(b,f,h){this.parent(b,f,h);this.settings=f=k.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"},
this.settings);this.onShowMenu=new k.util.Dispatcher(this);this.onHideMenu=new k.util.Dispatcher(this);this.value=f.default_color},showMenu:function(){var b=this,f,h;if(!b.isDisabled()){if(!b.isMenuRendered){b.renderMenu();b.isMenuRendered=true}if(b.isMenuVisible)return b.hideMenu();f=d.get(b.id);d.show(b.id+"_menu");d.addClass(f,"mceSplitButtonSelected");h=d.getPos(f);d.setStyles(b.id+"_menu",{left:h.x,top:h.y+f.clientHeight,zIndex:2E5});f=0;a.add(d.doc,"mousedown",b.hideMenu,b);b.onShowMenu.dispatch(b);
if(b._focused){b._keyHandler=a.add(b.id+"_menu","keydown",function(g){g.keyCode==27&&b.hideMenu()});d.select("a",b.id+"_menu")[0].focus()}b.isMenuVisible=1}},hideMenu:function(b){var f=this;if(f.isMenuVisible)if(!(b&&b.type=="mousedown"&&d.getParent(b.target,function(h){return h.id===f.id+"_open"}))){if(!b||!d.getParent(b.target,".mceSplitButtonMenu")){d.removeClass(f.id,"mceSplitButtonSelected");a.remove(d.doc,"mousedown",f.hideMenu,f);a.remove(f.id+"_menu","keydown",f._keyHandler);d.hide(f.id+"_menu")}f.isMenuVisible=
0}},renderMenu:function(){var b=this,f,h=0,g=b.settings,l,o,p,m,n;m=d.add(g.menu_container,"div",{role:"listbox",id:b.id+"_menu","class":g.menu_class+" "+g["class"],style:"position:absolute;left:0;top:-1000px;"});f=d.add(m,"div",{"class":g["class"]+" mceSplitButtonMenu"});d.add(f,"span",{"class":"mceMenuLine"});l=d.add(f,"table",{role:"presentation","class":"mceColorSplitMenu"});o=d.add(l,"tbody");h=0;e(c(g.colors,"array")?g.colors:g.colors.split(","),function(q){q=q.replace(/^#/,"");if(!h--){p=d.add(o,
"tr");h=g.grid_width-1}l=d.add(p,"td");l=d.add(l,"a",{role:"option",href:"javascript:;",style:{backgroundColor:"#"+q},title:b.editor.getLang("colors."+q,q),"data-mce-color":"#"+q});if(b.editor.forcedHighContrastMode){l=d.add(l,"canvas",{width:16,height:16,"aria-hidden":"true"});if(l.getContext&&(n=l.getContext("2d"))){n.fillStyle="#"+q;n.fillRect(0,0,16,16)}else d.remove(l)}});if(g.more_colors_func){l=d.add(o,"tr");l=d.add(l,"td",{colspan:g.grid_width,"class":"mceMoreColors"});l=d.add(l,"a",{role:"option",
id:b.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"},g.more_colors_title);a.add(l,"click",function(q){g.more_colors_func.call(g.more_colors_scope||this);return a.cancel(q)})}d.addClass(f,"mceColorSplitMenu");new k.ui.KeyboardNavigation({root:b.id+"_menu",items:d.select("a",b.id+"_menu"),onCancel:function(){b.hideMenu();b.focus()}});a.add(b.id+"_menu","mousedown",function(q){return a.cancel(q)});a.add(b.id+"_menu","click",function(q){var s;if((q=d.getParent(q.target,
"a",o))&&q.nodeName.toLowerCase()=="a"&&(s=q.getAttribute("data-mce-color")))b.setColor(s);return a.cancel(q)});return m},setColor:function(b){this.displayColor(b);this.hideMenu();this.settings.onselect(b)},displayColor:function(b){d.setStyle(this.id+"_preview","backgroundColor",b);this.value=b},postRender:function(){var b=this.id;this.parent();d.add(b+"_action","div",{id:b+"_preview","class":"mceColorPreview"});d.setStyle(this.id+"_preview","backgroundColor",this.value)},destroy:function(){this.parent();
a.clear(this.id+"_menu");a.clear(this.id+"_more");d.remove(this.id+"_menu")}})})(tinymce);
(function(k){var d=k.DOM,a=k.each,c=k.dom.Event;k.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var e=[],b=this.controls,f=k.each,h=this.settings;e.push('<div id="'+this.id+'" role="group" aria-labelledby="'+this.id+'_voice">');e.push("<span role='application'>");e.push('<span id="'+this.id+'_voice" class="mceVoiceLabel" style="display:none;">'+d.encode(h.name)+"</span>");f(b,function(g){e.push(g.renderHTML())});e.push("</span>");e.push("</div>");return e.join("")},
focus:function(){this.keyNav.focus()},postRender:function(){var e=this,b=[];a(e.controls,function(f){a(f.controls,function(h){h.id&&b.push(h)})});e.keyNav=new k.ui.KeyboardNavigation({root:e.id,items:b,onCancel:function(){e.editor.focus()},excludeFromTabOrder:!e.settings.tab_focus_toolbar})},destroy:function(){this.parent();this.keyNav.destroy();c.clear(this.id)}})})(tinymce);
(function(k){var d=k.DOM;k.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var a="",c,e,b=this.settings,f,h,g,l;l=this.controls;for(f=0;f<l.length;f++){e=l[f];h=l[f-1];g=l[f+1];if(f===0){c="mceToolbarStart";if(e.Button)c+=" mceToolbarStartButton";else if(e.SplitButton)c+=" mceToolbarStartSplitButton";else if(e.ListBox)c+=" mceToolbarStartListBox";a+=d.createHTML("td",{"class":c},d.createHTML("span",null,"<!-- IE --\>"))}if(h&&e.ListBox)if(h.Button||h.SplitButton)a+=d.createHTML("td",
{"class":"mceToolbarEnd"},d.createHTML("span",null,"<!-- IE --\>"));a+=d.stdMode?'<td style="position: relative">'+e.renderHTML()+"</td>":"<td>"+e.renderHTML()+"</td>";if(g&&e.ListBox)if(g.Button||g.SplitButton)a+=d.createHTML("td",{"class":"mceToolbarStart"},d.createHTML("span",null,"<!-- IE --\>"))}c="mceToolbarEnd";if(e.Button)c+=" mceToolbarEndButton";else if(e.SplitButton)c+=" mceToolbarEndSplitButton";else if(e.ListBox)c+=" mceToolbarEndListBox";a+=d.createHTML("td",{"class":c},d.createHTML("span",
null,"<!-- IE --\>"));return d.createHTML("table",{id:this.id,"class":"mceToolbar"+(b["class"]?" "+b["class"]:""),cellpadding:"0",cellspacing:"0",align:this.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+a+"</tr></tbody>")}})})(tinymce);
(function(k){var d=k.util.Dispatcher;k.create("tinymce.AddOnManager",{AddOnManager:function(){this.items=[];this.urls={};this.lookup={};this.onAdd=new d(this)},get:function(a){return this.lookup[a]},requireLangPack:function(a){var c=k.settings;c&&c.language&&c.language_load!==false&&k.ScriptLoader.add(this.urls[a]+"/langs/"+c.language+".js")},add:function(a,c){this.items.push(c);this.lookup[a]=c;this.onAdd.dispatch(this,a,c);return c},load:function(a,c,e,b){if(!this.urls[a]){if(c.indexOf("/")!=0&&
c.indexOf("://")==-1)c=k.baseURL+"/"+c;this.urls[a]=c.substring(0,c.lastIndexOf("/"));this.lookup[a]||k.ScriptLoader.add(c,e,b)}}});k.PluginManager=new k.AddOnManager;k.ThemeManager=new k.AddOnManager})(tinymce);
(function(k){var d=k.each,a=k.extend,c=k.DOM,e=k.dom.Event,b=k.explode,f=k.util.Dispatcher,h=0;k.documentBaseURL=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");/[\/\\]$/.test(k.documentBaseURL)||(k.documentBaseURL+="/");k.baseURL=(new k.util.URI(k.documentBaseURL)).toAbsolute(k.baseURL);k.baseURI=new k.util.URI(k.baseURL);k.onBeforeUnload=new f(k);e.add(window,"beforeunload",function(g){k.onBeforeUnload.dispatch(k,g)});k.onAddEditor=new f(k);k.onRemoveEditor=new f(k);k.EditorManager=
a(k,{editors:[],i18n:{},activeEditor:null,init:function(g){function l(q,s,r){var t=q[s];if(t){if(k.is(t,"string")){r=(r=t.replace(/\.\w+$/,""))?k.resolve(r):0;t=k.resolve(t)}return t.apply(r||this,Array.prototype.slice.call(arguments,2))}}var o=this,p,m=[],n;g=a({theme:"simple",language:"en"},g);o.settings=g;e.add(document,"init",function(){var q,s;l(g,"onpageload");switch(g.mode){case "exact":q=g.elements||"";q.length>0&&d(b(q),function(t){if(c.get(t)){n=new k.Editor(t,g);m.push(n);n.render(1)}else d(document.forms,
function(y){d(y.elements,function(u){if(u.name===t){t="mce_editor_"+h++;c.setAttrib(u,"id",t);n=new k.Editor(t,g);m.push(n);n.render(1)}})})});break;case "textareas":case "specific_textareas":var r=function(t,y){return y.constructor===RegExp?y.test(t.className):c.hasClass(t,y)};d(c.select("textarea"),function(t){if(!(g.editor_deselector&&r(t,g.editor_deselector)))if(!g.editor_selector||r(t,g.editor_selector)){p=c.get(t.name);if(!t.id&&!p)t.id=t.name;if(!t.id||o.get(t.id))t.id=c.uniqueId();n=new k.Editor(t.id,
g);m.push(n);n.render(1)}});break}if(g.oninit){q=s=0;d(m,function(t){s++;if(t.initialized)q++;else t.onInit.add(function(){q++;q==s&&l(g,"oninit")});q==s&&l(g,"oninit")})}})},get:function(g){if(g===void 0)return this.editors;return this.editors[g]},getInstanceById:function(g){return this.get(g)},add:function(g){var l=this.editors;l[g.id]=g;l.push(g);this._setActive(g);this.onAddEditor.dispatch(this,g);k.adapter&&k.adapter.patchEditor(g);return g},remove:function(g){var l,o=this.editors;if(!o[g.id])return null;
delete o[g.id];for(l=0;l<o.length;l++)if(o[l]==g){o.splice(l,1);break}this.activeEditor==g&&this._setActive(o[0]);g.destroy();this.onRemoveEditor.dispatch(this,g);return g},execCommand:function(g,l,o){var p=this.get(o),m;switch(g){case "mceFocus":p.focus();return true;case "mceAddEditor":case "mceAddControl":this.get(o)||(new k.Editor(o,this.settings)).render();return true;case "mceAddFrameControl":m=o.window;m.tinyMCE=tinyMCE;m.tinymce=k;k.DOM.doc=m.document;k.DOM.win=m;p=new k.Editor(o.element_id,
o);p.render();if(k.isIE){var n=function(){p.destroy();m.detachEvent("onunload",n);m=m.tinyMCE=m.tinymce=null};m.attachEvent("onunload",n)}o.page_window=null;return true;case "mceRemoveEditor":case "mceRemoveControl":p&&p.remove();return true;case "mceToggleEditor":if(!p){this.execCommand("mceAddControl",0,o);return true}p.isHidden()?p.show():p.hide();return true}if(this.activeEditor)return this.activeEditor.execCommand(g,l,o);return false},execInstanceCommand:function(g,l,o,p){if(g=this.get(g))return g.execCommand(l,
o,p);return false},triggerSave:function(){d(this.editors,function(g){g.save()})},addI18n:function(g,l){var o=this.i18n;k.is(g,"string")?d(l,function(p,m){o[g+"."+m]=p}):d(g,function(p,m){d(p,function(n,q){d(n,function(s,r){if(q==="common")o[m+"."+r]=s;else o[m+"."+q+"."+r]=s})})})},_setActive:function(g){this.selectedInstance=this.activeEditor=g}})})(tinymce);
(function(k){var d=k.DOM,a=k.dom.Event,c=k.extend,e=k.util.Dispatcher,b=k.each,f=k.isGecko,h=k.isIE,g=k.is,l=k.ThemeManager,o=k.PluginManager,p=k.explode;k.create("tinymce.Editor",{Editor:function(m,n){var q=this;q.id=q.editorId=m;q.execCommands={};q.queryStateCommands={};q.queryValueCommands={};q.isNotDirty=false;q.plugins={};b(["onPreInit","onBeforeRenderUI","onPostRender","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp",
"onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent","onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState"],function(s){q[s]=new e(q)});q.settings=n=c({id:m,language:"en",docs_language:"en",theme:"simple",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:k.documentBaseURL,
add_form_submit_trigger:1,submit_patch:1,add_unload_trigger:1,convert_urls:1,relative_urls:1,remove_script_host:1,table_inline_editing:0,object_resizing:1,cleanup:1,accessibility_focus:1,custom_shortcuts:1,custom_undo_redo_keyboard_shortcuts:1,custom_undo_redo_restore_selection:1,custom_undo_redo:1,doctype:k.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual_table_class:"mceItemTable",visual:1,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",
apply_source_formatting:1,directionality:"ltr",forced_root_block:"p",hidden_input:1,padd_empty_editor:1,render_ui:1,init_theme:1,force_p_newlines:1,indentation:"30px",keep_styles:1,fix_table_elements:1,inline_styles:1,convert_fonts_to_spans:true,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr",validate:true,
entity_encoding:"named",url_converter:q.convertURL,url_converter_scope:q,ie7_compat:true},n);q.documentBaseURI=new k.util.URI(n.document_base_url||k.documentBaseURL,{base_uri:tinyMCE.baseURI});q.baseURI=k.baseURI;q.contentCSS=[];q.execCallback("setup",q)},render:function(){function m(){q.language&&q.language_load!==false&&r.add(k.baseURL+"/langs/"+q.language+".js");q.theme&&q.theme.charAt(0)!="-"&&!l.urls[q.theme]&&l.load(q.theme,"themes/"+q.theme+"/editor_template"+k.suffix+".js");b(p(q.plugins),
function(t){t&&t.charAt(0)!="-"&&!o.urls[t]&&t!="safari"&&o.load(t,"plugins/"+t+"/editor_plugin"+k.suffix+".js")});r.loadQueue(function(){n.removed||n.init()})}var n=this,q=n.settings,s=n.id,r=k.ScriptLoader;if(a.domLoaded){tinyMCE.settings=q;if(n.getElement())if(!k.isIDevice){!/TEXTAREA|INPUT/i.test(n.getElement().nodeName)&&q.hidden_input&&d.getParent(s,"form")&&d.insertAfter(d.create("input",{type:"hidden",name:s}),s);if(k.WindowManager)n.windowManager=new k.WindowManager(n);q.encoding=="xml"&&
n.onGetContent.add(function(t,y){if(y.save)y.content=d.encode(y.content)});q.add_form_submit_trigger&&n.onSubmit.addToTop(function(){if(n.initialized){n.save();n.isNotDirty=1}});if(q.add_unload_trigger)n._beforeUnload=tinyMCE.onBeforeUnload.add(function(){n.initialized&&!n.destroyed&&!n.isHidden()&&n.save({format:"raw",no_events:true})});k.addUnload(n.destroy,n);q.submit_patch&&n.onBeforeRenderUI.add(function(){var t=n.getElement().form;if(t)if(!t._mceOldSubmit){if(!t.submit.nodeType&&!t.submit.length){n.formElement=
t;t._mceOldSubmit=t.submit;t.submit=function(){k.triggerSave();n.isNotDirty=1;return n.formElement._mceOldSubmit(n.formElement)}}t=null}});m()}}else a.add(document,"init",function(){n.render()})},init:function(){var m,n=this;m=n.settings;var q,s,r=n.getElement(),t,y,u;k.add(n);m.aria_label=m.aria_label||d.getAttrib(r,"aria-label",n.getLang("aria.rich_text_area"));if(m.theme){m.theme=m.theme.replace(/-/,"");t=l.get(m.theme);n.theme=new t;if(n.theme.init&&m.init_theme)n.theme.init(n,l.urls[m.theme]||
k.documentBaseURL.replace(/\/$/,""))}b(p(m.plugins.replace(/\-/g,"")),function(v){var z=o.get(v),A=o.urls[v]||k.documentBaseURL.replace(/\/$/,"");if(z){z=new z(n,A);n.plugins[v]=z;z.init&&z.init(n,A)}});if(m.popup_css!==false)m.popup_css=m.popup_css?n.documentBaseURI.toAbsolute(m.popup_css):n.baseURI.toAbsolute("themes/"+m.theme+"/skins/"+m.skin+"/dialog.css");if(m.popup_css_add)m.popup_css+=","+n.documentBaseURI.toAbsolute(m.popup_css_add);n.controlManager=new k.ControlManager(n);if(m.custom_undo_redo){n.onBeforeExecCommand.add(function(v,
z,A,C,F){if(z!="Undo"&&z!="Redo"&&z!="mceRepaint"&&(!F||!F.skip_undo))n.undoManager.beforeChange()});n.onExecCommand.add(function(v,z,A,C,F){if(z!="Undo"&&z!="Redo"&&z!="mceRepaint"&&(!F||!F.skip_undo))n.undoManager.add()})}n.onExecCommand.add(function(v,z){/^(FontName|FontSize)$/.test(z)||n.nodeChanged()});if(f){u=function(v,z){if(!z||!z.initial)n.execCommand("mceRepaint")};n.onUndo.add(u);n.onRedo.add(u);n.onSetContent.add(u)}n.onBeforeRenderUI.dispatch(n,n.controlManager);if(m.render_ui){q=m.width||
r.style.width||r.offsetWidth;s=m.height||r.style.height||r.offsetHeight;n.orgDisplay=r.style.display;u=/^[0-9\.]+(|px)$/i;if(u.test(""+q))q=Math.max(parseInt(q)+(t.deltaWidth||0),100);if(u.test(""+s))s=Math.max(parseInt(s)+(t.deltaHeight||0),100);t=n.theme.renderUI({targetNode:r,width:q,height:s,deltaWidth:m.delta_width,deltaHeight:m.delta_height});n.editorContainer=t.editorContainer}if(document.domain&&location.hostname!=document.domain)k.relaxedDomain=document.domain;d.setStyles(t.sizeContainer||
t.editorContainer,{width:q,height:s});m.content_css&&k.each(p(m.content_css),function(v){n.contentCSS.push(n.documentBaseURI.toAbsolute(v))});s=(t.iframeHeight||s)+(typeof s=="number"?t.deltaHeight||0:"");if(s<100)s=100;n.iframeHTML=m.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';if(m.document_base_url!=k.documentBaseURL)n.iframeHTML+='<base href="'+n.documentBaseURI.getURI()+'" />';n.iframeHTML+=m.ie7_compat?'<meta http-equiv="X-UA-Compatible" content="IE=7" />':'<meta http-equiv="X-UA-Compatible" content="IE=edge" />';
n.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';if(!f||!/Firefox\/2/.test(navigator.userAgent)){for(q=0;q<n.contentCSS.length;q++)n.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+n.contentCSS[q]+'" />';n.contentCSS=[]}q=m.body_id||"tinymce";if(q.indexOf("=")!=-1){q=n.getParam("body_id","","hash");q=q[n.id]||q}r=m.body_class||"";if(r.indexOf("=")!=-1){r=n.getParam("body_class","","hash");r=r[n.id]||""}n.iframeHTML+='</head><body id="'+q+'" class="mceContentBody '+
r+'"></body></html>';if(k.relaxedDomain&&(h||k.isOpera&&parseFloat(opera.version())<11))y='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+n.id+'");document.write(ed.iframeHTML);document.close();ed.setupIframe();})()';m=d.add(t.iframeContainer,"iframe",{id:n.id+"_ifr",src:y||'javascript:""',frameBorder:"0",title:m.aria_label,style:{width:"100%",height:s}});n.contentAreaContainer=t.iframeContainer;d.get(t.editorContainer).style.display=
n.orgDisplay;d.get(n.id).style.display="none";d.setAttrib(n.id,"aria-hidden",true);if(!k.relaxedDomain||!y)n.setupIframe();r=m=t=null},setupIframe:function(){var m=this,n=m.settings,q=d.get(m.id);q=m.getDoc();var s;if(!h||!k.relaxedDomain){q.open();q.write(m.iframeHTML);q.close();if(k.relaxedDomain)q.domain=k.relaxedDomain}if(!h)try{if(!n.readonly)q.designMode="On"}catch(r){}if(h){s=m.getBody();d.hide(s);if(!n.readonly)s.contentEditable=true;d.show(s)}m.schema=new k.html.Schema(n);m.dom=new k.dom.DOMUtils(m.getDoc(),
{keep_values:true,url_converter:m.convertURL,url_converter_scope:m,hex_colors:n.force_hex_style_colors,class_filter:n.class_filter,update_styles:1,fix_ie_paragraphs:1,schema:m.schema});m.parser=new k.html.DomParser(n,m.schema);m.parser.addAttributeFilter("name",function(u){for(var v=u.length,z,A,C,F;v--;){F=u[v];if(F.name==="a"&&F.firstChild){C=F.parent;z=F.lastChild;do{A=z.prev;C.insert(z,F);z=A}while(z)}}});m.parser.addAttributeFilter("src,href,style",function(u,v){for(var z=u.length,A,C=m.dom,
F;z--;){A=u[z];F=A.attr(v);v==="style"?A.attr("data-mce-style",C.serializeStyle(C.parseStyle(F),A.name)):A.attr("data-mce-"+v,m.convertURL(F,v,A.name))}});m.parser.addNodeFilter("script",function(u){for(var v=u.length;v--;)u[v].attr("type","mce-text/javascript")});m.parser.addNodeFilter("#cdata",function(u){for(var v=u.length,z;v--;){z=u[v];z.type=8;z.name="#comment";z.value="[CDATA["+z.value+"]]"}});m.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(u){for(var v=u.length,z,A=m.schema.getNonEmptyElements();v--;){z=
u[v];if(z.isEmpty(A))z.empty().append(new k.html.Node("br",1)).shortEnded=true}});m.serializer=new k.dom.Serializer(n,m.dom,m.schema);m.selection=new k.dom.Selection(m.dom,m.getWin(),m.serializer);m.formatter=new k.Formatter(this);m.formatter.register({alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img,table",collapsed:false,styles:{"float":"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img",
collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img,table",collapsed:false,styles:{"float":"right"}}],alignfull:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"}}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",
remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:false},fontname:{inline:"span",
styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],
split:false,expand:false,deep:true}]});b("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(u){m.formatter.register(u,{block:u,remove:"all"})});m.formatter.register(m.settings.formats);m.undoManager=new k.UndoManager(m);m.undoManager.onAdd.add(function(u,v){if(u.hasUndo())return m.onChange.dispatch(m,v,u)});m.undoManager.onUndo.add(function(u,v){return m.onUndo.dispatch(m,v,u)});m.undoManager.onRedo.add(function(u,v){return m.onRedo.dispatch(m,v,u)});m.forceBlocks=new k.ForceBlocks(m,
{forced_root_block:n.forced_root_block});m.editorCommands=new k.EditorCommands(m);m.serializer.onPreProcess.add(function(u,v){return m.onPreProcess.dispatch(m,v,u)});m.serializer.onPostProcess.add(function(u,v){return m.onPostProcess.dispatch(m,v,u)});m.onPreInit.dispatch(m);if(!n.gecko_spellcheck)m.getBody().spellcheck=0;n.readonly||m._addEvents();m.controlManager.onPostRender.dispatch(m,m.controlManager);m.onPostRender.dispatch(m);if(n.directionality)m.getBody().dir=n.directionality;if(n.nowrap)m.getBody().style.whiteSpace=
"nowrap";n.handle_node_change_callback&&m.onNodeChange.add(function(u,v,z){m.execCallback("handle_node_change_callback",m.id,z,-1,-1,true,m.selection.isCollapsed())});n.save_callback&&m.onSaveContent.add(function(u,v){if(u=m.execCallback("save_callback",m.id,v.content,m.getBody()))v.content=u});n.onchange_callback&&m.onChange.add(function(u,v){m.execCallback("onchange_callback",m,v)});n.protect&&m.onBeforeSetContent.add(function(u,v){n.protect&&b(n.protect,function(z){v.content=v.content.replace(z,
function(A){return"<!--mce:protected "+escape(A)+"--\>"})})});n.convert_newlines_to_brs&&m.onBeforeSetContent.add(function(u,v){if(v.initial)v.content=v.content.replace(/\r?\n/g,"<br />")});n.preformatted&&m.onPostProcess.add(function(u,v){v.content=v.content.replace(/^\s*<pre.*?>/,"");v.content=v.content.replace(/<\/pre>\s*$/,"");if(v.set)v.content='<pre class="mceItemHidden">'+v.content+"</pre>"});if(n.verify_css_classes)m.serializer.attribValueFilter=function(u,v){var z;if(u=="class"){if(!m.classesRE){u=
m.dom.getClasses();if(u.length>0){z="";b(u,function(A){z+=(z?"|":"")+A["class"]});m.classesRE=new RegExp("("+z+")","gi")}}return!m.classesRE||/(\bmceItem\w+\b|\bmceTemp\w+\b)/g.test(v)||m.classesRE.test(v)?v:""}return v};if(n.cleanup_callback){m.onBeforeSetContent.add(function(u,v){v.content=m.execCallback("cleanup_callback","insert_to_editor",v.content,v)});m.onPreProcess.add(function(u,v){v.set&&m.execCallback("cleanup_callback","insert_to_editor_dom",v.node,v);v.get&&m.execCallback("cleanup_callback",
"get_from_editor_dom",v.node,v)});m.onPostProcess.add(function(u,v){if(v.set)v.content=m.execCallback("cleanup_callback","insert_to_editor",v.content,v);if(v.get)v.content=m.execCallback("cleanup_callback","get_from_editor",v.content,v)})}n.save_callback&&m.onGetContent.add(function(u,v){if(v.save)v.content=m.execCallback("save_callback",m.id,v.content,m.getBody())});n.handle_event_callback&&m.onEvent.add(function(u,v,z){m.execCallback("handle_event_callback",v,u,z)===false&&a.cancel(v)});m.onSetContent.add(function(){m.addVisual(m.getBody())});
n.padd_empty_editor&&m.onPostProcess.add(function(u,v){v.content=v.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")});if(f){var t=function(u){b(u.dom.select("a"),function(v){var z=v.parentNode;u.dom.isBlock(z)&&z.lastChild===v&&u.dom.add(z,"br",{"data-mce-bogus":1})})};m.onExecCommand.add(function(u,v){v==="CreateLink"&&t(u)});m.onSetContent.add(m.selection.onSetContent.add(t));if(!n.readonly)try{q.designMode="Off";q.designMode="On"}catch(y){}}setTimeout(function(){if(!m.removed){m.load({initial:true,
format:"html"});m.startContent=m.getContent({format:"raw"});m.undoManager.add();m.initialized=true;m.onInit.dispatch(m);m.execCallback("setupcontent_callback",m.id,m.getBody(),m.getDoc());m.execCallback("init_instance_callback",m);m.focus(true);m.nodeChanged({initial:1});b(m.contentCSS,function(u){m.dom.loadCSS(u)});n.auto_focus&&setTimeout(function(){var u=k.get(n.auto_focus);u.selection.select(u.getBody(),1);u.selection.collapse(1);u.getWin().focus()},100)}},1);q=null},focus:function(m){var n;n=
this.settings.content_editable;var q,s=this.getDoc();if(!m){m=this.selection.getRng();if(m.item)q=m.item(0);n||this.getWin().focus();if(q&&q.ownerDocument==s){m=s.body.createControlRange();m.addElement(q);m.select()}}if(k.activeEditor!=this){if((n=k.activeEditor)!=null)n.onDeactivate.dispatch(n,this);this.onActivate.dispatch(this,n)}k._setActive(this)},execCallback:function(m){var n=this.settings[m],q;if(n){if(this.callbackLookup&&(q=this.callbackLookup[m])){n=q.func;q=q.scope}if(g(n,"string")){q=
(q=n.replace(/\.\w+$/,""))?k.resolve(q):0;n=k.resolve(n);this.callbackLookup=this.callbackLookup||{};this.callbackLookup[m]={func:n,scope:q}}return n.apply(q||this,Array.prototype.slice.call(arguments,1))}},translate:function(m){var n=this.settings.language||"en",q=k.i18n;if(!m)return"";return q[n+"."+m]||m.replace(/{\#([^}]+)\}/g,function(s,r){return q[n+"."+r]||"{#"+r+"}"})},getLang:function(m,n){return k.i18n[(this.settings.language||"en")+"."+m]||(g(n)?n:"{#"+m+"}")},getParam:function(m,n,q){var s=
k.trim;m=g(this.settings[m])?this.settings[m]:n;var r;if(q==="hash"){r={};if(g(m,"string"))b(m.indexOf("=")>0?m.split(/[;,](?![^=;,]*(?:[;,]|$))/):m.split(","),function(t){t=t.split("=");if(t.length>1)r[s(t[0])]=s(t[1]);else r[s(t[0])]=s(t)});else r=m;return r}return m},nodeChanged:function(m){var n=this.selection,q=n.getStart()||this.getBody();if(this.initialized){m=m||{};q=h&&q.ownerDocument!=this.getDoc()?this.getBody():q;m.parents=[];this.dom.getParent(q,function(s){if(s.nodeName=="BODY")return true;
m.parents.push(s)});this.onNodeChange.dispatch(this,m?m.controlManager||this.controlManager:this.controlManager,q,n.isCollapsed(),m)}},addButton:function(m,n){this.buttons=this.buttons||{};this.buttons[m]=n},addCommand:function(m,n,q){this.execCommands[m]={func:n,scope:q||this}},addQueryStateHandler:function(m,n,q){this.queryStateCommands[m]={func:n,scope:q||this}},addQueryValueHandler:function(m,n,q){this.queryValueCommands[m]={func:n,scope:q||this}},addShortcut:function(m,n,q,s){var r=this,t;if(!r.settings.custom_shortcuts)return false;
r.shortcuts=r.shortcuts||{};if(g(q,"string")){t=q;q=function(){r.execCommand(t,false,null)}}if(g(q,"object")){t=q;q=function(){r.execCommand(t[0],t[1],t[2])}}b(p(m),function(y){var u={func:q,scope:s||this,desc:n,alt:false,ctrl:false,shift:false};b(p(y,"+"),function(v){switch(v){case "alt":case "ctrl":case "shift":u[v]=true;break;default:u.charCode=v.charCodeAt(0);u.keyCode=v.toUpperCase().charCodeAt(0)}});r.shortcuts[(u.ctrl?"ctrl":"")+","+(u.alt?"alt":"")+","+(u.shift?"shift":"")+","+u.keyCode]=
u});return true},execCommand:function(m,n,q,s){var r=this,t=0,y;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(m)&&(!s||!s.skip_focus))r.focus();y=k.extend({},s);r.onBeforeExecCommand.dispatch(r,m,n,q,y);if(y.terminate)return false;if(r.execCallback("execcommand_callback",r.id,r.selection.getNode(),m,n,q)){r.onExecCommand.dispatch(r,m,n,q,s);return true}if(y=r.execCommands[m]){y=y.func.call(y.scope,n,q);if(y!==true){r.onExecCommand.dispatch(r,m,n,q,s);return y}}b(r.plugins,
function(u){if(u.execCommand&&u.execCommand(m,n,q)){r.onExecCommand.dispatch(r,m,n,q,s);t=1;return false}});if(t)return true;if(r.theme&&r.theme.execCommand&&r.theme.execCommand(m,n,q)){r.onExecCommand.dispatch(r,m,n,q,s);return true}if(r.editorCommands.execCommand(m,n,q)){r.onExecCommand.dispatch(r,m,n,q,s);return true}r.getDoc().execCommand(m,n,q);r.onExecCommand.dispatch(r,m,n,q,s)},queryCommandState:function(m){var n;if(!this._isHidden()){if(n=this.queryStateCommands[m]){n=n.func.call(n.scope);
if(n!==true)return n}n=this.editorCommands.queryCommandState(m);if(n!==-1)return n;try{return this.getDoc().queryCommandState(m)}catch(q){}}},queryCommandValue:function(m){var n;if(!this._isHidden()){if(n=this.queryValueCommands[m]){n=n.func.call(n.scope);if(n!==true)return n}n=this.editorCommands.queryCommandValue(m);if(g(n))return n;try{return this.getDoc().queryCommandValue(m)}catch(q){}}},show:function(){d.show(this.getContainer());d.hide(this.id);this.load()},hide:function(){var m=this.getDoc();
h&&m&&m.execCommand("SelectAll");this.save();d.hide(this.getContainer());d.setStyle(this.id,"display",this.orgDisplay)},isHidden:function(){return!d.isHidden(this.id)},setProgressState:function(m,n,q){this.onSetProgressState.dispatch(this,m,n,q);return m},load:function(m){var n=this.getElement(),q;if(n){m=m||{};m.load=true;q=this.setContent(g(n.value)?n.value:n.innerHTML,m);m.element=n;m.no_events||this.onLoadContent.dispatch(this,m);m.element=null;return q}},save:function(m){var n=this,q=n.getElement(),
s;if(q&&n.initialized){m=m||{};m.save=true;if(!m.no_events){n.undoManager.typing=false;n.undoManager.add()}m.element=q;s=m.content=n.getContent(m);m.no_events||n.onSaveContent.dispatch(n,m);s=m.content;if(/TEXTAREA|INPUT/i.test(q.nodeName))q.value=s;else{q.innerHTML=s;if(q=d.getParent(n.id,"form"))b(q.elements,function(r){if(r.name==n.id){r.value=s;return false}})}m.element=q=null;return s}},setContent:function(m,n){var q=this.getBody();n=n||{};n.format=n.format||"html";n.set=true;n.content=m;n.no_events||
this.onBeforeSetContent.dispatch(this,n);m=n.content;if(!k.isIE&&(m.length===0||/^\s+$/.test(m)))q.innerHTML='<br data-mce-bogus="1" />';else{if(n.format!=="raw")m=(new k.html.Serializer({},this.schema)).serialize(this.parser.parse(m));n.content=k.trim(m);this.dom.setHTML(q,n.content);n.no_events||this.onSetContent.dispatch(this,n);return n.content}},getContent:function(m){var n;m=m||{};m.format=m.format||"html";m.get=true;m.no_events||this.onBeforeGetContent.dispatch(this,m);n=m.format=="raw"?this.getBody().innerHTML:
this.serializer.serialize(this.getBody(),m);m.content=k.trim(n);m.no_events||this.onGetContent.dispatch(this,m);return m.content},isDirty:function(){return k.trim(this.startContent)!=k.trim(this.getContent({format:"raw",no_events:1}))&&!this.isNotDirty},getContainer:function(){if(!this.container)this.container=d.get(this.editorContainer||this.id+"_parent");return this.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return d.get(this.settings.content_element||
this.id)},getWin:function(){var m;if(!this.contentWindow)if(m=d.get(this.id+"_ifr"))this.contentWindow=m.contentWindow;return this.contentWindow},getDoc:function(){var m;if(!this.contentDocument)if(m=this.getWin())this.contentDocument=m.document;return this.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(m,n,q){var s=this.settings;if(s.urlconverter_callback)return this.execCallback("urlconverter_callback",m,q,true,n);if(!s.convert_urls||q&&q.nodeName==
"LINK"||m.indexOf("file:")===0)return m;if(s.relative_urls)return this.documentBaseURI.toRelative(m);return m=this.documentBaseURI.toAbsolute(m,s.remove_script_host)},addVisual:function(m){var n=this,q=n.settings;m=m||n.getBody();if(!g(n.hasVisual))n.hasVisual=q.visual;b(n.dom.select("table,a",m),function(s){var r;switch(s.nodeName){case "TABLE":r=n.dom.getAttrib(s,"border");if(!r||r=="0")n.hasVisual?n.dom.addClass(s,q.visual_table_class):n.dom.removeClass(s,q.visual_table_class);return;case "A":if(r=
n.dom.getAttrib(s,"name"))n.hasVisual?n.dom.addClass(s,"mceItemAnchor"):n.dom.removeClass(s,"mceItemAnchor");return}});n.onVisualAid.dispatch(n,m,n.hasVisual)},remove:function(){var m=this.getContainer();this.removed=1;this.hide();this.execCallback("remove_instance_callback",this);this.onRemove.dispatch(this);this.onExecCommand.listeners=[];k.remove(this);d.remove(m)},destroy:function(m){if(!this.destroyed){if(!m){k.removeUnload(this.destroy);tinyMCE.onBeforeUnload.remove(this._beforeUnload);this.theme&&
this.theme.destroy&&this.theme.destroy();this.controlManager.destroy();this.selection.destroy();this.dom.destroy();if(!this.settings.content_editable){a.clear(this.getWin());a.clear(this.getDoc())}a.clear(this.getBody());a.clear(this.formElement)}if(this.formElement){this.formElement.submit=this.formElement._mceOldSubmit;this.formElement._mceOldSubmit=null}this.contentAreaContainer=this.formElement=this.container=this.settings.content_element=this.bodyElement=this.contentDocument=this.contentWindow=
null;if(this.selection)this.selection=this.selection.win=this.selection.dom=this.selection.dom.doc=null;this.destroyed=1}},_addEvents:function(){function m(A,C){if(!n.removed)if(n.onEvent.dispatch(n,A,C)!==false)n[t[A.fakeType||A.type]].dispatch(n,A,C)}var n=this,q,s=n.settings,r=n.dom,t={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};
b(t,function(A,C){switch(C){case "contextmenu":r.bind(n.getDoc(),C,m);break;case "paste":r.bind(n.getBody(),C,function(F){m(F)});break;case "submit":case "reset":r.bind(n.getElement().form||d.getParent(n.id,"form"),C,m);break;default:r.bind(s.content_editable?n.getBody():n.getDoc(),C,m)}});r.bind(s.content_editable?n.getBody():f?n.getDoc():n.getWin(),"focus",function(){n.focus(true)});k.isGecko&&r.bind(n.getDoc(),"DOMNodeInserted",function(A){var C;A=A.target;if(A.nodeType===1&&A.nodeName==="IMG"&&
(C=A.getAttribute("data-mce-src")))A.src=n.documentBaseURI.toAbsolute(C)});if(f){q=function(){var A=this.getDoc(),C=this.settings;if(f&&!C.readonly){if(this._isHidden())try{if(!C.content_editable)A.designMode="On"}catch(F){}try{A.execCommand("styleWithCSS",0,false)}catch(K){if(!this._isHidden())try{A.execCommand("useCSS",0,true)}catch(L){}}if(!C.table_inline_editing)try{A.execCommand("enableInlineTableEditing",false,false)}catch(M){}if(!C.object_resizing)try{A.execCommand("enableObjectResizing",false,
false)}catch(W){}}};n.onBeforeExecCommand.add(q);n.onMouseDown.add(q)}k.isWebKit&&n.onClick.add(function(A,C){C=C.target;if(C.nodeName=="IMG"||C.nodeName=="A"&&r.hasClass(C,"mceItemAnchor")){n.selection.getSel().setBaseAndExtent(C,0,C,1);n.nodeChanged()}});n.onMouseUp.add(n.nodeChanged);n.onKeyUp.add(function(A,C){A=C.keyCode;if(A>=33&&A<=36||A>=37&&A<=40||A==13||A==45||A==46||A==8||k.isMac&&(A==91||A==93)||C.ctrlKey)n.nodeChanged()});n.onReset.add(function(){n.setContent(n.startContent,{format:"raw"})});
if(s.custom_shortcuts){if(s.custom_undo_redo_keyboard_shortcuts){n.addShortcut("ctrl+z",n.getLang("undo_desc"),"Undo");n.addShortcut("ctrl+y",n.getLang("redo_desc"),"Redo")}n.addShortcut("ctrl+b",n.getLang("bold_desc"),"Bold");n.addShortcut("ctrl+i",n.getLang("italic_desc"),"Italic");n.addShortcut("ctrl+u",n.getLang("underline_desc"),"Underline");for(q=1;q<=6;q++)n.addShortcut("ctrl+"+q,"",["FormatBlock",false,"h"+q]);n.addShortcut("ctrl+7","",["FormatBlock",false,"<p>"]);n.addShortcut("ctrl+8","",
["FormatBlock",false,"<div>"]);n.addShortcut("ctrl+9","",["FormatBlock",false,"<address>"]);var y=function(A){var C=null;if(!A.altKey&&!A.ctrlKey&&!A.metaKey)return C;b(n.shortcuts,function(F){if(!(k.isMac&&F.ctrl!=A.metaKey))if(!(!k.isMac&&F.ctrl!=A.ctrlKey))if(F.alt==A.altKey)if(F.shift==A.shiftKey)if(A.keyCode==F.keyCode||A.charCode&&A.charCode==F.charCode){C=F;return false}});return C};n.onKeyUp.add(function(A,C){if(y(C))return a.cancel(C)});n.onKeyPress.add(function(A,C){if(y(C))return a.cancel(C)});
n.onKeyDown.add(function(A,C){if(A=y(C)){A.func.call(A.scope);return a.cancel(C)}})}if(k.isIE){r.bind(n.getDoc(),"controlselect",function(A){var C=n.resizeInfo;A=A.target;if(A.nodeName==="IMG"){C&&r.unbind(C.node,C.ev,C.cb);if(r.hasClass(A,"mceItemNoResize")){ev="resizestart";C=r.bind(A,"resizestart",a.cancel,a)}else{ev="resizeend";C=r.bind(A,ev,function(F){var K;F=F.target;if(K=r.getStyle(F,"width")){r.setAttrib(F,"width",K.replace(/[^0-9%]+/g,""));r.setStyle(F,"width","")}if(K=r.getStyle(F,"height")){r.setAttrib(F,
"height",K.replace(/[^0-9%]+/g,""));r.setStyle(F,"height","")}})}C=n.resizeInfo={node:A,ev:ev,cb:C}}});n.onKeyDown.add(function(A,C){var F;switch(C.keyCode){case 8:F=n.getDoc().selection;if(F.createRange&&F.createRange().item){A.dom.remove(F.createRange().item(0));return a.cancel(C)}}})}k.isOpera&&n.onClick.add(function(A,C){a.prevent(C)});if(s.custom_undo_redo){var u=function(){n.undoManager.typing=false;n.undoManager.add()};r.bind(n.getDoc(),"focusout",function(){!n.removed&&n.undoManager.typing&&
u()});n.dom.bind(n.dom.getRoot(),"dragend",function(){u()});n.onKeyUp.add(function(A,C){var F;if(h&&C.keyCode==8){A=n.selection.getRng();if(A.parentElement){A=A.parentElement();F=n.selection.getBookmark();A.innerHTML=A.innerHTML;n.selection.moveToBookmark(F)}}if(C.keyCode>=33&&C.keyCode<=36||C.keyCode>=37&&C.keyCode<=40||C.keyCode==13||C.keyCode==45||C.ctrlKey)u()});n.onKeyDown.add(function(A,C){var F;F=C.keyCode;if(h&&F==46){A=n.selection.getRng();if(A.parentElement){F=A.parentElement();if(!n.undoManager.typing){n.undoManager.beforeChange();
n.undoManager.typing=true;n.undoManager.add()}if(C.ctrlKey){A.moveEnd("word",1);A.select()}n.selection.getSel().clear();if(A.parentElement()==F){A=n.selection.getBookmark();try{F.innerHTML=F.innerHTML}catch(K){}n.selection.moveToBookmark(A)}C.preventDefault();return}}if(F>=33&&F<=36||F>=37&&F<=40||F==13||F==45){k.isIE&&F==13&&n.undoManager.beforeChange();n.undoManager.typing&&u()}else if((F<16||F>20)&&F!=224&&F!=91&&!n.undoManager.typing){n.undoManager.beforeChange();n.undoManager.add();n.undoManager.typing=
true}});n.onMouseDown.add(function(){n.undoManager.typing&&u()})}if(k.isGecko){var v=function(){var A=n.dom.getAttribs(n.selection.getStart().cloneNode(false));return function(){var C=n.selection.getStart();n.dom.removeAllAttribs(C);b(A,function(F){C.setAttributeNode(F.cloneNode(true))})}},z=function(){var A=n.selection;return!A.isCollapsed()&&A.getStart()!=A.getEnd()};n.onKeyPress.add(function(A,C){if((C.keyCode==8||C.keyCode==46)&&z()){A=v();n.getDoc().execCommand("delete",false,null);A();return a.cancel(C)}});
n.dom.bind(n.getDoc(),"cut",function(){var A;if(z()){A=v();n.onKeyUp.addToTop(a.cancel,a);setTimeout(function(){A();n.onKeyUp.remove(a.cancel,a)},0)}})}},_isHidden:function(){var m;if(!f)return 0;m=this.selection.getSel();return!m||!m.rangeCount||m.rangeCount==0}})})(tinymce);
(function(k){var d=k.each,a=true,c=false;k.EditorCommands=function(e){function b(u,v,z){var A;u=u.toLowerCase();if(A=r.exec[u]){A(u,v,z);return a}return c}function f(u){var v;u=u.toLowerCase();if(v=r.state[u])return v(u);return-1}function h(u){var v;u=u.toLowerCase();if(v=r.value[u])return v(u);return c}function g(u,v){v=v||"exec";d(u,function(z,A){d(A.toLowerCase().split(","),function(C){r[v][C]=z})})}function l(u,v,z){if(v===void 0)v=c;if(z===void 0)z=null;return e.getDoc().execCommand(u,v,z)}function o(u){return e.formatter.match(u)}
function p(u,v){e.formatter.toggle(u,v?{value:v}:void 0)}function m(u){y=s.getBookmark(u)}function n(){s.moveToBookmark(y)}var q=e.dom,s=e.selection,r={state:{},exec:{},value:{}},t=e.settings,y;k.extend(this,{execCommand:b,queryCommandState:f,queryCommandValue:h,addCommands:g});g({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(u){var v=e.getDoc(),z;try{l(u)}catch(A){z=a}if(z||!v.queryCommandSupported(u))k.isGecko?
e.windowManager.confirm(e.getLang("clipboard_msg"),function(C){C&&open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")}):e.windowManager.alert(e.getLang("clipboard_no_support"))},unlink:function(u){s.isCollapsed()&&s.select(s.getNode());l(u);s.collapse(c)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(u){var v=u.substring(7);d("left,center,right,full".split(","),function(z){v!=z&&e.formatter.remove("align"+z)});p("align"+v);b("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(u){var v;
l(u);if(u=q.getParent(s.getNode(),"ol,ul")){v=u.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(v.nodeName)){m();q.split(v,u);n()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(u){p(u)},"ForeColor,HiliteColor,FontName":function(u,v,z){p(u,z)},FontSize:function(u,v,z){var A;if(z>=1&&z<=7){A=k.explode(t.font_size_style_values);z=(v=k.explode(t.font_size_classes))?v[z-1]||z:A[z-1]||z}p(u,z)},RemoveFormat:function(u){e.formatter.remove(u)},mceBlockQuote:function(){p("blockquote")},
FormatBlock:function(u,v,z){return p(z||"p")},mceCleanup:function(){var u=s.getBookmark();e.setContent(e.getContent({cleanup:a}),{cleanup:a});s.moveToBookmark(u)},mceRemoveNode:function(u,v,z){u=z||s.getNode();if(u!=e.getBody()){m();e.dom.remove(u,a);n()}},mceSelectNodeDepth:function(u,v,z){var A=0;q.getParent(s.getNode(),function(C){if(C.nodeType==1&&A++==z){s.select(C);return c}},e.getBody())},mceSelectNode:function(u,v,z){s.select(z)},mceInsertContent:function(u,v,z){function A(K,L,M){for(L=new k.dom.TreeWalker(M?
K.nextSibling:K.previousSibling,L);K=L.current();){if(K.nodeType==3&&k.trim(K.nodeValue).length||K.nodeName=="BR"||K.nodeName=="IMG")return K;M?L.next():L.prev()}}var C,F;u={content:z,format:"html"};s.onBeforeSetContent.dispatch(s,u);z=u.content;if(z.indexOf("{$caret}")==-1)z+="{$caret}";s.setContent('<span id="__mce">\ufeff</span>',{no_events:false});q.setOuterHTML("__mce",z.replace(/\{\$caret\}/,'<span data-mce-type="bookmark" id="__mce">\ufeff</span>'));v=q.select("#__mce")[0];F=q.getRoot();if(v.previousSibling&&
q.isBlock(v.previousSibling)||v.parentNode==F)if(z=A(v,F))z.nodeName=="BR"?z.parentNode.insertBefore(v,z):q.insertAfter(v,z);for(;v;){if(v===F){q.setOuterHTML(C,(new k.html.Serializer({},e.schema)).serialize(e.parser.parse(q.getOuterHTML(C))));break}C=v;v=v.parentNode}if(v=q.select("#__mce")[0]){z=A(v,F)||A(v,F,true);q.remove(v);if(z){C=q.createRng();if(z.nodeType==3){C.setStart(z,z.length);C.setEnd(z,z.length)}else if(z.nodeName=="BR"){C.setStartBefore(z);C.setEndBefore(z)}else{C.setStartAfter(z);
C.setEndAfter(z)}s.setRng(C);if(!k.isIE){z=q.create("span",null,"\u00a0");C.insertNode(z);C=q.getRect(z);v=q.getViewPort(e.getWin());if(C.y>v.y+v.h||C.y<v.y||C.x>v.x+v.w||C.x<v.x){e.getBody().scrollLeft=C.x;e.getBody().scrollTop=C.y}q.remove(z)}s.collapse(true)}}s.onSetContent.dispatch(s,u);e.addVisual()},mceInsertRawHTML:function(u,v,z){s.setContent("tiny_mce_marker");e.setContent(e.getContent().replace(/tiny_mce_marker/g,function(){return z}))},mceSetContent:function(u,v,z){e.setContent(z)},"Indent,Outdent":function(u){var v,
z,A;v=t.indentation;z=/[a-z%]+$/i.exec(v);v=parseInt(v);!f("InsertUnorderedList")&&!f("InsertOrderedList")?d(s.getSelectedBlocks(),function(C){if(u=="outdent"){A=Math.max(0,parseInt(C.style.paddingLeft||0)-v);q.setStyle(C,"paddingLeft",A?A+z:"")}else q.setStyle(C,"paddingLeft",parseInt(C.style.paddingLeft||0)+v+z)}):l(u)},mceRepaint:function(){if(k.isGecko)try{m(a);s.getSel()&&s.getSel().selectAllChildren(e.getBody());s.collapse(a);n()}catch(u){}},mceToggleFormat:function(u,v,z){e.formatter.toggle(z)},
InsertHorizontalRule:function(){e.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual;e.addVisual()},mceReplaceContent:function(u,v,z){e.execCommand("mceInsertContent",false,z.replace(/\{\$selection\}/g,s.getContent({format:"text"})))},mceInsertLink:function(u,v,z){u=q.getParent(s.getNode(),"a");var A,C;if(k.is(z,"string"))z={href:z};z.href=z.href.replace(" ","%20");if(u)z.href?q.setAttribs(u,z):e.dom.remove(u,a);else{if(k.isWebKit)if(A=q.getParent(s.getNode(),
"img")){C=A.style.cssFloat;A.style.cssFloat=null}l("CreateLink",c,"javascript:mctmp(0);");if(C)A.style.cssFloat=C;d(q.select("a[href='javascript:mctmp(0);']"),function(F){q.setAttribs(F,z)})}},selectAll:function(){var u=q.getRoot(),v=q.createRng();v.setStart(u,0);v.setEnd(u,u.childNodes.length);e.selection.setRng(v)}});g({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(u){return o("align"+u.substring(7))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(u){return o(u)},
mceBlockQuote:function(){return o("blockquote")},Outdent:function(){var u;if(t.inline_styles){if((u=q.getParent(s.getStart(),q.isBlock))&&parseInt(u.style.paddingLeft)>0)return a;if((u=q.getParent(s.getEnd(),q.isBlock))&&parseInt(u.style.paddingLeft)>0)return a}return f("InsertUnorderedList")||f("InsertOrderedList")||!t.inline_styles&&!!q.getParent(s.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(u){return q.getParent(s.getNode(),u=="insertunorderedlist"?"UL":"OL")}},"state");
g({"FontSize,FontName":function(u){var v=0,z;if(z=q.getParent(s.getNode(),"span"))v=u=="fontsize"?z.style.fontSize:z.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase();return v}},"value");t.custom_undo_redo&&g({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}})}})(tinymce);
(function(k){var d=k.util.Dispatcher;k.UndoManager=function(a){function c(){return k.trim(a.getContent({format:"raw",no_events:1}))}var e,b=0,f=[];return e={typing:false,onAdd:new d(e),onUndo:new d(e),onRedo:new d(e),beforeChange:function(){if(f[b])f[b].beforeBookmark=a.selection.getBookmark(2,true)},add:function(h){var g;g=a.settings;var l;h=h||{};h.content=c();if((l=f[b])&&l.content==h.content)return null;if(g.custom_undo_redo_levels)if(f.length>g.custom_undo_redo_levels){for(g=0;g<f.length-1;g++)f[g]=
f[g+1];f.length--;b=f.length}h.bookmark=a.selection.getBookmark(2,true);if(b<f.length-1)f.length=b+1;f.push(h);b=f.length-1;e.onAdd.dispatch(e,h);a.isNotDirty=0;return h},undo:function(){var h;if(e.typing){e.add();e.typing=false}if(b>0){h=f[--b];a.setContent(h.content,{format:"raw"});a.selection.moveToBookmark(h.beforeBookmark);e.onUndo.dispatch(e,h)}return h},redo:function(){var h;if(b<f.length-1){h=f[++b];a.setContent(h.content,{format:"raw"});a.selection.moveToBookmark(h.bookmark);e.onRedo.dispatch(e,
h)}return h},clear:function(){f=[];b=0;e.typing=false},hasUndo:function(){return b>0||this.typing},hasRedo:function(){return b<f.length-1&&!this.typing}}}})(tinymce);
(function(k){function d(o){var p,m,n;do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(o.nodeName)){if(p){m=o.cloneNode(false);m.appendChild(p);p=m}else p=n=o.cloneNode(false);p.removeAttribute("id")}while(o=o.parentNode);if(p)return{wrapper:p,inner:n}}function a(o,p){var m=p.ownerDocument.createRange();m.setStart(o.endContainer,o.endOffset);m.setEndAfter(p);return m.cloneContents().textContent.length==0}function c(o,p,m){var n;if(p.isEmpty(m)){n=p.getParent(m,"ul,ol");if(!p.getParent(n.parentNode,
"ul,ol")){p.split(n,m);n=p.create("p",0,'<br data-mce-bogus="1" />');p.replace(n,m);o.select(n,1)}return l}return g}var e=k.dom.Event,b=k.isIE,f=k.isGecko,h=k.isOpera,g=true,l=false;k.create("tinymce.ForceBlocks",{ForceBlocks:function(o){var p=this,m=o.settings,n;p.editor=o;p.dom=o.dom;n=(m.forced_root_block||"p").toLowerCase();m.element=n.toUpperCase();o.onPreInit.add(p.setup,p);if(m.forced_root_block){o.onInit.add(p.forceRoots,p);o.onSetContent.add(p.forceRoots,p);o.onBeforeGetContent.add(p.forceRoots,
p);o.onExecCommand.add(function(q,s){if(s=="mceInsertContent"){p.forceRoots();q.nodeChanged()}})}},setup:function(){var o=this,p=o.editor,m=p.settings,n=p.dom,q=p.selection;if(m.forced_root_block){p.onBeforeExecCommand.add(o.forceRoots,o);p.onKeyUp.add(o.forceRoots,o);p.onPreProcess.add(o.forceRoots,o)}m.force_br_newlines&&b&&p.onKeyPress.add(function(r,t){if(t.keyCode==13&&!n.getParent(q.getNode(),"h1,h2,h3,h4,h5,h6,ol,ul,a")){q.setContent('<br id="__" /> ',{format:"raw"});r=n.get("__");r.removeAttribute("id");
q.select(r);q.collapse();return e.cancel(t)}});if(m.force_p_newlines){if(b){k.addUnload(function(){o._previousFormats=0});p.onKeyPress.add(function(r,t){o._previousFormats=0;if(t.keyCode==13&&!t.shiftKey&&r.selection.isCollapsed()&&m.keep_styles)o._previousFormats=d(r.selection.getStart())});p.onKeyUp.add(function(r,t){if(t.keyCode==13&&!t.shiftKey){t=r.selection.getStart();var y=o._previousFormats;if(!t.hasChildNodes()&&y)if((t=n.getParent(t,n.isBlock))&&t.nodeName!="LI"){t.innerHTML="";if(o._previousFormats){t.appendChild(y.wrapper);
y.inner.innerHTML="\ufeff"}else t.innerHTML="\ufeff";q.select(t,1);q.collapse(true);r.getDoc().execCommand("Delete",false,null);o._previousFormats=0}}})}else p.onKeyPress.add(function(r,t){t.keyCode==13&&!t.shiftKey&&!o.insertPara(t)&&e.cancel(t)});f&&p.onKeyDown.add(function(r,t){if((t.keyCode==8||t.keyCode==46)&&!t.shiftKey)o.backspaceDelete(t,t.keyCode==8)})}if(k.isWebKit){var s=function(r){var t=q.getRng(),y,u=n.create("div",null," "),v=n.getViewPort(r.getWin()).h;t.insertNode(y=n.create("br"));
t.setStartAfter(y);t.setEndAfter(y);q.setRng(t);if(q.getSel().focusNode==y.previousSibling){q.select(n.insertAfter(n.doc.createTextNode("\u00a0"),y));q.collapse(g)}n.insertAfter(u,y);t=n.getPos(u).y;n.remove(u);t>v&&r.getWin().scrollTo(0,t)};p.onKeyPress.add(function(r,t){if(t.keyCode==13&&(t.shiftKey||m.force_br_newlines&&!n.getParent(q.getNode(),"h1,h2,h3,h4,h5,h6,ol,ul,a"))){s(r);e.cancel(t)}})}if(b)if(m.element!="P"){p.onKeyPress.add(function(){o.lastElm=q.getNode().nodeName});p.onKeyUp.add(function(r,
t){var y=q.getNode();if(r.getBody().childNodes.length===1&&y.nodeName=="P"){y=n.rename(y,m.element);q.select(y);q.collapse();r.nodeChanged()}else if(t.keyCode==13&&!t.shiftKey&&o.lastElm!="P")if(t=n.getParent(y,"p")){n.rename(t,m.element);r.nodeChanged()}})}},find:function(o,p,m){for(var n=this.editor.getDoc().createTreeWalker(o,4,null,l),q=-1;o=n.nextNode();){q++;if(p==0&&o==m)return q;if(p==1&&q==m)return o}return-1},forceRoots:function(o){o=this.editor;var p=o.getBody(),m=o.getDoc(),n=o.selection,
q=n.getSel(),s=n.getRng(),r=-2,t,y,u,v,z,A=p.childNodes,C,F,K;for(C=A.length-1;C>=0;C--){z=A[C];if(z.nodeType===1&&z.getAttribute("data-mce-type"))v=null;else if(z.nodeType===3||!this.dom.isBlock(z)&&z.nodeType!==8&&!/^(script|mce:script|style|mce:style)$/i.test(z.nodeName))if(v)v.hasChildNodes()?v.insertBefore(z,v.firstChild):v.appendChild(z);else{if(z.nodeType!=3||/[^\s]/g.test(z.nodeValue)){if(r==-2&&s)if(!b||s.setStart)if(s.startContainer.nodeType==1&&(F=s.startContainer.childNodes[s.startOffset])&&
F.nodeType==1){K=F.getAttribute("id");F.setAttribute("id","__mce")}else{if(o.dom.getParent(s.startContainer,function(M){return M===p})){y=s.startOffset;u=s.endOffset;r=this.find(p,0,s.startContainer);t=this.find(p,0,s.endContainer)}}else{if(s.item){v=m.body.createTextRange();v.moveToElementText(s.item(0));s=v}v=m.body.createTextRange();v.moveToElementText(p);v.collapse(1);r=v.move("character",-16777215)*-1;v=s.duplicate();v.collapse(1);t=v.move("character",-16777215)*-1;v=s.duplicate();v.collapse(0);
v=v.move("character",-16777215)*-1-t;r=t-r;t=v}v=o.dom.create(o.settings.forced_root_block);z.parentNode.replaceChild(v,z);v.appendChild(z)}}else v=null}if(r!=-2)if(!b||s.setStart){v=p.getElementsByTagName(o.settings.element)[0];s=m.createRange();r!=-1?s.setStart(this.find(p,1,r),y):s.setStart(v,0);t!=-1?s.setEnd(this.find(p,1,t),u):s.setEnd(v,0);if(q){q.removeAllRanges();q.addRange(s)}}else try{s=q.createRange();s.moveToElementText(p);s.collapse(1);s.moveStart("character",r);s.moveEnd("character",
t);s.select()}catch(L){}else if((!b||s.setStart)&&(F=o.dom.get("__mce"))){K?F.setAttribute("id",K):F.removeAttribute("id");s=m.createRange();s.setStartBefore(F);s.setEndBefore(F);n.setRng(s)}},getParentBlock:function(o){var p=this.dom;return p.getParent(o,p.isBlock)},insertPara:function(){function o(ja,Z){var ba=[],ca;ja.innerHTML="";if(s.keep_styles){ca=Z;do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(ca.nodeName)){Z=ca.cloneNode(l);n.setAttrib(Z,"id","");ba.push(Z)}while(ca=ca.parentNode)}if(ba.length>
0){ca=ba.length-1;for(Z=ja;ca>=0;ca--)Z=Z.appendChild(ba[ca]);ba[0].innerHTML=h?"\u00a0":"<br />";return ba[0]}else ja.innerHTML=h?"\u00a0":"<br />"}function p(ja){return q.createTreeWalker(ja,NodeFilter.SHOW_TEXT,null,l).nextNode()||ja}var m=this.editor,n=m.dom,q=m.getDoc(),s=m.settings,r=m.selection.getSel(),t=r.getRangeAt(0),y=q.body,u,v,z,A,C,F,K,L,M,W,X,D,N=n.getViewPort(m.getWin()),H;m.undoManager.beforeChange();u=q.createRange();u.setStart(r.anchorNode,r.anchorOffset);u.collapse(g);v=q.createRange();
v.setStart(r.focusNode,r.focusOffset);v.collapse(g);A=(z=u.compareBoundaryPoints(u.START_TO_END,v)<0)?r.anchorNode:r.focusNode;C=z?r.anchorOffset:r.focusOffset;F=z?r.focusNode:r.anchorNode;z=z?r.focusOffset:r.anchorOffset;if(A===F&&/^(TD|TH)$/.test(A.nodeName)){A.firstChild.nodeName=="BR"&&n.remove(A.firstChild);if(A.childNodes.length==0)m.dom.add(A,s.element,null,"<br />");else{D=A.innerHTML;A.innerHTML="";m.dom.add(A,s.element,null,D)}L=m.dom.add(A,s.element,null,"<br />");t=q.createRange();t.selectNodeContents(L);
t.collapse(1);m.selection.setRng(t);return l}if(A==y&&F==y&&y.firstChild&&m.dom.isBlock(y.firstChild)){A=F=A.firstChild;C=z=0;u=q.createRange();u.setStart(A,0);v=q.createRange();v.setStart(F,0)}A=A.nodeName=="HTML"?q.body:A;A=A.nodeName=="BODY"?A.firstChild:A;F=F.nodeName=="HTML"?q.body:F;F=F.nodeName=="BODY"?F.firstChild:F;K=this.getParentBlock(A);L=this.getParentBlock(F);M=K?K.nodeName:s.element;if(D=this.dom.getParent(K,"li,pre")){if(D.nodeName=="LI")return c(m.selection,this.dom,D);return g}if(K&&
(K.nodeName=="CAPTION"||/absolute|relative|fixed/gi.test(n.getStyle(K,"position",1)))){M=s.element;K=null}if(L&&(L.nodeName=="CAPTION"||/absolute|relative|fixed/gi.test(n.getStyle(K,"position",1)))){M=s.element;L=null}if(/(TD|TABLE|TH|CAPTION)/.test(M)||K&&M=="DIV"&&/left|right/gi.test(n.getStyle(K,"float",1))){M=s.element;K=L=null}W=K&&K.nodeName==M?K.cloneNode(0):m.dom.create(M);L=L&&L.nodeName==M?L.cloneNode(0):m.dom.create(M);L.removeAttribute("id");if(/^(H[1-6])$/.test(M)&&a(t,K))L=m.dom.create(s.element);
D=K=A;do{if(D==y||D.nodeType==9||this.dom.isBlock(D)||/(TD|TABLE|TH|CAPTION)/.test(D.nodeName))break;K=D}while(D=D.previousSibling?D.previousSibling:D.parentNode);D=X=F;do{if(D==y||D.nodeType==9||this.dom.isBlock(D)||/(TD|TABLE|TH|CAPTION)/.test(D.nodeName))break;X=D}while(D=D.nextSibling?D.nextSibling:D.parentNode);K.nodeName==M?u.setStart(K,0):u.setStartBefore(K);u.setEnd(A,C);W.appendChild(u.cloneContents()||q.createTextNode(""));try{v.setEndAfter(X)}catch(ha){}v.setStart(F,z);L.appendChild(v.cloneContents()||
q.createTextNode(""));t=q.createRange();if(!K.previousSibling&&K.parentNode.nodeName==M)t.setStartBefore(K.parentNode);else u.startContainer.nodeName==M&&u.startOffset==0?t.setStartBefore(u.startContainer):t.setStart(u.startContainer,u.startOffset);!X.nextSibling&&X.parentNode.nodeName==M?t.setEndAfter(X.parentNode):t.setEnd(v.endContainer,v.endOffset);t.deleteContents();h&&m.getWin().scrollTo(0,N.y);if(W.firstChild&&W.firstChild.nodeName==M)W.innerHTML=W.firstChild.innerHTML;if(L.firstChild&&L.firstChild.nodeName==
M)L.innerHTML=L.firstChild.innerHTML;if(n.isEmpty(W))W.innerHTML="<br />";if(n.isEmpty(L))H=o(L,F);if(h&&parseFloat(opera.version())<9.5){t.insertNode(W);t.insertNode(L)}else{t.insertNode(L);t.insertNode(W)}L.normalize();W.normalize();t=q.createRange();t.selectNodeContents(f?p(H||L):H||L);t.collapse(1);r.removeAllRanges();r.addRange(t);r=m.dom.getPos(L).y;if(r<N.y||r+25>N.y+N.h)m.getWin().scrollTo(0,r<N.y?r:r-N.h+25);m.undoManager.add();return l},backspaceDelete:function(o,p){var m=this.editor,n=
m.getBody(),q,s=m.selection,r=s.getRng(),t=r.startContainer,y;if(!p&&r.collapsed&&t.nodeType==1&&r.startOffset==t.childNodes.length){y=new k.dom.TreeWalker(t.lastChild,t);for(q=t.lastChild;q;q=y.prev())if(q.nodeType==3){r.setStart(q,q.nodeValue.length);r.collapse(true);s.setRng(r);return}}if(t&&m.dom.isBlock(t)&&!/^(TD|TH)$/.test(t.nodeName)&&p)if(t.childNodes.length==0||t.childNodes.length==1&&t.firstChild.nodeName=="BR"){for(q=t;(q=q.previousSibling)&&!m.dom.isBlock(q););if(q){if(t!=n.firstChild){for(p=
m.dom.doc.createTreeWalker(q,NodeFilter.SHOW_TEXT,null,l);n=p.nextNode();)q=n;r=m.getDoc().createRange();r.setStart(q,q.nodeValue?q.nodeValue.length:0);r.setEnd(q,q.nodeValue?q.nodeValue.length:0);m.dom.remove(t);s.setRng(r)}return e.cancel(o)}}}})})(tinymce);
(function(k){var d=k.dom.Event,a=k.each,c=k.extend;k.create("tinymce.ControlManager",{ControlManager:function(e,b){var f=this;b=b||{};f.editor=e;f.controls={};f.onAdd=new k.util.Dispatcher(f);f.onPostRender=new k.util.Dispatcher(f);f.prefix=b.prefix||e.id+"_";f._cls={};f.onPostRender.add(function(){a(f.controls,function(h){h.postRender()})})},get:function(e){return this.controls[this.prefix+e]||this.controls[e]},setActive:function(e,b){var f=null;if(f=this.get(e))f.setActive(b);return f},setDisabled:function(e,
b){var f=null;if(f=this.get(e))f.setDisabled(b);return f},add:function(e){if(e){this.controls[e.id]=e;this.onAdd.dispatch(e,this)}return e},createControl:function(e){var b,f=this,h=f.editor;a(h.plugins,function(g){if(g.createControl)if(b=g.createControl(e,f))return false});switch(e){case "|":case "separator":return f.createSeparator()}if(!b&&h.buttons&&(b=h.buttons[e]))return f.createButton(e,b);return f.add(b)},createDropMenu:function(e,b,f){var h=this.editor,g,l,o;b=c({"class":"mceDropDown",constrain:h.settings.constrain_menus},
b);b["class"]=b["class"]+" "+h.getParam("skin")+"Skin";if(o=h.getParam("skin_variant"))b["class"]+=" "+h.getParam("skin")+"Skin"+o.substring(0,1).toUpperCase()+o.substring(1);e=this.prefix+e;g=this.controls[e]=new (f||this._cls.dropmenu||k.ui.DropMenu)(e,b);g.onAddItem.add(function(p,m){var n=m.settings;n.title=h.getLang(n.title,n.title);if(!n.onclick)n.onclick=function(){if(n.cmd)h.execCommand(n.cmd,n.ui||false,n.value)}});h.onRemove.add(function(){g.destroy()});if(k.isIE){g.onShowMenu.add(function(){h.focus();
l=h.selection.getBookmark(1)});g.onHideMenu.add(function(){if(l){h.selection.moveToBookmark(l);l=0}})}return this.add(g)},createListBox:function(e,b,f){var h=this.editor;if(this.get(e))return null;b.title=h.translate(b.title);b.scope=b.scope||h;if(!b.onselect)b.onselect=function(g){h.execCommand(b.cmd,b.ui||false,g||b.value)};b=c({title:b.title,"class":"mce_"+e,scope:b.scope,control_manager:this},b);e=this.prefix+e;if(h.settings.use_native_selects)f=new k.ui.NativeListBox(e,b);else{f=f||this._cls.listbox||
k.ui.ListBox;f=new f(e,b,h)}this.controls[e]=f;k.isWebKit&&f.onPostRender.add(function(g,l){d.add(l,"mousedown",function(){h.bookmark=h.selection.getBookmark(1)});d.add(l,"focus",function(){h.selection.moveToBookmark(h.bookmark);h.bookmark=null})});f.hideMenu&&h.onMouseDown.add(f.hideMenu,f);return this.add(f)},createButton:function(e,b,f){var h=this.editor;if(this.get(e))return null;b.title=h.translate(b.title);b.label=h.translate(b.label);b.scope=b.scope||h;if(!b.onclick&&!b.menu_button)b.onclick=
function(){h.execCommand(b.cmd,b.ui||false,b.value)};b=c({title:b.title,"class":"mce_"+e,unavailable_prefix:h.getLang("unavailable",""),scope:b.scope,control_manager:this},b);e=this.prefix+e;if(b.menu_button){f=f||this._cls.menubutton||k.ui.MenuButton;e=new f(e,b,h);h.onMouseDown.add(e.hideMenu,e)}else{f=this._cls.button||k.ui.Button;e=new f(e,b)}return this.add(e)},createMenuButton:function(e,b,f){b=b||{};b.menu_button=1;return this.createButton(e,b,f)},createSplitButton:function(e,b,f){var h=this.editor;
if(this.get(e))return null;b.title=h.translate(b.title);b.scope=b.scope||h;if(!b.onclick)b.onclick=function(g){h.execCommand(b.cmd,b.ui||false,g||b.value)};if(!b.onselect)b.onselect=function(g){h.execCommand(b.cmd,b.ui||false,g||b.value)};b=c({title:b.title,"class":"mce_"+e,scope:b.scope,control_manager:this},b);e=this.prefix+e;e=this.add(new (f||this._cls.splitbutton||k.ui.SplitButton)(e,b,h));h.onMouseDown.add(e.hideMenu,e);return e},createColorSplitButton:function(e,b,f){var h=this.editor,g,l;
if(this.get(e))return null;b.title=h.translate(b.title);b.scope=b.scope||h;if(!b.onclick)b.onclick=function(o){if(k.isIE)l=h.selection.getBookmark(1);h.execCommand(b.cmd,b.ui||false,o||b.value)};if(!b.onselect)b.onselect=function(o){h.execCommand(b.cmd,b.ui||false,o||b.value)};b=c({title:b.title,"class":"mce_"+e,menu_class:h.getParam("skin")+"Skin",scope:b.scope,more_colors_title:h.getLang("more_colors")},b);e=this.prefix+e;g=new (f||this._cls.colorsplitbutton||k.ui.ColorSplitButton)(e,b,h);h.onMouseDown.add(g.hideMenu,
g);h.onRemove.add(function(){g.destroy()});if(k.isIE){g.onShowMenu.add(function(){h.focus();l=h.selection.getBookmark(1)});g.onHideMenu.add(function(){if(l){h.selection.moveToBookmark(l);l=0}})}return this.add(g)},createToolbar:function(e,b,f){e=this.prefix+e;b=new (f||this._cls.toolbar||k.ui.Toolbar)(e,b,this.editor);if(this.get(e))return null;return this.add(b)},createToolbarGroup:function(e,b,f){e=this.prefix+e;b=new (f||this._cls.toolbarGroup||k.ui.ToolbarGroup)(e,b,this.editor);if(this.get(e))return null;
return this.add(b)},createSeparator:function(e){return new (e||this._cls.separator||k.ui.Separator)},setControlType:function(e,b){return this._cls[e.toLowerCase()]=b},destroy:function(){a(this.controls,function(e){e.destroy()});this.controls=null}})})(tinymce);
(function(k){var d=k.util.Dispatcher,a=k.each,c=k.isIE,e=k.isOpera;k.create("tinymce.WindowManager",{WindowManager:function(b){this.editor=b;this.onOpen=new d(this);this.onClose=new d(this);this.params={};this.features={}},open:function(b,f){var h="",g=this.editor.settings.dialog_type=="modal",l,o,p;p=k.DOM.getViewPort();b=b||{};f=f||{};o=e?p.w:screen.width;p=e?p.h:screen.height;b.name=b.name||"mc_"+(new Date).getTime();b.width=parseInt(b.width||320);b.height=parseInt(b.height||240);b.resizable=true;
b.left=b.left||parseInt(o/2)-b.width/2;b.top=b.top||parseInt(p/2)-b.height/2;f.inline=false;f.mce_width=b.width;f.mce_height=b.height;f.mce_auto_focus=b.auto_focus;if(g)if(c){b.center=true;b.help=false;b.dialogWidth=b.width+"px";b.dialogHeight=b.height+"px";b.scroll=b.scrollbars||false}a(b,function(n,q){if(k.is(n,"boolean"))n=n?"yes":"no";/^(name|url)$/.test(q)||(h+=c&&g?(h?";":"")+q+":"+n:(h?",":"")+q+"="+n)});this.features=b;this.params=f;this.onOpen.dispatch(this,b,f);f=b.url||b.file;f=k._addVer(f);
try{if(c&&g){l=1;window.showModalDialog(f,window,h)}else l=window.open(f,b.name,h)}catch(m){}l||alert(this.editor.getLang("popup_blocked"))},close:function(b){b.close();this.onClose.dispatch(this)},createInstance:function(b,f,h,g,l,o){return new (k.resolve(b))(f,h,g,l,o)},confirm:function(b,f,h,g){g=g||window;f.call(h||this,g.confirm(this._decode(this.editor.getLang(b,b))))},alert:function(b,f,h,g){g=g||window;g.alert(this._decode(this.editor.getLang(b,b)));if(f)f.call(h||this)},resizeBy:function(b,
f,h){h.resizeBy(b,f)},_decode:function(b){return k.DOM.decode(b).replace(/\\n/g,"\n")}})})(tinymce);
(function(k){k.Formatter=function(d){function a(x,B){return D.getParents(x,B,D.getRoot())}function c(x){return x.nodeType===1&&(x.face==="mceinline"||x.style.fontFamily==="mceinline")}function e(x){return x?W[x]:W}function b(x,B){if(x)if(typeof x!=="string")X(x,function(E,G){b(G,E)});else{B=B.length?B:[B];X(B,function(E){if(E.deep===oa)E.deep=!E.selector;if(E.split===oa)E.split=!E.selector||E.inline;if(E.remove===oa&&E.selector&&!E.inline)E.remove="none";if(E.selector&&E.inline){E.mixed=true;E.block_expand=
true}if(typeof E.classes==="string")E.classes=E.classes.split(/\s+/)});W[x]=B}}function f(x,B,E){function G(P){var T=P.startContainer,S=P.startOffset;if(T.nodeType==1||T.nodeValue==="")if(T=T.nodeType==1?T.childNodes[S]:T){T=new H(T,T.parentNode);for(S=T.current();S;S=T.next())if(S.nodeType==3&&!t(S)){P.setStart(S,0);break}}return P}function J(P,T){T=T||V;if(P){X(T.styles,function(S,aa){D.setStyle(P,aa,r(S,B))});X(T.attributes,function(S,aa){D.setAttrib(P,aa,r(S,B))});X(T.classes,function(S){S=r(S,
B);D.hasClass(P,S)||D.addClass(P,S)})}}function R(P){var T=[],S,aa;S=V.inline||V.block;aa=D.create(S);J(aa);ha.walk(P,function(Q){function $(ea){var ia=ea.nodeName.toLowerCase(),na=ea.parentNode.nodeName.toLowerCase(),pa;if(q(ia,"br")){ga=0;V.block&&D.remove(ea)}else if(V.wrapper&&l(ea,x,B))ga=0;else if(V.block&&!V.wrapper&&K(ia)){ea=D.rename(ea,S);J(ea);T.push(ea);ga=0}else{if(V.selector){X(O,function(qa){if(!("collapsed"in qa&&qa.collapsed!==U))if(D.is(ea,qa.selector)&&!c(ea)){J(ea,qa);pa=true}});
if(!V.inline||pa){ga=0;return}}if(ja(S,ia)&&ja(na,S)&&!(ea.nodeType===3&&ea.nodeValue.length===1&&ea.nodeValue.charCodeAt(0)===65279)){if(!ga){ga=aa.cloneNode(da);ea.parentNode.insertBefore(ga,ea);T.push(ga)}ga.appendChild(ea)}else{ga=0;X(k.grep(ea.childNodes),$);ga=0}}}var ga;X(Q,$)});V.wrap_links===false&&X(T,function(Q){function $(ga){var ea,ia,na;if(ga.nodeName==="A"){ia=aa.cloneNode(da);T.push(ia);na=k.grep(ga.childNodes);for(ea=0;ea<na.length;ea++)ia.appendChild(na[ea]);ga.appendChild(ia)}X(k.grep(ga.childNodes),
$)}$(Q)});X(T,function(Q){function $(ia){var na=0;X(ia.childNodes,function(pa){!t(pa)&&!C(pa)&&na++});return na}function ga(ia){var na,pa;X(ia.childNodes,function(qa){if(qa.nodeType==1&&!C(qa)&&!c(qa)){na=qa;return da}});if(na&&n(na,V)){pa=na.cloneNode(da);J(pa);D.replace(pa,ia,fa);D.remove(na,1)}return pa||ia}var ea;ea=$(Q);if((T.length>1||!Z(Q))&&ea===0)D.remove(Q,1);else if(V.inline||V.wrapper){if(!V.exact&&ea===1)Q=ga(Q);X(O,function(ia){X(D.select(ia.inline,Q),function(na){var pa;if(ia.wrap_links===
false){pa=na.parentNode;do if(pa.nodeName==="A")return;while(pa=pa.parentNode)}v(ia,B,na,ia.exact?na:null)})});if(l(Q.parentNode,x,B)){D.remove(Q,1);Q=0;return fa}V.merge_with_parents&&D.getParent(Q.parentNode,function(ia){if(l(ia,x,B)){D.remove(Q,1);Q=0;return fa}});if(Q){Q=F(A(Q),Q);Q=F(Q,A(Q,fa))}}})}var O=e(x),V=O[0],Y,U=N.isCollapsed();if(V)if(E){Y=D.createRng();Y.setStartBefore(E);Y.setEndAfter(E);R(u(Y,O))}else if(!U||!V.inline||D.select("td.mceSelected,th.mceSelected").length){Y=d.selection.getNode();
E=N.getBookmark();R(u(N.getRng(fa),O));if(V.styles&&(V.styles.color||V.styles.textDecoration)){k.walk(Y,I,"childNodes");I(Y)}N.moveToBookmark(E);N.setRng(G(N.getRng(fa)));d.nodeChanged()}else M("apply",x,B)}function h(x,B,E){function G(aa){var Q=aa.startContainer,$=aa.startOffset,ga;if(Q.nodeType==3&&$>=Q.nodeValue.length-1){Q=Q.parentNode;$=ca(Q)+1}if(Q.nodeType==1){ga=Q.childNodes;Q=ga[Math.min($,ga.length-1)];Q=new H(Q);$>ga.length-1&&Q.next();for($=Q.current();$;$=Q.next())if($.nodeType==3&&!t($)){Q=
D.create("a",null,ka);$.parentNode.insertBefore(Q,$);aa.setStart($,0);N.setRng(aa);D.remove(Q);return}}}function J(aa){var Q,$,ga;Q=k.grep(aa.childNodes);$=0;for(ga=P.length;$<ga;$++)if(v(P[$],B,aa,aa))break;if(T.deep){$=0;for(ga=Q.length;$<ga;$++)J(Q[$])}}function R(aa){var Q;X(a(aa.parentNode).reverse(),function($){var ga;if(!Q&&$.id!="_start"&&$.id!="_end")if((ga=l($,x,B))&&ga.split!==false)Q=$});return Q}function O(aa,Q,$,ga){var ea,ia,na,pa,qa,sa;if(aa){sa=aa.parentNode;for(ea=Q.parentNode;ea&&
ea!=sa;ea=ea.parentNode){ia=ea.cloneNode(da);for(qa=0;qa<P.length;qa++)if(v(P[qa],B,ia,ia)){ia=0;break}if(ia){na&&ia.appendChild(na);pa||(pa=ia);na=ia}}if(ga&&(!T.mixed||!Z(aa)))Q=D.split(aa,Q);if(na){$.parentNode.insertBefore(na,$);pa.appendChild($)}}return Q}function V(aa){return O(R(aa),aa,aa,true)}function Y(aa){var Q=D.get(aa?"_start":"_end"),$=Q[aa?"firstChild":"lastChild"];if(C($))$=$[aa?"firstChild":"lastChild"];D.remove(Q,true);return $}function U(aa){var Q,$;aa=u(aa,P,fa);if(T.split){Q=
L(aa,fa);$=L(aa);if(Q!=$){Q=y(Q,"span",{id:"_start","data-mce-type":"bookmark"});$=y($,"span",{id:"_end","data-mce-type":"bookmark"});V(Q);V($);Q=Y(fa);$=Y()}else Q=$=V(Q);aa.startContainer=Q.parentNode;aa.startOffset=ca(Q);aa.endContainer=$.parentNode;aa.endOffset=ca($)+1}ha.walk(aa,function(ga){X(ga,function(ea){J(ea);ea.nodeType===1&&d.dom.getStyle(ea,"text-decoration")==="underline"&&ea.parentNode&&ra(ea.parentNode)==="underline"&&v({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},
null,ea)})})}var P=e(x),T=P[0],S;if(E){S=D.createRng();S.setStartBefore(E);S.setEndAfter(E);U(S)}else if(!N.isCollapsed()||!T.inline||D.select("td.mceSelected,th.mceSelected").length){E=N.getBookmark();U(N.getRng(fa));N.moveToBookmark(E);o(x,B,N.getStart())&&G(N.getRng(true));d.nodeChanged()}else M("remove",x,B)}function g(x,B,E){var G=e(x);o(x,B,E)&&(!("toggle"in G[0])||G[0].toggle)?h(x,B,E):f(x,B,E)}function l(x,B,E,G){function J(V,Y,U){var P,T,S=Y[U];if(S)if(S.length===oa)for(P in S){if(S.hasOwnProperty(P)){T=
U==="attributes"?D.getAttrib(V,P):s(V,P);if(G&&!T&&!Y.exact)return;if((!G||Y.exact)&&!q(T,r(S[P],E)))return}}else for(P=0;P<S.length;P++)if(U==="attributes"?D.getAttrib(V,S[P]):s(V,S[P]))return Y;return Y}var R=e(B),O;if(R&&x)for(O=0;O<R.length;O++){B=R[O];if(n(x,B)&&J(x,B,"attributes")&&J(x,B,"styles")){if(R=B.classes)for(O=0;O<R.length;O++)if(!D.hasClass(x,R[O]))return;return B}}}function o(x,B,E){function G(R){R=D.getParent(R,function(O){return!!l(O,x,B,true)});return l(R,x,B)}var J;if(E)return G(E);
if(N.isCollapsed()){for(E=la.apply.length-1;E>=0;E--)if(la.apply[E].name==x)return true;for(E=la.remove.length-1;E>=0;E--)if(la.remove[E].name==x)return false;return G(N.getNode())}E=N.getNode();if(G(E))return fa;J=N.getStart();if(J!=E)if(G(J))return fa;return da}function p(x,B){var E,G=[],J={},R,O;if(N.isCollapsed()){for(R=0;R<x.length;R++)for(E=la.remove.length-1;E>=0;E--){O=x[R];if(la.remove[E].name==O){J[O]=true;break}}for(E=la.apply.length-1;E>=0;E--)for(R=0;R<x.length;R++){O=x[R];if(!J[O]&&
la.apply[E].name==O){J[O]=true;G.push(O)}}}E=N.getStart();D.getParent(E,function(V){var Y,U;for(Y=0;Y<x.length;Y++){U=x[Y];if(!J[U]&&l(V,U,B)){J[U]=true;G.push(U)}}});return G}function m(x){x=e(x);var B,E,G,J;if(x){B=N.getStart();B=a(B);for(G=x.length-1;G>=0;G--){J=x[G].selector;if(!J)return fa;for(E=B.length-1;E>=0;E--)if(D.is(B[E],J))return fa}}return da}function n(x,B){if(q(x,B.inline))return fa;if(q(x,B.block))return fa;if(B.selector)return D.is(x,B.selector)}function q(x,B){x=x||"";B=B||"";x=
""+(x.nodeName||x);B=""+(B.nodeName||B);return x.toLowerCase()==B.toLowerCase()}function s(x,B){x=D.getStyle(x,B);if(B=="color"||B=="backgroundColor")x=D.toHex(x);if(B=="fontWeight"&&x==700)x="bold";return""+x}function r(x,B){if(typeof x!="string")x=x(B);else if(B)x=x.replace(/%(\w+)/g,function(E,G){return B[G]||E});return x}function t(x){return x&&x.nodeType===3&&/^([\s\r\n]+|)$/.test(x.nodeValue)}function y(x,B,E){B=D.create(B,E);x.parentNode.insertBefore(B,x);B.appendChild(x);return B}function u(x,
B){function E(P,T,S,aa){var Q;for(aa=aa||D.getRoot();;){Q=P.parentNode;if(Q==aa||!B[0].block_expand&&Z(Q))return P;for(Y=Q[T];Y&&Y!=P;Y=Y[S]){if(Y.nodeType==1&&!C(Y))return P;if(Y.nodeType==3&&!t(Y))return P}P=P.parentNode}return P}function G(P,T){if(T===oa)T=P.nodeType===3?P.length:P.childNodes.length;for(;P&&P.hasChildNodes();)if(P=P.childNodes[T])T=P.nodeType===3?P.length:P.childNodes.length;return{node:P,offset:T}}var J=x.startContainer,R=x.startOffset,O=x.endContainer,V=x.endOffset,Y,U;if(J.nodeType==
1&&J.hasChildNodes()){U=J.childNodes.length-1;J=J.childNodes[R>U?U:R];if(J.nodeType==3)R=0}if(O.nodeType==1&&O.hasChildNodes()){U=O.childNodes.length-1;O=O.childNodes[V>U?U:V-1];if(O.nodeType==3)V=O.nodeValue.length}if(C(J.parentNode))J=J.parentNode;if(C(J))J=J.nextSibling||J;if(C(O.parentNode)){V=D.nodeIndex(O);O=O.parentNode}if(C(O)&&O.previousSibling){O=O.previousSibling;V=O.length}if(B[0].inline){U=G(O,V);if(U.node){for(;U.node&&U.offset===0&&U.node.previousSibling;)U=G(U.node.previousSibling);
if(U.node&&U.offset>0&&U.node.nodeType===3&&U.node.nodeValue.charAt(U.offset-1)===" ")if(U.offset>1){O=U.node;O.splitText(U.offset-1)}else if(U.node.previousSibling)O=U.node.previousSibling}}if(B[0].inline||B[0].block_expand){J=E(J,"firstChild","nextSibling");O=E(O,"lastChild","previousSibling")}if(B[0].selector&&B[0].expand!==da&&!B[0].inline){U=function(P,T){var S,aa,Q;if(P.nodeType==3&&P.nodeValue.length==0&&P[T])P=P[T];T=a(P);for(S=0;S<T.length;S++)for(aa=0;aa<B.length;aa++){Q=B[aa];if(!("collapsed"in
Q&&Q.collapsed!==x.collapsed))if(D.is(T[S],Q.selector))return T[S]}return P};J=U(J,"previousSibling");O=U(O,"nextSibling")}if(B[0].block||B[0].selector){U=function(P,T){var S;B[0].wrapper||(S=D.getParent(P,B[0].block));S||(S=D.getParent(P.nodeType==3?P.parentNode:P,Z));if(S&&B[0].wrapper)S=a(S,"ul,ol").reverse()[0]||S;if(!S)for(S=P;S[T]&&!Z(S[T]);){S=S[T];if(q(S,"br"))break}return S||P};J=U(J,"previousSibling");O=U(O,"nextSibling");if(B[0].block){Z(J)||(J=E(J,"firstChild","nextSibling"));Z(O)||(O=
E(O,"lastChild","previousSibling"))}}if(J.nodeType==1){R=ca(J);J=J.parentNode}if(O.nodeType==1){V=ca(O)+1;O=O.parentNode}return{startContainer:J,startOffset:R,endContainer:O,endOffset:V}}function v(x,B,E,G){var J,R,O;if(!n(E,x))return da;if(x.remove!="all"){X(x.styles,function(V,Y){V=r(V,B);if(typeof Y==="number"){Y=V;G=0}if(!G||q(s(G,Y),V))D.setStyle(E,Y,"");O=1});if(O&&D.getAttrib(E,"style")==""){E.removeAttribute("style");E.removeAttribute("data-mce-style")}X(x.attributes,function(V,Y){var U;V=
r(V,B);if(typeof Y==="number"){Y=V;G=0}if(!G||q(D.getAttrib(G,Y),V)){if(Y=="class")if(V=D.getAttrib(E,Y)){U="";X(V.split(/\s+/),function(P){if(/mce\w+/.test(P))U+=(U?" ":"")+P});if(U){D.setAttrib(E,Y,U);return}}Y=="class"&&E.removeAttribute("className");ma.test(Y)&&E.removeAttribute("data-mce-"+Y);E.removeAttribute(Y)}});X(x.classes,function(V){V=r(V,B);if(!G||D.hasClass(G,V))D.removeClass(E,V)});R=D.getAttribs(E);for(J=0;J<R.length;J++)if(R[J].nodeName.indexOf("_")!==0)return da}if(x.remove!="none"){z(E,
x);return fa}}function z(x,B){var E=x.parentNode,G;if(B.block)if(ba){if(E==D.getRoot())if(!B.list_block||!q(x,B.list_block))X(k.grep(x.childNodes),function(R){if(ja(ba,R.nodeName.toLowerCase()))if(G)G.appendChild(R);else G=y(R,ba);else G=0})}else{var J=function(R,O,V){R=A(R,O,V);return!R||R.nodeName=="BR"||Z(R)};if(Z(x)&&!Z(E)){!J(x,da)&&!J(x.firstChild,fa,1)&&x.insertBefore(D.create("br"),x.firstChild);!J(x,fa)&&!J(x.lastChild,da,1)&&x.appendChild(D.create("br"))}}B.selector&&B.inline&&!q(B.inline,
x)||D.remove(x,1)}function A(x,B,E){if(x){B=B?"nextSibling":"previousSibling";for(x=E?x:x[B];x;x=x[B])if(x.nodeType==1||!t(x))return x}}function C(x){return x&&x.nodeType==1&&x.getAttribute("data-mce-type")=="bookmark"}function F(x,B){function E(R,O){function V(U){var P={};X(D.getAttribs(U),function(T){T=T.nodeName.toLowerCase();if(T.indexOf("_")!==0&&T!=="style")P[T]=D.getAttrib(U,T)});return P}function Y(U,P){var T,S;for(S in U)if(U.hasOwnProperty(S)){T=P[S];if(T===oa)return da;if(U[S]!=T)return da;
delete P[S]}for(S in P)if(P.hasOwnProperty(S))return da;return fa}if(R.nodeName!=O.nodeName)return da;if(!Y(V(R),V(O)))return da;if(!Y(D.parseStyle(D.getAttrib(R,"style")),D.parseStyle(D.getAttrib(O,"style"))))return da;return fa}var G,J;if(x&&B){J=function(R,O){for(G=R;G;G=G[O]){if(G.nodeType==3&&G.nodeValue.length!==0)return R;if(G.nodeType==1&&!C(G))return G}return R};x=J(x,"previousSibling");B=J(B,"nextSibling");if(E(x,B)){for(G=x.nextSibling;G&&G!=B;){J=G;G=G.nextSibling;x.appendChild(J)}D.remove(B);
X(k.grep(B.childNodes),function(R){x.appendChild(R)});return x}}return B}function K(x){return/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(x)}function L(x,B){var E,G;E=x[B?"startContainer":"endContainer"];x=x[B?"startOffset":"endOffset"];if(E.nodeType==1){G=E.childNodes.length-1;!B&&x&&x--;E=E.childNodes[x>G?G:x]}return E}function M(x,B,E){function G(){return la.apply.length||la.remove.length}function J(){la.apply=[];la.remove=[]}function R(Y){X(la.apply.reverse(),function(U){f(U.name,U.vars,Y);U.name===
"forecolor"&&U.vars.value&&I(Y.parentNode)});X(la.remove.reverse(),function(U){h(U.name,U.vars,Y)});D.remove(Y,1);J()}var O=la[x],V=la[x=="apply"?"remove":"apply"];for(x=O.length-1;x>=0;x--)if(O[x].name==B)return;O.push({name:B,vars:E});for(x=V.length-1;x>=0;x--)V[x].name==B&&V.splice(x,1);if(G()){d.getDoc().execCommand("FontName",false,"mceinline");la.lastRng=N.getRng();X(D.select("font,span"),function(Y){var U;if(c(Y)){U=N.getBookmark();R(Y);N.moveToBookmark(U);d.nodeChanged()}});if(!la.isListening&&
G()){la.isListening=true;X("onKeyDown,onKeyUp,onKeyPress,onMouseUp".split(","),function(Y){d[Y].addToTop(function(U,P){if(G()&&!k.dom.RangeUtils.compareRanges(la.lastRng,N.getRng())){X(D.select("font,span"),function(T){var S;if(c(T))if(S=T.firstChild){R(T);T=D.createRng();T.setStart(S,S.nodeValue.length);T.setEnd(S,S.nodeValue.length);N.setRng(T);U.nodeChanged()}else D.remove(T)});if(P.type=="keyup"||P.type=="mouseup")J()}})})}}}var W={},X=k.each,D=d.dom,N=d.selection,H=k.dom.TreeWalker,ha=new k.dom.RangeUtils(D),
ja=d.schema.isValidChild,Z=D.isBlock,ba=d.settings.forced_root_block,ca=D.nodeIndex,ka="\ufeff",ma=/^(src|href|style)$/,da=false,fa=true,oa,la={apply:[],remove:[]},ra=function(x){var B;d.dom.getParent(x,function(E){return(B=d.dom.getStyle(E,"text-decoration"))&&B!=="none"});return B},I=function(x){var B;if(x.nodeType===1&&x.parentNode&&x.parentNode.nodeType===1){B=ra(x.parentNode);if(d.dom.getStyle(x,"color")&&B)d.dom.setStyle(x,"text-decoration",B);else d.dom.getStyle(x,"textdecoration")===B&&d.dom.setStyle(x,
"text-decoration",null)}};k.extend(this,{get:e,register:b,apply:f,remove:h,toggle:g,match:o,matchAll:p,matchNode:l,canApply:m})}})(tinymce);
tinymce.onAddEditor.add(function(k,d){var a,c,e,b=d.settings;if(b.inline_styles){c=k.explode(b.font_size_style_values);var f=function(g,l){k.each(l,function(o,p){o&&e.setStyle(g,p,o)});e.rename(g,"span")};a={font:function(g,l){f(l,{backgroundColor:l.style.backgroundColor,color:l.color,fontFamily:l.face,fontSize:c[parseInt(l.size)-1]})},u:function(g,l){f(l,{textDecoration:"underline"})},strike:function(g,l){f(l,{textDecoration:"line-through"})}};var h=function(g,l){e=g.dom;b.convert_fonts_to_spans&&
k.each(e.select("font,u,strike",l.node),function(o){a[o.nodeName.toLowerCase()](d.dom,o)})};d.onPreProcess.add(h);d.onSetContent.add(h);d.onInit.add(function(){d.selection.onSetContent.add(h)})}});
(function(){function k(c,e){return c.getParam(e,a[e])}var d=tinymce.each,a={paste_auto_cleanup_on_paste:true,paste_enable_default_filters:true,paste_block_drop:false,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:false,paste_remove_styles:false,paste_remove_styles_if_webkit:true,paste_convert_middot_lists:true,paste_convert_headers_to_strong:false,paste_dialog_width:"450",paste_dialog_height:"400",paste_text_use_dialog:false,paste_text_sticky:false,paste_text_sticky_default:false,
paste_text_notifyalways:false,paste_text_linebreaktype:"p",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.PastePlugin",{init:function(c,e){function b(g,l){var o=c.dom,p;h.onPreProcess.dispatch(h,g);g.node=o.create("div",0,g.content);if(tinymce.isGecko){p=c.selection.getRng(true);if(p.startContainer==p.endContainer&&p.startContainer.nodeType==3){p=o.select("p,h1,h2,h3,h4,h5,h6,pre",g.node);p.length==1&&
g.content.indexOf("__MCE_ITEM__")===-1&&o.remove(p.reverse(),true)}}h.onPostProcess.dispatch(h,g);g.content=c.serializer.serialize(g.node,{getInner:1});if(!l&&c.pasteAsPlainText){h._insertPlainText(c,o,g.content);if(!k(c,"paste_text_sticky")){c.pasteAsPlainText=false;c.controlManager.setActive("pastetext",false)}}else h._insert(g.content)}function f(g){var l,o,p,m,n=c.selection,q=c.dom;p=c.getBody();var s;if(g.clipboardData||q.doc.dataTransfer){s=(g.clipboardData||q.doc.dataTransfer).getData("Text");
if(c.pasteAsPlainText){g.preventDefault();b({content:s.replace(/\r?\n/g,"<br />")});return}}if(!q.get("_mcePaste")){l=q.add(p,"div",{id:"_mcePaste","class":"mcePaste","data-mce-bogus":"1"},"\ufeff\ufeff");p=p!=c.getDoc().body?q.getPos(c.selection.getStart(),p).y:p.scrollTop+q.getViewPort().y;q.setStyles(l,{position:"absolute",left:-10000,top:p,width:1,height:1,overflow:"hidden"});if(tinymce.isIE){m=n.getRng();p=q.doc.body.createTextRange();p.moveToElementText(l);p.execCommand("Paste");q.remove(l);
if(l.innerHTML==="\ufeff\ufeff"){c.execCommand("mcePasteWord");g.preventDefault()}else{n.setRng(m);n.setContent("");setTimeout(function(){b({content:l.innerHTML})},0);return tinymce.dom.Event.cancel(g)}}else{var r=function(t){t.preventDefault()};q.bind(c.getDoc(),"mousedown",r);q.bind(c.getDoc(),"keydown",r);o=c.selection.getRng();l=l.firstChild;p=c.getDoc().createRange();p.setStart(l,0);p.setEnd(l,2);n.setRng(p);window.setTimeout(function(){var t="",y;if(q.select("div.mcePaste > div.mcePaste").length)t=
"<pre>"+q.encode(s).replace(/\r?\n/g,"<br />")+"</pre>";else{y=q.select("div.mcePaste");d(y,function(u){var v=u.firstChild;v&&v.nodeName=="DIV"&&v.style.marginTop&&v.style.backgroundColor&&q.remove(v,1);d(q.select("span.Apple-style-span",u),function(z){q.remove(z,1)});d(q.select("br[data-mce-bogus]",u),function(z){q.remove(z)});if(u.parentNode.className!="mcePaste")t+=u.innerHTML})}d(q.select("div.mcePaste"),function(u){q.remove(u)});o&&n.setRng(o);b({content:t});q.unbind(c.getDoc(),"mousedown",r);
q.unbind(c.getDoc(),"keydown",r)},0)}}}var h=this;h.editor=c;h.url=e;h.onPreProcess=new tinymce.util.Dispatcher(h);h.onPostProcess=new tinymce.util.Dispatcher(h);h.onPreProcess.add(h._preProcess);h.onPostProcess.add(h._postProcess);h.onPreProcess.add(function(g,l){c.execCallback("paste_preprocess",g,l)});h.onPostProcess.add(function(g,l){c.execCallback("paste_postprocess",g,l)});c.onKeyDown.addToTop(function(g,l){if((tinymce.isMac?l.metaKey:l.ctrlKey)&&l.keyCode==86||l.shiftKey&&l.keyCode==45)return false});
c.pasteAsPlainText=k(c,"paste_text_sticky_default");c.addCommand("mceInsertClipboardContent",function(g,l){b(l,true)});k(c,"paste_text_use_dialog")||c.addCommand("mcePasteText",function(){var g=tinymce.util.Cookie;c.pasteAsPlainText=!c.pasteAsPlainText;c.controlManager.setActive("pastetext",c.pasteAsPlainText);if(c.pasteAsPlainText&&!g.get("tinymcePasteText")){k(c,"paste_text_sticky");c.windowManager.alert(c.translate("paste.plaintext_mode_sticky"));k(c,"paste_text_notifyalways")||g.set("tinymcePasteText",
"1",new Date((new Date).getFullYear()+1,12,31))}});c.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"});c.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"});if(k(c,"paste_auto_cleanup_on_paste"))tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?c.onKeyDown.addToTop(function(g,l){if((tinymce.isMac?l.metaKey:l.ctrlKey)&&l.keyCode==86||l.shiftKey&&l.keyCode==45)f(l)}):c.onPaste.addToTop(function(g,l){return f(l)});c.onInit.add(function(){c.controlManager.setActive("pastetext",
c.pasteAsPlainText);k(c,"paste_block_drop")&&c.dom.bind(c.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(g){g.preventDefault();g.stopPropagation();return false})});h._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(c,e){function b(m){d(m,
function(n){f=n.constructor==RegExp?f.replace(n,""):f.replace(n[0],n[1])})}c=this.editor;var f=e.content,h=tinymce.grep,g=tinymce.explode,l=tinymce.trim,o,p;if(c.settings.paste_enable_default_filters!=false){tinymce.isIE&&document.documentMode>=9&&b([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]);if(/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(f)||
e.wordContent){e.wordContent=true;b([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]);if(k(c,"paste_convert_headers_to_strong"))f=f.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>");k(c,"paste_convert_middot_lists")&&b([[/<!--\[if !supportLists\]--\>/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]);b([/<!--[\s\S]+?--\>/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,
[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"]]);do{o=f.length;f=f.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1")}while(o!=f.length);if(k(c,"paste_retain_style_properties").replace(/^none$/i,"").length==0)f=f.replace(/<\/?span[^>]*>/gi,"");else b([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(m,n){return n.length>0?n.replace(/./," ").slice(Math.floor(n.length/2)).split("").join("\u00a0"):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,
function(m,n,q){var s=[],r=0;m=g(l(q).replace(/&quot;/gi,"'"),";");d(m,function(t){function y(z){return z+(z!=="0"&&/\d$/.test(z))?"px":""}var u,v=g(t,":");if(v.length==2){t=v[0].toLowerCase();u=v[1].toLowerCase();switch(t){case "mso-padding-alt":case "mso-padding-top-alt":case "mso-padding-right-alt":case "mso-padding-bottom-alt":case "mso-padding-left-alt":case "mso-margin-alt":case "mso-margin-top-alt":case "mso-margin-right-alt":case "mso-margin-bottom-alt":case "mso-margin-left-alt":case "mso-table-layout-alt":case "mso-height":case "mso-width":case "mso-vertical-align-alt":s[r++]=
t.replace(/^mso-|-alt$/g,"")+":"+y(u);return;case "horiz-align":s[r++]="text-align:"+u;return;case "vert-align":s[r++]="vertical-align:"+u;return;case "font-color":case "mso-foreground":s[r++]="color:"+u;return;case "mso-background":case "mso-highlight":s[r++]="background:"+u;return;case "mso-default-height":s[r++]="min-height:"+y(u);return;case "mso-default-width":s[r++]="min-width:"+y(u);return;case "mso-padding-between-alt":s[r++]="border-collapse:separate;border-spacing:"+y(u);return;case "text-line-through":if(u==
"single"||u=="double")s[r++]="text-decoration:line-through";return;case "mso-zero-height":if(u=="yes")s[r++]="display:none";return}/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(t)||(s[r++]=t+":"+v[1])}});return r>0?n+' style="'+s.join(";")+'"':n}]])}k(c,"paste_convert_headers_to_strong")&&b([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]);
b([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]);p=k(c,"paste_strip_class_attributes");if(p!=="none"){o=function(m,n){if(p==="all")return"";m=h(g(n.replace(/^(["'])(.*)\1$/,"$2")," "),function(q){return/^(?!mso)/i.test(q)});return m.length?' class="'+m.join(" ")+'"':""};f=f.replace(/ class="([^"]+)"/gi,o);f=f.replace(/ class=([\-\w]+)/gi,o)}if(k(c,"paste_remove_spans"))f=f.replace(/<\/?span[^>]*>/gi,"");e.content=f}},_postProcess:function(c,e){var b=this.editor,
f=b.dom,h;if(b.settings.paste_enable_default_filters!=false){if(e.wordContent){d(f.select("a",e.node),function(g){if(!g.href||g.href.indexOf("#_Toc")!=-1)f.remove(g,1)});k(b,"paste_convert_middot_lists")&&this._convertLists(c,e);h=k(b,"paste_retain_style_properties");if(tinymce.is(h,"string")&&h!=="all"&&h!=="*"){h=tinymce.explode(h.replace(/^none$/i,""));d(f.select("*",e.node),function(g){var l={},o=0,p,m,n;if(h)for(p=0;p<h.length;p++){m=h[p];if(n=f.getStyle(g,m)){l[m]=n;o++}}f.setAttrib(g,"style",
"");if(h&&o>0)f.setStyles(g,l);else g.nodeName=="SPAN"&&!g.className&&f.remove(g,true)})}}if(k(b,"paste_remove_styles")||k(b,"paste_remove_styles_if_webkit")&&tinymce.isWebKit)d(f.select("*[style]",e.node),function(g){g.removeAttribute("style");g.removeAttribute("data-mce-style")});else tinymce.isWebKit&&d(f.select("*",e.node),function(g){g.removeAttribute("data-mce-style")})}},_convertLists:function(c,e){var b=c.editor.dom,f,h,g=-1,l,o=[],p;d(b.select("p",e.node),function(m){var n,q="",s;for(n=m.firstChild;n&&
n.nodeType==3;n=n.nextSibling)q+=n.nodeValue;q=m.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g,"\u00a0");if(/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(q))s="ul";if(/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(q))s="ol";if(s){l=parseFloat(m.style.marginLeft||0);l>g&&o.push(l);if(!f||s!=p){f=b.create(s);b.insertAfter(f,m)}else if(l>g)f=h.appendChild(b.create(s));else if(l<g){n=tinymce.inArray(o,l);q=b.getParents(f.parentNode,s);f=q[q.length-1-n]||f}d(b.select("span",m),
function(r){var t=r.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");if(s=="ul"&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(t))b.remove(r);else/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(t)&&b.remove(r)});n=m.innerHTML;n=s=="ul"?m.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):m.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,"");h=f.appendChild(b.create("li",0,n));b.remove(m);g=l;p=s}else f=g=0});
c=e.node.innerHTML;if(c.indexOf("__MCE_ITEM__")!=-1)e.node.innerHTML=c.replace(/__MCE_ITEM__/g,"")},_insert:function(c,e){var b=this.editor,f=b.selection.getRng();!b.selection.isCollapsed()&&f.startContainer!=f.endContainer&&b.getDoc().execCommand("Delete",false,null);b.execCommand("mceInsertContent",false,c,{skip_undo:e})},_insertPlainText:function(c,e,b){function f(t){d(t,function(y){b=y.constructor==RegExp?b.replace(y,""):b.replace(y[0],y[1])})}var h,g,l,o,p,m,n,q=c.getWin(),s=c.getDoc(),r=c.selection;
l=tinymce.is;o=k(c,"paste_text_linebreaktype");p=k(c,"paste_text_replacements");if(typeof b==="string"&&b.length>0){/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(b)?f([/[\n\r]+/g]):f([/\r+/g]);f([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"],/^\s+|\s+$/g]);
b=e.decode(tinymce.html.Entities.encodeRaw(b));r.isCollapsed()||s.execCommand("Delete",false,null);if(l(p,"array")||l(p,"array"))f(p);else l(p,"string")&&f(new RegExp(p,"gi"));if(o=="none")f([[/\n+/g," "]]);else o=="br"?f([[/\n/g,"<br />"]]):f([/^\s+|\s+$/g,[/\n\n/g,"</p><p>"],[/\n/g,"<br />"]]);if((l=b.indexOf("</p><p>"))!=-1){o=b.lastIndexOf("</p><p>");h=r.getNode();p=[];do if(h.nodeType==1){if(h.nodeName=="TD"||h.nodeName=="BODY")break;p[p.length]=h}while(h=h.parentNode);if(p.length>0){m=b.substring(0,
l);n="";h=0;for(g=p.length;h<g;h++){m+="</"+p[h].nodeName.toLowerCase()+">";n+="<"+p[p.length-h-1].nodeName.toLowerCase()+">"}b=l==o?m+n+b.substring(l+7):m+b.substring(l+4,o+4)+n+b.substring(o+7)}}c.execCommand("mceInsertRawHTML",false,b+'<span id="_plain_text_marker">&nbsp;</span>');window.setTimeout(function(){var t=e.get("_plain_text_marker"),y,u;r.select(t,false);s.execCommand("Delete",false,null);y=r.getStart();t=e.getViewPort(q);u=e.getPos(y).y;y=y.clientHeight;if(u<t.y||u+y>t.y+t.h)s.body.scrollTop=
u<t.y?u:u-t.h+25},0)}},_legacySupport:function(){var c=this,e=c.editor;e.addCommand("mcePasteWord",function(){e.windowManager.open({file:c.url+"/pasteword.htm",width:parseInt(k(e,"paste_dialog_width")),height:parseInt(k(e,"paste_dialog_height")),inline:1})});k(e,"paste_text_use_dialog")&&e.addCommand("mcePasteText",function(){e.windowManager.open({file:c.url+"/pastetext.htm",width:parseInt(k(e,"paste_dialog_width")),height:parseInt(k(e,"paste_dialog_height")),inline:1})});e.addButton("pasteword",
{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}});tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)})();
(function(){var k=tinymce.DOM,d=tinymce.dom.Element,a=tinymce.dom.Event,c=tinymce.each,e=tinymce.is;tinymce.create("tinymce.plugins.InlinePopups",{init:function(b,f){b.onBeforeRenderUI.add(function(){b.windowManager=new tinymce.InlineWindowManager(b);b.settings.inlinepopups_central_css||k.loadCSS(f+"/skins/"+(b.settings.inlinepopups_skin||"clearlooks2")+"/window.css")})},getInfo:function(){return{longname:"InlinePopups",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/inlinepopups",
version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.create("tinymce.InlineWindowManager:tinymce.WindowManager",{InlineWindowManager:function(b){this.parent(b);this.zIndex=3E5;this.count=0;this.windows={}},open:function(b,f){var h=this,g,l="",o=h.editor,p=0,m=0,n;b=b||{};f=f||{};if(!b.inline)return h.parent(b,f);if((n=h._frontWindow())&&k.get(n.id+"_ifr"))n.focussedElement=k.get(n.id+"_ifr").contentWindow.document.activeElement;if(!b.type)h.bookmark=o.selection.getBookmark(1);g=k.uniqueId();
n=k.getViewPort();b.width=parseInt(b.width||320);b.height=parseInt(b.height||240)+(tinymce.isIE?8:0);b.min_width=parseInt(b.min_width||150);b.min_height=parseInt(b.min_height||100);b.max_width=parseInt(b.max_width||2E3);b.max_height=parseInt(b.max_height||2E3);b.left=b.left||Math.round(Math.max(n.x,n.x+n.w/2-b.width/2));b.top=b.top||Math.round(Math.max(n.y,n.y+n.h/2-b.height/2));b.movable=b.resizable=true;f.mce_width=b.width;f.mce_height=b.height;f.mce_inline=true;f.mce_window_id=g;f.mce_auto_focus=
b.auto_focus;h.features=b;h.params=f;h.onOpen.dispatch(h,b,f);if(b.type){l+=" mceModal";if(b.type)l+=" mce"+b.type.substring(0,1).toUpperCase()+b.type.substring(1);b.resizable=false}if(b.statusbar)l+=" mceStatusbar";if(b.resizable)l+=" mceResizable";if(b.minimizable)l+=" mceMinimizable";if(b.maximizable)l+=" mceMaximizable";if(b.movable)l+=" mceMovable";h._addAll(k.doc.body,["div",{id:g,role:"dialog","aria-labelledby":b.type?g+"_content":g+"_title","class":(o.settings.inlinepopups_skin||"clearlooks2")+
(tinymce.isIE&&window.getSelection?" ie9":""),style:"width:100px;height:100px"},["div",{id:g+"_wrapper","class":"mceWrapper"+l},["div",{id:g+"_top","class":"mceTop"},["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:g+"_title"},b.title||""]],["div",{id:g+"_middle","class":"mceMiddle"},["div",{id:g+"_left","class":"mceLeft",tabindex:"0"}],["span",{id:g+"_content"}],["div",{id:g+"_right","class":"mceRight",tabindex:"0"}]],["div",{id:g+"_bottom","class":"mceBottom"},
["div",{"class":"mceLeft"}],["div",{"class":"mceCenter"}],["div",{"class":"mceRight"}],["span",{id:g+"_status"},"Content"]],["a",{"class":"mceMove",tabindex:"-1",href:"javascript:;"}],["a",{"class":"mceMin",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMax",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceMed",tabindex:"-1",href:"javascript:;",onmousedown:"return false;"}],["a",{"class":"mceClose",tabindex:"-1",href:"javascript:;",
onmousedown:"return false;"}],["a",{id:g+"_resize_n","class":"mceResize mceResizeN",tabindex:"-1",href:"javascript:;"}],["a",{id:g+"_resize_s","class":"mceResize mceResizeS",tabindex:"-1",href:"javascript:;"}],["a",{id:g+"_resize_w","class":"mceResize mceResizeW",tabindex:"-1",href:"javascript:;"}],["a",{id:g+"_resize_e","class":"mceResize mceResizeE",tabindex:"-1",href:"javascript:;"}],["a",{id:g+"_resize_nw","class":"mceResize mceResizeNW",tabindex:"-1",href:"javascript:;"}],["a",{id:g+"_resize_ne",
"class":"mceResize mceResizeNE",tabindex:"-1",href:"javascript:;"}],["a",{id:g+"_resize_sw","class":"mceResize mceResizeSW",tabindex:"-1",href:"javascript:;"}],["a",{id:g+"_resize_se","class":"mceResize mceResizeSE",tabindex:"-1",href:"javascript:;"}]]]);k.setStyles(g,{top:-10000,left:-10000});tinymce.isGecko&&k.setStyle(g,"overflow","auto");if(!b.type){p+=k.get(g+"_left").clientWidth;p+=k.get(g+"_right").clientWidth;m+=k.get(g+"_top").clientHeight;m+=k.get(g+"_bottom").clientHeight}k.setStyles(g,
{top:b.top,left:b.left,width:b.width+p,height:b.height+m});if(f=b.url||b.file){if(tinymce.relaxedDomain)f+=(f.indexOf("?")==-1?"?":"&")+"mce_rdomain="+tinymce.relaxedDomain;f=tinymce._addVer(f)}if(b.type){k.add(g+"_wrapper","a",{id:g+"_ok","class":"mceButton mceOk",href:"javascript:;",onmousedown:"return false;"},"Ok");b.type=="confirm"&&k.add(g+"_wrapper","a",{"class":"mceButton mceCancel",href:"javascript:;",onmousedown:"return false;"},"Cancel");k.add(g+"_middle","div",{"class":"mceIcon"});k.setHTML(g+
"_content",b.content.replace("\n","<br />"));a.add(g,"keyup",function(q){if(q.keyCode===27){b.button_func(false);return a.cancel(q)}});a.add(g,"keydown",function(q){var s;if(q.keyCode===9){(s=k.select("a.mceCancel",g+"_wrapper")[0])&&s!==q.target?s.focus():k.get(g+"_ok").focus();return a.cancel(q)}})}else{k.add(g+"_content","iframe",{id:g+"_ifr",src:'javascript:""',frameBorder:0,style:"border:0;width:10px;height:10px"});k.setStyles(g+"_ifr",{width:b.width,height:b.height});k.setAttrib(g+"_ifr","src",
f)}f=a.add(g,"mousedown",function(q){var s=q.target,r;r=h.windows[g];h.focus(g);if(s.nodeName=="A"||s.nodeName=="a")if(s.className=="mceMax"){r.oldPos=r.element.getXY();r.oldSize=r.element.getSize();q=k.getViewPort();q.w-=2;q.h-=2;r.element.moveTo(q.x,q.y);r.element.resizeTo(q.w,q.h);k.setStyles(g+"_ifr",{width:q.w-r.deltaWidth,height:q.h-r.deltaHeight});k.addClass(g+"_wrapper","mceMaximized")}else if(s.className=="mceMed"){r.element.moveTo(r.oldPos.x,r.oldPos.y);r.element.resizeTo(r.oldSize.w,r.oldSize.h);
r.iframeElement.resizeTo(r.oldSize.w-r.deltaWidth,r.oldSize.h-r.deltaHeight);k.removeClass(g+"_wrapper","mceMaximized")}else if(s.className=="mceMove")return h._startDrag(g,q,s.className);else if(k.hasClass(s,"mceResize"))return h._startDrag(g,q,s.className.substring(13))});l=a.add(g,"click",function(q){var s=q.target;h.focus(g);if(s.nodeName=="A"||s.nodeName=="a")switch(s.className){case "mceClose":h.close(null,g);return a.cancel(q);case "mceButton mceOk":case "mceButton mceCancel":b.button_func(s.className==
"mceButton mceOk");return a.cancel(q)}});a.add([g+"_left",g+"_right"],"focus",function(q){var s=k.get(g+"_ifr");if(s){s=k.select(":input:enabled,*[tabindex=0]",s.contentWindow.document.body);q.target.id===g+"_left"?s[s.length-1].focus():s[0].focus()}else k.get(g+"_ok").focus()});o=h.windows[g]={id:g,mousedown_func:f,click_func:l,element:new d(g,{blocker:1,container:o.getContainer()}),iframeElement:new d(g+"_ifr"),features:b,deltaWidth:p,deltaHeight:m};o.iframeElement.on("focus",function(){h.focus(g)});
if(h.count==0&&h.editor.getParam("dialog_type","modal")=="modal"){k.add(k.doc.body,"div",{id:"mceModalBlocker","class":(h.editor.settings.inlinepopups_skin||"clearlooks2")+"_modalBlocker",style:{zIndex:h.zIndex-1}});k.show("mceModalBlocker");k.setAttrib(k.doc.body,"aria-hidden","true")}else k.setStyle("mceModalBlocker","z-index",h.zIndex-1);if(tinymce.isIE6||/Firefox\/2\./.test(navigator.userAgent)||tinymce.isIE&&!k.boxModel)k.setStyles("mceModalBlocker",{position:"absolute",left:n.x,top:n.y,width:n.w-
2,height:n.h-2});k.setAttrib(g,"aria-hidden","false");h.focus(g);h._fixIELayout(g,1);k.get(g+"_ok")&&k.get(g+"_ok").focus();h.count++;return o},focus:function(b){var f;if(f=this.windows[b]){f.zIndex=this.zIndex++;f.element.setStyle("zIndex",f.zIndex);f.element.update();b+="_wrapper";k.removeClass(this.lastId,"mceFocus");k.addClass(b,"mceFocus");this.lastId=b;if(f.focussedElement)f.focussedElement.focus();else if(k.get(b+"_ok"))k.get(f.id+"_ok").focus();else k.get(f.id+"_ifr")&&k.get(f.id+"_ifr").focus()}},
_addAll:function(b,f){var h;h=tinymce.DOM;if(e(f,"string"))b.appendChild(h.doc.createTextNode(f));else if(f.length){b=b.appendChild(h.create(f[0],f[1]));for(h=2;h<f.length;h++)this._addAll(b,f[h])}},_startDrag:function(b,f,h){function g(){if(!n){l._fixIELayout(b,0);k.add(m.body,"div",{id:"mceEventBlocker","class":"mceEventBlocker "+(l.editor.settings.inlinepopups_skin||"clearlooks2"),style:{zIndex:l.zIndex+1}});if(tinymce.isIE6||tinymce.isIE&&!k.boxModel)k.setStyles("mceEventBlocker",{position:"absolute",
left:v.x,top:v.y,width:v.w-2,height:v.h-2});n=new d("mceEventBlocker");n.update();r=s.getXY();t=s.getSize();z=u.x+r.x-v.x;A=u.y+r.y-v.y;k.add(n.get(),"div",{id:"mcePlaceHolder","class":"mcePlaceHolder",style:{left:z,top:A,width:t.w,height:t.h}});y=new d("mcePlaceHolder")}}var l=this,o,p,m=k.doc,n,q=l.windows[b],s=q.element;s.getXY();var r,t,y,u,v,z,A,C,F,K,L,M,W;u={x:0,y:0};v=k.getViewPort();v.w-=2;v.h-=2;C=f.screenX;F=f.screenY;K=L=M=W=0;o=a.add(m,"mouseup",function(X){a.remove(m,"mouseup",o);a.remove(m,
"mousemove",p);n&&n.remove();s.moveBy(K,L);s.resizeBy(M,W);t=s.getSize();k.setStyles(b+"_ifr",{width:t.w-q.deltaWidth,height:t.h-q.deltaHeight});l._fixIELayout(b,1);return a.cancel(X)});h!="Move"&&g();p=a.add(m,"mousemove",function(X){var D,N;g();D=X.screenX-C;N=X.screenY-F;switch(h){case "ResizeW":K=D;M=0-D;break;case "ResizeE":M=D;break;case "ResizeN":case "ResizeNW":case "ResizeNE":if(h=="ResizeNW"){K=D;M=0-D}else if(h=="ResizeNE")M=D;L=N;W=0-N;break;case "ResizeS":case "ResizeSW":case "ResizeSE":if(h==
"ResizeSW"){K=D;M=0-D}else if(h=="ResizeSE")M=D;W=N;break;case "mceMove":K=D;L=N;break}if(M<(D=q.features.min_width-t.w)){if(K!==0)K+=M-D;M=D}if(W<(D=q.features.min_height-t.h)){if(L!==0)L+=W-D;W=D}M=Math.min(M,q.features.max_width-t.w);W=Math.min(W,q.features.max_height-t.h);K=Math.max(K,v.x-(z+v.x));L=Math.max(L,v.y-(A+v.y));K=Math.min(K,v.w+v.x-(z+t.w+v.x));L=Math.min(L,v.h+v.y-(A+t.h+v.y));if(K+L!==0){if(z+K<0)K=0;if(A+L<0)L=0;y.moveTo(z+K,A+L)}M+W!==0&&y.resizeTo(t.w+M,t.h+W);return a.cancel(X)});
return a.cancel(f)},resizeBy:function(b,f,h){if(h=this.windows[h]){h.element.resizeBy(b,f);h.iframeElement.resizeBy(b,f)}},close:function(b,f){var h=k.doc;f=this._findId(f||b);if(this.windows[f]){this.count--;if(this.count==0){k.remove("mceModalBlocker");k.setAttrib(k.doc.body,"aria-hidden","false");this.editor.focus()}if(b=this.windows[f]){this.onClose.dispatch(this);a.remove(h,"mousedown",b.mousedownFunc);a.remove(h,"click",b.clickFunc);a.clear(f);a.clear(f+"_ifr");k.setAttrib(f+"_ifr","src",'javascript:""');
b.element.remove();delete this.windows[f];(f=this._frontWindow())&&this.focus(f.id)}}else this.parent(b)},_frontWindow:function(){var b,f=0;c(this.windows,function(h){if(h.zIndex>f){b=h;f=h.zIndex}});return b},setTitle:function(b,f){b=this._findId(b);if(b=k.get(b+"_title"))b.innerHTML=k.encode(f)},alert:function(b,f){var h=this,g;g=h.open({title:h,type:"alert",button_func:function(l){if(f)f.call(l||h,l);h.close(null,g.id)},content:k.encode(h.editor.getLang(b,b)),inline:1,width:400,height:130})},confirm:function(b,
f){var h=this,g;g=h.open({title:h,type:"confirm",button_func:function(l){if(f)f.call(l||h,l);h.close(null,g.id)},content:k.encode(h.editor.getLang(b,b)),inline:1,width:400,height:130})},_findId:function(b){if(typeof b=="string")return b;c(this.windows,function(f){var h=k.get(f.id+"_ifr");if(h&&b==h.contentWindow){b=f.id;return false}});return b},_fixIELayout:function(b,f){var h,g;if(tinymce.isIE6){c(["n","s","w","e","nw","ne","sw","se"],function(l){l=k.get(b+"_resize_"+l);k.setStyles(l,{width:f?l.clientWidth:
"",height:f?l.clientHeight:"",cursor:k.getStyle(l,"cursor",1)});k.setStyle(b+"_bottom","bottom","-1px")});if(h=this.windows[b]){h.element.hide();h.element.show();c(k.select("div,a",b),function(l){if(l.currentStyle.backgroundImage!="none"){g=new Image;g.src=l.currentStyle.backgroundImage.replace(/url\(\"(.+)\"\)/,"$1")}});k.get(b).style.filter=""}}}});tinymce.PluginManager.add("inlinepopups",tinymce.plugins.InlinePopups)})();
(function(k){k.fn.farbtastic=function(d){k.farbtastic(this,d);return this};k.farbtastic=function(d,a){d=k(d).get(0);return d.farbtastic||(d.farbtastic=new k._farbtastic(d,a))};k._farbtastic=function(d,a){var c=this;k(d).html('<div class="farbtastic"><div class="color"></div><div class="wheel"></div><div class="overlay"></div><div class="h-marker marker"></div><div class="sl-marker marker"></div></div>');var e=k(".farbtastic",d);c.wheel=k(".wheel",d).get(0);c.radius=84;c.square=100;c.width=194;c.firstClick=
true;navigator.appVersion.match(/MSIE [0-6]\./)&&k("*",e).each(function(){if(this.currentStyle.backgroundImage!="none"){var b=this.currentStyle.backgroundImage;b=this.currentStyle.backgroundImage.substring(5,b.length-2);k(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+b+"')"})}});c.linkTo=function(b){typeof c.callback=="object"&&k(c.callback).unbind("keyup",c.updateValue);c.color=null;if(typeof b=="function")c.callback=
b;else if(typeof b=="object"||typeof b=="string"){c.callback=k(b);c.callback.bind("keyup",c.updateValue);c.callback.get(0).value&&c.setColor(c.callback.get(0).value)}return this};c.updateValue=function(){this.value&&this.value!=c.color&&c.setColor(this.value)};c.setColor=function(b){var f=c.unpack(b);if(c.color!=b&&f){c.color=b;c.rgb=f;c.hsl=c.RGBToHSL(c.rgb);c.updateDisplay()}return this};c.setHSL=function(b){c.hsl=b;c.rgb=c.HSLToRGB(b);c.color=c.pack(c.rgb);c.updateDisplay();return this};c.widgetCoords=
function(b){var f=k(c.wheel).offset();return{x:b.pageX-f.left-c.width/2,y:b.pageY-f.top-c.width/2}};c.mousedown=function(b){if(!document.dragging){k(document).bind("mousemove",c.mousemove).bind("mouseup",c.mouseup);document.dragging=true}var f=c.widgetCoords(b);c.circleDrag=Math.max(Math.abs(f.x),Math.abs(f.y))*2>c.square;c.mousemove(b);return false};c.mousemove=function(b){var f=c.widgetCoords(b);if(c.circleDrag){b=Math.atan2(f.x,-f.y)/6.28;if(b<0)b+=1;if(c.firstClick&&(c.hsl[2]==0||c.hsl[2]==1)){c.firstClick=
false;c.setHSL([b,1,0.5])}else c.setHSL([b,c.hsl[1],c.hsl[2]])}else{b=Math.max(0,Math.min(1,-(f.x/c.square)+0.5));f=Math.max(0,Math.min(1,-(f.y/c.square)+0.5));c.setHSL([c.hsl[0],b,f])}return false};c.mouseup=function(){k(document).unbind("mousemove",c.mousemove);k(document).unbind("mouseup",c.mouseup);document.dragging=false};c.updateDisplay=function(){var b=c.hsl[0]*6.28;k(".h-marker",e).css({left:Math.round(Math.sin(b)*c.radius+c.width/2)+"px",top:Math.round(-Math.cos(b)*c.radius+c.width/2)+"px"});
k(".sl-marker",e).css({left:Math.round(c.square*(0.5-c.hsl[1])+c.width/2)+"px",top:Math.round(c.square*(0.5-c.hsl[2])+c.width/2)+"px"});k(".color",e).css("backgroundColor",c.pack(c.HSLToRGB([c.hsl[0],1,0.5])));if(typeof c.callback=="object"){k(c.callback).css({backgroundColor:c.color,color:c.hsl[2]>0.5?"#000":"#fff"});k(c.callback).each(function(){if(this.value&&this.value!=c.color)this.value=c.color})}else typeof c.callback=="function"&&c.callback.call(c,c.color)};c.pack=function(b){var f=Math.round(b[0]*
255),h=Math.round(b[1]*255);b=Math.round(b[2]*255);return"#"+(f<16?"0":"")+f.toString(16)+(h<16?"0":"")+h.toString(16)+(b<16?"0":"")+b.toString(16)};c.unpack=function(b){if(b.length==7)return[parseInt("0x"+b.substring(1,3))/255,parseInt("0x"+b.substring(3,5))/255,parseInt("0x"+b.substring(5,7))/255];else if(b.length==4)return[parseInt("0x"+b.substring(1,2))/15,parseInt("0x"+b.substring(2,3))/15,parseInt("0x"+b.substring(3,4))/15]};c.HSLToRGB=function(b){var f,h=b[0];f=b[1];b=b[2];f=b<=0.5?b*(f+1):
b+f-b*f;b=b*2-f;return[this.hueToRGB(b,f,h+0.33333),this.hueToRGB(b,f,h),this.hueToRGB(b,f,h-0.33333)]};c.hueToRGB=function(b,f,h){h=h<0?h+1:h>1?h-1:h;if(h*6<1)return b+(f-b)*h*6;if(h*2<1)return f;if(h*3<2)return b+(f-b)*(0.66666-h)*6;return b};c.RGBToHSL=function(b){var f,h,g,l,o=b[0],p=b[1],m=b[2];f=Math.min(o,Math.min(p,m));b=Math.max(o,Math.max(p,m));h=b-f;l=(f+b)/2;g=0;if(l>0&&l<1)g=h/(l<0.5?2*l:2-2*l);f=0;if(h>0){if(b==o&&b!=p)f+=(p-m)/h;if(b==p&&b!=m)f+=2+(m-o)/h;if(b==m&&b!=o)f+=4+(o-p)/h;
f/=6}return[f,g,l]};k("*",e).mousedown(c.mousedown);c.setColor("#000000");a&&c.linkTo(a)}})(jQuery);
(function(k,d){k.create("wikispaces.plugins.AutoloadPlugin",{init:function(a){this.editor=a;var c=this;a.onInit.add(function(e){e.onInitSubEditor&&e.onInitSubEditor.add(function(g){g.onChange.add(function(){k.mainEditor.plugins.wsautosave.autosaveDelayed()})});if(c.editorForm().contentPresent.value){c.loadVersionFromForm();var b=d("#autosaveData").get(0);if(b){var f=b.autosaveContent.value,h=JSON.parse(b.autosavePageComments.value);c.autoload(f,h,b.autosaveDate.value,b.autosaveVersion.value,b.autosaveCleanup.value,
b.autosaveAge.value,b.autosaveConflict.value)}}else{d("#wsMainEditor_container").hide();d.ajax({url:"/page/dump/"+encodeURIComponent(wikispaces_page)+"/"+encodeURIComponent(wikispaces_page_version),xhr:WikispacesCommon.jQueryAjaxFix,type:"GET",cache:false,data:{format:WikispacesEditor.getMode()},global:false,error:function(g,l,o){c.error(g,l,o)},success:function(g,l,o){if(o.status==0)return c.error(o,l,null);c.loadData(g);d("#content_view").hide()},complete:function(){d("#wsMainEditor_container").show();
e.plugins.wstoolbarscroll.moveScroller()}})}})},convertHtml:function(){d("#contentEditButton").remove();d("#content_view").contents().filter(function(){return this.nodeType==8&&d.trim(this.data).substring(0,3)!="ws:"}).remove();return d.trim(d("#content_view").html().replace(/<!-- ws:start:WikiText[a-zA-Z]+Rule:(\d+):([\s\S]*?) --\>[\s\S]*?<!-- ws:end:WikiText[a-zA-Z]+Rule:\1 --\>/g,function(a,c,e){return e?d("<div>").html(e).text():""}))},getInfo:function(){return{longname:"Wikispaces autoload",
author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},error:function(){WikispacesCommon.track("Editor","Start","Inline Failure");document.location="/page/edit/"+encodeURIComponent(wikispaces_page)},loadData:function(a){a=d(a);try{var c=a.find("checkout checkoutStatus").text(),e=a.find("checkout checkoutUser").text(),b=a.find("checkout checkoutDate").text(),f=a.find("checkout checkoutRefreshDate").text();this.checkout(c,e,b,f);var h;h=parseInt(a.find("dump contentChanged").text())?
a.find("dump content").text():this.convertHtml();var g=a.find("dump version").text(),l=a.find("dump editorCleanup").text(),o=JSON.parse(a.find("dump pageComments").text());this.loadVersion(h,o,g,l);var p=a.find("dump autosave autosaveContent").text(),m=a.find("dump autosave autosaveDate").text(),n=a.find("dump autosave autosaveVersion").text(),q=a.find("dump autosave autosaveCleanup").text(),s=a.find("dump autosave autosaveAge").text(),r=a.find("dump autosave autosaveConflict").text(),t=(o=a.find("dump autosave autosavePageComments").text())?
JSON.parse(o):{};this.autoload(p,t,m,n,q,s,r);WikispacesCommon.track("Editor","Start","Inline")}catch(y){this.error()}},checkout:function(a,c){if(a=="locked"&&(!wikispaces_isUserLoggedIn||c!=wikispaces_username)){alert(this.checkoutMessage);document.location="/"+encodeURIComponent(wikispaces_page)}},loadVersionFromForm:function(){var a=JSON.parse(this.editorForm().pageComments.value);this.loadVersion(d("#wsMainEditor").val(),a,this.editorForm().version.value,this.editorForm().editorCleanup.value)},
loadVersion:function(a,c,e,b){var f=this;d("html, body").animate({scrollTop:0},"fast");this.editorForm().version.value=e;this.editorForm().editorCleanup.value=b;if(WikispacesEditor.getMode()=="plain")this.editor.plugins.wstext.flipToText(a);else{this.editor.setContent(a,{wsautoload:true});if(k.isIE)b+=",brTable";wikispaces.util.Cleanup.cleanup(this.editor,b,false);this.editor.undoManager.clear();this.editor.setClean();this.editor.onModeSwitch.dispatch("visual");setTimeout(function(){f.editor.focus();
f.editor.wsselection.ensureCursor();f.editor.onNeedsResize.dispatch()},100);d("img",this.editor.getBody()).load(function(){f.editor.onNeedsResize.dispatch()}).each(function(){this.src=this.src})}this.editor.plugins.wscomment.loadComments(c)},editorForm:function(){return d(this.editor.getContainer()).closest("form").get(0)},autoload:function(a,c,e,b,f,h,g){var l=this;if(e)if(parseInt(g)&&h>=86400){k.mainEditor.plugins.wspopup.show("expiredDraft");d("#expiredDraftDate").text(e);d("#expiredDraftContent").html(a)}else{this.autosaveContent=
a;this.autosavePageComments=c;this.autosaveVersion=b;this.autosaveCleanup=f;k.mainEditor.plugins.wspopup.show("draftRecovered");d("#recoveredDraftDate").text(e);a=this.editorForm().version.value;if(b!=a){d("#outOfDateDraft").show();b="/page/diff/"+encodeURIComponent(wikispaces_page)+"?v1="+encodeURIComponent(b)+"&v2="+encodeURIComponent(a);d("#outOfDateDraft a").attr("href",b)}}this.editor.onChange.add(function(){l.editor.plugins.wsautosave.autosaveDelayed()})}});k.PluginManager.add("wsautoload",
wikispaces.plugins.AutoloadPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.AutosavePlugin",{AUTOSAVE_INTERVAL:6E4,concurrentEditors:[],savedVersions:[],init:function(a){this.editor=a;this.autosaveEnabled=k.activeEditor.getParam("wsautosave_enabled");var c=this;a.addCommand("wsautosave",function(){c.autosave()});a.onInit.add(function(){if(!WikispacesContent.isLoaded){d("#concurrentEditorDetails").attr("disabled",true);WikispacesContent.add(function(){d("#concurrentEditorDetails").attr("disabled",false)})}setInterval(function(){k.activeEditor.undoManager.add()},
61E3)})},getInfo:function(){return{longname:"Wikispaces autosave",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},autosaveDelayed:function(){var a=this;if(!this.autosaveDelayedHandle)this.autosaveDelayedHandle=setTimeout(function(){a.autosave(true)},this.AUTOSAVE_INTERVAL)},autosave:function(a,c){clearTimeout(this.autosaveDelayedHandle);delete this.autosaveDelayedHandle;if(this.autosaveEnabled){log("autosave",a);var e=this;if(typeof a=="undefined")a=
true;this.setStatus("Saving Draft...");if(typeof c=="undefined")c=this.editor.plugins.wscommon.fullContent(false);var b=function(){WikispacesSession.reloadSession(function(){e.autosave(a)},3E3,function(){e.editor.plugins.wscommon.sessionReloadFailed()})};d.ajaxq("autosave",{url:this.getAutosaveUrl(),xhr:WikispacesCommon.jQueryAjaxFix,type:"POST",async:a,cache:false,data:{content:c,pageComments:this.editor.plugins.wscomment.newComments()},dataType:"xml",global:false,error:b,success:function(f,h,g){if(g.status==
0)return b.call(this,g,h,null);e.autosaveProcessResponse(f);WikispacesSession.reloadSessionSuccess()}});log("autosave finished")}else log("not autosaving (disabled)",a)},getAutosaveUrl:function(){var a=WikispacesEditor.getMode(),c=d(this.editor.getContainer()).closest("form").get(0).version.value;return"/page/autosave/"+encodeURIComponent(wikispaces_page)+"/"+encodeURIComponent(c)+"?mode="+encodeURIComponent(a)},setStatus:function(a,c){d("#autosaveStatus").hide().html(a).fadeIn(2E3);c&&d("#autosaveStatus").css("color",
"red")},autosaveProcessResponse:function(a){log("autosaveProcessResponse",a);var c=this;a=d(a);var e=false,b=a.find("autosave save").text(),f=a.find("autosave error").attr("message");if(b)this.setStatus("Draft Saved at "+b,false);else f?this.setStatus(f,true):this.setStatus("");b=this.savedVersions.length;if(a.find("status").attr("type")=="changed"){this.savedVersions=[];a.find("status revision").each(function(){var h=d(this).find("user").text(),g=d(this).find("date").text(),l=d(this).attr("id");
c.savedVersions.push({id:l,editor:h,time:g})})}if(this.savedVersions.length>b){WikispacesCommon.track("Editor","Concurrent Editing","Concurrent Save");e=true}b=this.concurrentEditors.length>0;this.concurrentEditors=[];a.find("concurrent editor").each(function(){var h=d(this).find("user").text(),g=d(this).find("date").text();c.concurrentEditors.push({editor:h,time:g})});if(!b&&this.concurrentEditors.length){WikispacesCommon.track("Editor","Concurrent Editing","Start");e=true}b&&this.concurrentEditors.length==
0&&WikispacesCommon.track("Editor","Concurrent Editing","End");this.concurrentEditors.length&&WikispacesCommon.track("Editor","Concurrent Editing","Editor Count",this.concurrentEditors.length);b=d.trim(a.find("autosave merge mergeStatus").text());this.mergeResult="";if(b=="failed")WikispacesCommon.track("Editor","Concurrent Editing","Merge Failed");else if(b=="success"){WikispacesCommon.track("Editor","Concurrent Editing","Merge Success");this.mergeResult=a.find("autosave merge mergeResult").text()}this.mergeStatus=
b;e&&this.statusUpdated()},showConcurrentEditorPopup:function(){k.mainEditor.plugins.wspopup.show("concurrentEditor");if(this.savedVersions.length){var a=d(this.editor.getContainer()).closest("form").get(0).version.value;d("#concurrentEditor_savedVersions").empty();d.each(this.savedVersions,function(e,b){e=d('<li><img src="/user/pic/'+b.editor+'-sm.jpg" height="16" width="16" style="vertical-align: text-top;"/> '+b.editor+" saved a new version at "+b.time+'.  <a href="/page/diff/'+encodeURIComponent(wikispaces_page)+
"/"+b.id+'" target="_new">View the changes</a></li>');d("#concurrentEditor_savedVersions").append(e)});if(this.savedVersions.length>1){var c=this.savedVersions[this.savedVersions.length-1].id;d("#concurrentEditor_savedVersion_viewChanges").html('<a href="/page/diff/'+encodeURIComponent(wikispaces_page)+"?v1="+a+"&v2="+c+'" target="_new">View all changes since I started editing</a>').show()}d("#concurrentEditor_savedVersion_heading").show()}if(this.concurrentEditors.length){d("#concurrentEditor_otherEditors").empty();
d.each(this.concurrentEditors,function(e,b){e=d('<li><img src="/user/pic/'+b.editor+'-sm.jpg" height="16" width="16" style="vertical-align: text-top"/> '+b.editor+" started editing this page at "+b.time+"</li>");d("#concurrentEditor_otherEditors").append(e)});d("#concurrentEditor_otherEditor_heading").show();d("#concurrentEditor_noEditors").hide()}else{d("#concurrentEditor_otherEditor_heading").hide();d("#concurrentEditor_noEditors").show()}k.mainEditor.plugins.wspopup.resize("concurrentEditor")},
statusUpdated:function(){var a=this,c="";if(this.savedVersions.length==1&&!this.concurrentEditors.length){var e=this.savedVersions[0].editor;c='<img src="/user/pic/'+e+'-sm.jpg" height="16" width="16" style="vertical-align: text-top;"/> '+e+" saved this page."}else if(this.savedVersions.length>1&&!this.concurrentEditors.length)c=this.savedVersions.length+" people have saved this page.";else if(!this.savedVersions.length&&this.concurrentEditors.length==1){e=this.concurrentEditors[0].editor;c='<img src="/user/pic/'+
e+'-sm.jpg" height="16" width="16" style="vertical-align: text-top;"/> '+e+" is editing."}else if(!this.savedVersions.length&&this.concurrentEditors.length>1)c=this.concurrentEditors.length+" people are editing.";else if(this.savedVersions.length&&this.concurrentEditors.length)c="This page is being edited and has been saved.";else return;var b=d("#concurrentEditorNotice");if(b.get(0))d("#concurrentEditorNoticeMessage").html(c);else{b=d('<div id="concurrentEditorNotice" class="mceToolbar">').hide();
e=d('<div id="concurrentEditorNoticeMessage" style="display: inline;">');e.html(c);c=d('<button class="btn" id="concurrentEditorDetails"><span><span>Details</span></span></button>');c.click(function(h){a.showConcurrentEditorPopup();b.hide();h.preventDefault();return false});var f=d('<button class="btn"><span><span>Hide</span></span></button>');f.click(function(h){b.hide();h.preventDefault();return false});b.append(e).append(c).append(f);d(".mceExternalToolbar").append(b)}b.is(":visible")||b.slideDown()}});
k.PluginManager.add("wsautosave",wikispaces.plugins.AutosavePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.BlockFormatPlugin",{init:function(a){this.editor=a;a.addCommand("wsFormatBlock",function(e,b){if(k.isIE){var f=d(a.selection.getNode());f.is("p")&&f.contents().length==0&&f.append("\ufeff");a.execCommand("FormatBlock",e,b)}else{a.undoManager.begin();f=a.selection.getBookmark(2);if(d(k.activeEditor.selection.getNode()).closest("li").length>0){a.execCommand("FormatBlock",e,"p");a.execCommand("FormatBlock",e,b);d(k.activeEditor.selection.getNode()).closest("li").find("p").each(function(h,
g){d(g).replaceWith(g.childNodes)})}else{a.execCommand("FormatBlock",e,b);d(a.plugins.wscommon.getSiblingOfElement(a.theme.getHeaderParent(a.selection.getNode()),"previous")).filter("br").after("<br>")}a.selection.moveToBookmark(f);a.undoManager.end()}});a.onKeyDown.add(function(e,b){if(b.keyCode==13&&b.shiftKey&&d(e.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").length>0&&!e.wsselection.isAtTheEndOf("h1,h2,h3,h4,h5,h6")){var f=d(e.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").get(0);e.selection.setContent("<span id='_ws_tmp'></span>");
var h=d("#_ws_tmp",e.getDoc()).get(0);e.dom.split(f,h);e.plugins.wscommon.cursorToAndRemoveElement(d("<span>",e.getDoc()).prependTo(d(h).next()));d(h).remove();k.dom.Event.cancel(b)}});if(k.isWebKit){var c=false;a.onKeyDown.add(function(e,b){c=b.keyCode==13&&d(e.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").length>0});a.onKeyUp.add(function(e){if(c&&d(e.selection.getNode()).closest("div").length>0){var b=d("<span>",e.getDoc()).replaceAll(d(e.selection.getNode()).closest("div")).after("<br/>");
e.plugins.wscommon.cursorToAndRemoveElement(b)}})}k.isGecko&&a.onKeyUp.add(function(e,b){if(9==b.keyCode){b=d(e.selection.getNode()).closest("p");if(/padding-left/.test(b.attr("style"))){b.css("padding-left","");e.undoManager.add()&&e.undoManager.remove()}}})},getInfo:function(){return{longname:"Wikispaces block Format",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});k.PluginManager.add("wsblockformat",wikispaces.plugins.BlockFormatPlugin)})(tinymce,
jQuery);
(function(k,d){k.create("wikispaces.plugins.BrToP",{init:function(a){var c=this;c.editor=a;a.onBeforeSetContent.add(function(e,b){if("raw"!=b.format&&WikispacesEditor.getMode()=="visual")b.content=c.processContent(b.content)});a.plugins.paste&&a.plugins.paste.onPostProcess.add(function(e,b){if(d.browser.msie){d("span[style]",b.node).each(function(){var f=d(this);f.css("text-align")=="left"&&f.css("text-align","")});d("span:empty",b.node).remove();d("p br",b.node).remove();d("li br",b.node).remove()}e=d(b.node).html();
d(b.node).html(c.processContent(e))});a.onKeyDown.add(function(e,b){if(b.shiftKey&&b.keyCode==13){var f=d(e.selection.getNode()).closest("li,td,th,p,pre,code");if(!f.is("pre,code")){b.stopPropagation();b.preventDefault();e.undoManager.begin();e.selection.setContent('<span id="wsTemp">\ufeff</span>');if(!f.is("p")){f.wrapInner('<p id="wsHolder">');f=d(f).find("#wsHolder").removeAttr("id")}f.children().last().is("br")&&f.children().last().remove();var h=true,g=true,l=false;d(f).contents().each(function(p,
m){if(l&&(m.nodeType==1||!e.plugins.wscommon.isTextEmpty(m.nodeValue)))g=false;if(d(m).is("#wsTemp"))l=true;if(!l&&(m.nodeType==1||!e.plugins.wscommon.isTextEmpty(m.nodeValue)))h=false});if(!l){h=false;for(b=d(f).contents().get(0);!l&&b;){for(var o=1;b&&b.nodeType==3&&e.plugins.wscommon.isTextEmpty(b.nodeValue);)b=d(b).parent().contents().get(o++);if(d(b).is("#wsTemp"))h=l=true;else b=d(b).contents().get(0)}g=false;for(b=d(f).contents().last().get(0);!l&&b;){for(o=d(b).parent().contents().length-
2;b&&b.nodeType==3&&e.plugins.wscommon.isTextEmpty(b.nodeValue);)b=d(b).parent().contents().get(o--);if(d(b).is("#wsTemp"))g=l=true;else b=d(b).contents().last().get(0)}}if(!h&&!g){e.dom.split(f.get(0),d("#wsTemp",e.getDoc()).get(0));e.selection.select(d("#wsTemp",e.getDoc()).next("p").get(0),true);e.selection.collapse(true)}else if(g){d("#wsTemp",e.getDoc()).closest("p").after("<p><br/></p>");e.plugins.wscommon.isNodeEmpty(d("#wsTemp",e.getDoc()).closest("p"))&&d("#wsTemp",e.getDoc()).closest("p").children().not("#wsTemp").length==
0&&d("#wsTemp",e.getDoc()).after("<br/>");e.selection.select(d("#wsTemp",e.getDoc()).closest("p").next("p").get(0),true);e.selection.collapse(true)}else if(h){d("#wsTemp",e.getDoc()).closest("p").before("<p><br/></p>");e.selection.select(d("#wsTemp",e.getDoc()).closest("p").get(0),true);e.selection.collapse(true)}d("#wsTemp",e.getDoc()).remove();e.undoManager.end();return false}}})},processContent:function(a){a=d("<div>",this.editor.getDoc()).html(a);this.convertDisplayBlockToDiv(a);this.convertBrToP(a);
return a.html()},convertDisplayBlockToDiv:function(a){var c=this.editor;d("span",a).each(function(e,b){e=d(b);if(e.css("display")=="block"||e.attr("style")&&e.attr("style").match(/text-align/i)&&(e.css("text-align")=="left"||e.css("text-align")=="right"||e.css("text-align")=="center"||e.css("text-align")=="justify")){e.css("display","");b=d("<div>",c.getDoc());b.attr("style",e.attr("style"));b.html(e.html());e.replaceWith(b)}})},convertBrToP:function(a){var c=this;this.splitOnBr(a);this.convertBrToPElements(a);
var e=d.browser.msie?"<BR>":"<br>\n";d(a).find("th,td").each(function(b,f){if(f.innerHTML==e)f.innerHTML="&nbsp;";else c.convertBrToPElements(d(f))})},splitOnBr:function(a){var c=this.editor;d(a).find("br").each(function(e,b){for(;!d(b).parent().is("td,th,li,pre,code,div,body");)c.dom.split(b.parentNode,b)})},convertBrToPElements:function(a){var c=this.editor,e=null;d(a).contents().each(function(b,f){if(f.nodeType==1&&f.nodeName.toLowerCase()=="br"){e||(e=d("<p>",c.getDoc()).insertBefore(f));e=null;
d(f).remove()}else if(f.nodeType==3||f.nodeType==1&&!c.dom.isBlock(f)){if(!e){if(f.nodeType==3&&c.plugins.wscommon.isTextEmpty(f.nodeValue))return;e=d("<p>",c.getDoc()).insertBefore(f)}e.append(f)}else if(f.nodeType==1&&c.dom.isBlock(f))e=null})}});k.PluginManager.add("wsbrtop",wikispaces.plugins.BrToP)})(tinymce,jQuery);
(function(k,d){k.create("static wikispaces.util.Cleanup",{cleanupEmptySpans:function(a){log("cleanupEmptySpans",a);for(var c=a.length-1;c>=0;c--){var e=d(a[c]);if(!(e.is(".commentBase")||e.is(".commentRef"))){var b=d.trim(e.text());if(e.parents("body").length>0&&(a[c].childNodes.length==0||a[c].childNodes.length==1&&a[c].childNodes[0].nodeType==3&&(b==""||b.charCodeAt(0)==8203)))e.replaceWith(e.text())}}},cleanupEmptyDivs:function(a){log("cleanupEmptyDivs",a);for(var c=a.length-1;c>=0;c--){var e=
d(a[c]),b=d.trim(e.text());if(e.parents("body").length>0&&(a[c].childNodes.length==0||a[c].childNodes.length==1&&a[c].childNodes[0].nodeType==3&&(b==""||b.charCodeAt(0)==8203)))e.replaceWith("<div> </div>")}},cleanupNoAttributeSpans:function(a){var c=this;log("cleanupNoAttributeSpans");d(a).find("span").each(function(){if(!(c.selectedSpans&&this==c.selectedSpans[0])){var e=d(this);!e.attr("style")&&!e.attr("class")&&e.replaceWith(e.contents())}});if(d(a).find(":last").is("span,div")||d(a).find(":last").is("br")&&
d(a).find(":last").prev().is("span,div"))d(a).append("&nbsp;")},getStyleArray:function(a){if(!a)return{};a=d(a).attr("style");if(!a)return{};return k.activeEditor.dom.parseStyle(a)},normalizeCssSelector:function(a){if(a==a.toUpperCase())a=a.toLowerCase();return WikispacesCommon.camelize(a)},mergeStyles:function(a,c){var e={};for(var b in a)if(typeof a[b]!="function")e[b]=a[b];for(b in c)if(typeof c[b]!="function")e[b]=this.mergeCss(a[b],b,c[b]);return e},collapseNodes:function(a){log("collapseNodes");
for(var c=Array(),e=a.length-1;e>=0;e--)if(d(a[e]).parents("body").length>0){var b=this.collapseNodeDown(a[e]);c[c.length]=b}return c},flattenNodes:function(a){log("flattenNodes",a);for(var c=a.length-1;c>=0;c--)for(var e=[d(a[c])],b;b=e.pop();){var f=b.parent();if(f.is(b.get(0).tagName)){log("flattening",b.get(0),b.html());var h=f.contents(),g=h.index(b);h=f.clone().empty().append(h.slice(g+1));d(f).after(h).after(b);g=this.mergeStyles(this.getStyleArray(f.get(0)),this.getStyleArray(b.get(0)));for(var l in g)if(typeof g[l]!=
"function")try{b.css(l,g[l])}catch(o){}d.trim(f.html())==""&&f.remove();d.trim(h.html())==""?h.remove():e.push(h);e.push(b)}}},collapseNodeDown:function(a){for(;d(a).parent().is(d(a).get(0).tagName)&&d(a).parent().attr("class")==d(a).attr("class")&&d(a).parent().children().length==1;){for(var c=true,e=0;e<a.parentNode.childNodes.length;e++)if(a.parentNode.childNodes[e].nodeType==3&&!d.trim(a.parentNode.childNodes[e].nodeValue)==""){c=false;break}if(!c)break;a=a.parentNode}for(var b="",f="",h=this.getStyleArray(a),
g=a;d(g).children().length==1&&d(g).children().eq(0).is(g.tagName)&&d(g).attr("class")==d(g).children().eq(0).attr("class");){var l=true;c=true;for(e=0;e<g.childNodes.length;e++)if(g.childNodes[e].nodeType==1)l=false;else if(g.childNodes[e].nodeType==3&&d.trim(g.childNodes[e].nodeValue)=="")if(l)b+=g.childNodes[e].nodeValue;else f+=g.childNodes[e].nodeValue;else{c=false;break}if(!c)break;g=d(g).children().get(0);h=this.mergeStyles(h,this.getStyleArray(g))}if(g&&g!=a){d(g).prepend(b);d(g).append(f);
c=d(g).html();d(a).empty();d(a).html(c);for(var o in h)if(typeof h[o]!="function")try{d(a).css(o,h[o])}catch(p){}}return a},mergeNodes:function(a){log("mergeNodes",a);if(!(!a||a.length==0)){for(var c=this.editorDocument,e=a[0].tagName,b=true;b;){b=false;d(c.body).find(e+" + br").each(function(){if(this.previousSibling.nodeType==1){b=true;d(this).prev().append("<br/>");d(this).remove()}})}d(c.body).find(e).each(function(){var h=this.nextSibling;if(h&&h.nodeType==3&&d.trim(h.nodeValue)==""&&h.nextSibling&&
h.nextSibling.nodeType==1&&h.nextSibling.tagName==e.toUpperCase()&&d(h.nextSibling).attr("style")==d(this).attr("style")&&d(h.nextSibling).attr("class")==d(this).attr("class")){d(this).append(h.nodeValue);h.parentNode.removeChild(h)}});for(var f=a.length-1;f>=0;f--)d(a[f]).parents("body").length>0&&this.mergeNode(a[f]);for(b=true;b;){b=false;d(c.body).find(e+" br:last-child").each(function(){if(!this.nextSibling){b=true;d(this).parent().after("<br/>");d(this).remove()}})}log("end mergeNodes",a)}},
mergeNode:function(a){var c=d(a);if(a.previousSibling&&a.previousSibling.tagName==a.tagName&&c.prev().attr("class")==c.attr("class")&&c.prev().attr("style")==c.attr("style")){a=c.prev();a.html(a.html()+c.html());c.remove()}},mergeCss:function(a,c,e){if(!a||c!="fontSize")return e;c=a.substr(0,a.length-2);var b=a.substr(a.length-2,2);if(b[1]=="%"){b="%";c=a.substr(0,a.length-1)}a=e.substr(e.length-2,2);var f=e.substr(0,e.length-2);if(a[1]=="%"){a="%";f=e.substr(0,e.length-1)}if(a=="em"||a=="ex"){a=
"%";f*=100}if(b=="em"||b=="ex"){b="%";c*=100}return a=="%"?Math.round(c*f*100)/1E4+b:e},removeBrInTable:function(a){d(a).find("td br:last-child, th br:last-child").remove()},removeSafariSpans:function(a){log("removeSafariSpans");d("span.wkzw",a).remove();d("span",a).removeClass("Apple-tab-span Apple-style-span");this.cleanupNoAttributeSpans(a)},removeMsoStyles:function(a){var c=this;d(a).each(function(){var e=c.getStyleArray(this),b=false;for(var f in e)if(typeof e[f]=="function")delete e[f];else if(f.indexOf("mso")==
0){delete e[f];b=true}if(b)try{var h=d("<"+d(this)[0].tagName+">",this.ownerDocument).attr("class",d(this).attr("class")).html(d(this).html()).attr("id",d(this).attr("id")).css(e);d(this).replaceWith(h)}catch(g){}})},actionableSpans:function(a){return d(a).find("span")},actionableDivs:function(a){return d(a).find("div")},cleanup:function(a,c,e){var b=this;log("cleanup",c);if(c!="none"){var f=[];if(c)f=c.split(",");if(f.length>0){this.editorDocument=a.getDoc();var h=this.editorDocument.body;a=null;
if(e)a=k.mainEditor.plugins.wspopup.show("cleanupPopupContents");d.each(f,function(g,l){switch(l){case "safari":b.removeSafariSpans(h);return;case "mso":b.removeMsoStyles(b.actionableSpans(h));return;case "collapse":b.collapseNodes(b.actionableSpans(h));return;case "merge":b.mergeNodes(b.actionableSpans(h));return;case "flatten":b.flattenNodes(b.actionableSpans(h));return;case "empty":b.cleanupEmptySpans(b.actionableSpans(h));b.cleanupEmptyDivs(b.actionableDivs(h));return;case "bookmarks":d(h).find("span[_mce_type='bookmark']").remove();
return;case "trailingLinebreaks":d(h).find("p > br:last-child, div > br:last-child").remove();return;case "brTable":b.removeBrInTable(h);return;case "relativeFiles":d(h).find("img").each(function(){if(d(this).attr("src").match(/^file\/view/))d(this).attr("src","/"+d(this).attr("src"));else d(this).attr("src").match(/^\.\.\/\.\.\/file\/view/)&&d(this).attr("src",d(this).attr("src").slice(5))});return}});a&&a.close()}}}});k.PluginManager.add("wscleanup",wikispaces.util.Cleanup)})(tinymce,jQuery);
(function(k){k.create("wikispaces.popups.Cleanup",{init:function(d){d.plugins.wspopup.register({wsname:"cleanupPopupContents",title:"Optimize Page",width:340,height:200})}});k.PluginManager.add("wscleanuppopup",wikispaces.popups.Cleanup)})(tinymce);
(function(k,d){k.create("wikispaces.plugins.CommentPlugin",{popup:null,init:function(a){this.editor=a;WikispacesCommentManager.clear();WikispacesCommentManager.readOnly=false;a.addButton("wscomment",{title:"Add Comment",onclick:function(){k.activeEditor.wsExecCommand("wsComment")}});a.onInit.add(function(){_.defer(function(){WikispacesCommentManager.showAll()});_.delay(function(){WikispacesCommentManager.redrawAll()},1E3);_.delay(function(){WikispacesCommentManager.redrawAll()},3E3)});a.onModeSwitch.add(function(c){if(c==
"visual")_.defer(function(){WikispacesCommentManager.showAll()});else c=="plain"&&WikispacesCommentManager.hideAll()})},getInfo:function(){return{longname:"Wikispaces comment",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},isAutoSaveComments:function(a){return _(a).any(function(c){return _.isString(c)})},loadComments:function(a){this.isAutoSaveComments(a)?WikispacesCommentManager.retrieveData(function(){_(a).each(function(c,e){var b=WikispacesCommentManager.commentById(e);
if(b){var f=new WikispacesCommentReply(c);b.addReply(f);_.defer(function(){f.compose()})}else{b=new WikispacesComment(c,e);WikispacesCommentManager.addComment(b);_.defer(function(){b.compose()})}})}):WikispacesCommentManager.load(a)},newComments:function(){var a={};d(WikispacesCommentManager.flatComments()).each(function(){if(this.unsaved())a[this.commentId]=this.body()});return a},markCommentsSaved:function(){WikispacesCommentManager.markCommentsSaved()}});k.PluginManager.add("wscomment",wikispaces.plugins.CommentPlugin)})(tinymce,
jQuery);
(function(k,d){k.create("wikispaces.plugins.CommentSpacePlugin",{popup:null,MINIMUM_REDISCOVER_MILLISECONDS:600,init:function(a){this.editor=a;var c=this;this.commentSpace=null;this.commentsDisabled=!!d("input[name=commentsDisabled]").val();a.onInit.add(function(){d(".mceIframeContainer iframe").css("background-color","transparent").attr("allowTransparency",true);c.commentSpace=new WikispacesCommentSpace(a.getBody(),a.getContainer(),a.getContainer(),d(a.getContainer()).find(".mceIframeContainer"),a);
WikispacesCommentManager.drawAll()});a.onSetContent.add(function(){var f=d("a.range[name^=comment-]:last",a.getBody());if(f.size()>0&&f.next().size()==0&&(f.parent().is("body")||f.parent().next().size()==0))d(a.getBody()).append("<p><br/></p>")});a.onRemove.add(function(){if(c.comments){c.commentSpace.remove();c.commentSpace=null}});a.onNodeChange.add(function(f){var h=f.wsselection&&f.wsselection.withinCode();f.theme.controlManager().setDisabled("wscomment",c.commentsDisabled||!wikispaces_can_discuss||
h||f.selection.isCollapsed());var g="Add Comment";if(c.commentsDisabled)g="Comments are disabled for this page";else if(wikispaces_can_discuss)if(h)g="Comments aren't allowed in code sections";else{if(f.selection.isCollapsed())g="Make a selection before commenting"}else g="You don't have permission to add comments";d("#wsMainEditor_wscomment").attr("title",g)});a.addCommand("wsComment",function(){function f(p){return p?(p.nodeType==1?d(p).text():p.nodeValue||"")+f(p.nextSibling):""}var h=new WikispacesComment;
a.wsselection.normalizeOutsideLinks();var g=a.selection.getRng(true).cloneRange(),l=a.selection.getRng(true).cloneRange();g.collapse(true);l.collapse(false);var o=a.getDoc().createTextNode("\u00a0");l.insertNode(o);d.trim(f(o.nextSibling))&&o.parentNode.removeChild(o);o=h.generateCloser(a.getDoc());l.insertNode(o);l=h.generateOpener(a.getDoc());g.insertNode(l);if(k.isIE){o=d(o);!o.parent().is("p")&&o.prev().is("p")&&o.appendTo(o.prev());if(d.browser.version<=8){a.dom.setOuterHTML(l,a.dom.createHTML("a",
{name:h.openAnchorName(),"class":"range"},""));a.dom.setOuterHTML(o,a.dom.createHTML("a",{name:h.closeAnchorName(),"class":"range"},""))}}WikispacesCommentManager.addComment(h);h.compose();d.scrollTo(h.div,{offset:-70});a.selection.collapse()});var e=0,b=function(f){var h=(new Date).getTime();if(h-e<c.MINIMUM_REDISCOVER_MILLISECONDS)setTimeout(function(){if(e<h){e=(new Date).getTime();WikispacesCommentManager.redrawAll(f)}},c.MINIMUM_REDISCOVER_MILLISECONDS);else{e=h;WikispacesCommentManager.redrawAll(f)}};
a.onChange.add(function(){setTimeout(b,0)});a.onUndo.add(function(){b(true)});a.onRedo.add(function(){b(true)});a.onKeyUp.add(b)},getInfo:function(){return{longname:"Wikispaces comment space",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},loadComments:function(a){WikispacesCommentManager.load(a)}});k.PluginManager.add("wscommentspace",wikispaces.plugins.CommentSpacePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.CommonPlugin",{init:function(a){var c=this;this.editor=a;a.onLoadContent.add(function(b){c.startingSpanCount=d(b.getDoc()).find("span").length});if(a.plugins.paste){a.plugins.paste.onPreProcess.add(function(b,f){f.content=f.content.replace(/<\/?pre>/ig,"")});var e=["font-family","font-size","background-color","text-align","vertical-align","text-decoration","color"];a.plugins.paste.onPostProcess.add(function(b,f){d("*",f.node).each(function(){var h=d(this);
if(h.attr("style")){var g={};d.each(e,function(l,o){if(h.attr("style").match(new RegExp("\\b"+o+"\\b","i")))g[o]=h.css(o)});h.attr("style","");h.css(g)}});wikispaces.util.Cleanup.collapseNodes(d("span",f.node));wikispaces.util.Cleanup.flattenNodes(d("span",f.node))})}},getInfo:function(){return{longname:"Wikispaces common",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},fullContent:function(a,c){if(WikispacesEditor.getMode()=="visual"){try{var e=
c?c.split(","):[];e.push("mso");e.push("merge");e.push("relativeFiles");d(this.editor.getDoc()).find("span").length!=this.startingSpanCount&&e.push("collapse");k.isWebKit&&e.push("safari");wikispaces.util.Cleanup.cleanup(this.editor,e.join(","),a);this.startingSpanCount=d(this.editor.getDoc()).find("span").length}catch(b){}return this.editor.plugins.wsreference.pushInReferences(this.editor.getContent({format:"raw"}))}else return d("#textEditor").val()},editorIFrame:function(){return document.getElementById(this.editor.id+
"_ifr")},editorToolbar:function(){return document.getElementById(this.editor.id+"_external")},editorContainer:function(){return document.getElementById(this.editor.id+"_container")},sessionReloadFailed:function(){var a=k.mainEditor;this.reloadFailed=true;a.plugins.wsautosave.autosaveEnabled=false;a.plugins.wsautosave.setStatus("Autosave Disabled",true);a.controlManager.setDisabled("wspreview",true);a.controlManager.setDisabled("wsimage",true);a.plugins.wslinkpopup.disableSelect();alert("Your connection to Wikispaces has been disrupted.  We recommend you save your page now, and try editing the page again.")},
getIframeInParentWindow:function(a){a=a.ownerDocument;var c=a.parentWindow;if(!c)c=a.defaultView;if(!c)return null;if(c.parent==c)return null;return c.frameElement},absoluteOffset:function(a){for(var c=0,e=0;a;){if(a.tagName.toUpperCase()=="BODY"){a=this.getIframeInParentWindow(a);if(!a)break}c+=a.offsetTop||0;e+=a.offsetLeft||0;a=a.offsetParent}return{left:e,top:c}},getPositionWith:function(a,c,e){c=d(c);a=d(a);var b=this.absoluteOffset(c[0]),f=this.absoluteOffset(a[0].offsetParent),h=b.left+c.outerWidth({margin:true})-
f.left;c=b.top+c.outerHeight({margin:true})-f.top;if(e){c+=e;h+=e}a=a.outerWidth({margin:true});e=d(this.editor.getContentAreaContainer()).offset().left;b=d("body").width();if(h+e+a>b)h=b-a-e;if(c<0)c=0;if(h<0)h=0;return{left:h,top:c}},positionBelow:function(a,c){c=d(c);a=d(a);var e=this.absoluteOffset(c[0]),b=d(window).scrollLeft(),f=d(window).scrollTop(),h=e.left+2;c=e.top+c.outerHeight({margin:true})+4;e=a.outerWidth({margin:true});var g=d(window).width()+b;if(h+e>g)h=g-e;e=a.outerHeight({margin:true});
g=d(window).height()+f;if(c+e>g)c=g-e;if(c<f)c=f;if(h<b)h=b;a=this.absoluteOffset(a[0].offsetParent);return{left:h-a.left,top:c-a.top}},scrollToElement:function(a){a=d(a);var c=this.absoluteOffset(a[0]).top;a=a.outerHeight({margin:true});var e=c+a,b=document.body.scrollTop;if(b==0)if(window.pageYOffset)b=window.pageYOffset;else if(document.body.parentElement)b=document.body.parentElement.scrollTop;else widowTop=0;var f=d(window).height(),h=b+f,g=c-(b+50);if(g<0||f-50<a&&c>b+50)d(window).scrollTo({top:"+="+
(g-30)+"px",left:"+=0px"});else{c=e-h;c>0&&d(window).scrollTo({top:"+="+(c+150)+"px",left:"+=0px"})}},cursorToAndRemoveElement:function(a){a=d(a);if(a.length){this.editor.selection.select(a[0],true);this.editor.selection.collapse(true);this.editor.focus();this.scrollToElement(a);a.remove();this.editor.nodeChanged()}},getSiblingOfElement:function(a,c){if(!a)return null;c||(c="next");for(a=a[c+"Sibling"];a&&a.nodeType==3&&a.nodeValue=="";)a=a[c+"Sibling"];return a},disableUntilLibsLoad:function(a,c){a.onInit.add(function(){if(!WikispacesContent.isLoaded){a.theme.controlManager().setDisabled(c,
true);WikispacesContent.add(function(){a.theme.controlManager().setDisabled(c,false)})}})},isNodeEmpty:function(a){return this.isTextEmpty(d(a).text())},isTextEmpty:function(a){a=a.replace(/\uFEFF/g,"");a=d.trim(a);return a.length==0},areNodesAdjacent:function(a,c){for(;a&&a!=c;){if(a.nodeType==1)return false;if(!this.isTextEmpty(a))return false}if(a==c)return true;return false},isCommentEditor:function(){return d(this.editor.getContainer()).parent().is(".commentEditor")}});k.PluginManager.add("wscommon",
wikispaces.plugins.CommonPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.ConcurrentEditor",{editor:null,init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"concurrentEditor",title:"Page Activity",width:300,height:100,uiSetup:function(e){c.uiSetup(e)}})},uiSetup:function(a){d("#concurrentEditorClose").click(function(c){a.close();c.preventDefault();return false})}});k.PluginManager.add("wsconcurrenteditorpopup",wikispaces.popups.ConcurrentEditor)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.DraftRecovered",{editor:null,init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"draftRecovered",title:"Draft Recovered",width:450,height:200,uiSetup:function(e){c.uiSetup(e)}})},uiSetup:function(a){var c=this.editor,e=c.plugins.wsautoload;d("#recoverDraft").click(function(b){WikispacesCommon.track("Editor","Autosave","Load");e.loadVersion(e.autosaveContent,e.autosavePageComments,e.autosaveVersion,e.autosaveCleanup);a.close();c.undoManager.clear();
c.plugins.wsautosave.autosave(false,e.autosaveContent);b.preventDefault();return false});d("#discardDraft").click(function(b){WikispacesCommon.track("Editor","Autosave","Discard");a.close();var f="/page/discardautosave/"+encodeURIComponent(wikispaces_page);d.ajax({url:f,xhr:WikispacesCommon.jQueryAjaxFix,type:"GET",cache:false,global:false});b.preventDefault();return false})}});k.PluginManager.add("wsdraftrecoveredpopup",wikispaces.popups.DraftRecovered)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.ExpiredDraft",{editor:null,init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"expiredDraft",title:"Expired Draft Recovered",width:600,height:350,uiSetup:function(e){c.uiSetup(e)}})},uiSetup:function(a){d("#expireDraft").click(function(c){WikispacesCommon.track("Editor","Autosave","Forced Discard");a.close();var e="/page/discardautosave/"+encodeURIComponent(wikispaces_page);d.ajax({url:e,xhr:WikispacesCommon.jQueryAjaxFix,type:"GET",
cache:false,global:false});c.preventDefault();return false})}});k.PluginManager.add("wsexpireddraftpopup",wikispaces.popups.ExpiredDraft)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.ImagePlugin",{"static":{newImageIdCounter:1},init:function(a){var c=this;a.addCommand("wsimage",function(){k.mainEditor.plugins.wspopup.show("imageTool",{plugin:c})});a.addButton("wsimage",{title:"Insert Images and Files",label:"File",onclick:function(){k.activeEditor.wsExecCommand("wsimage");WikispacesCommon.track("Editor","Open Image Tool")}});a.onNodeChange.add(function(e,b,f){if(WikispacesEditor.getMode()!="visual")e.theme.controlManager().setActive("wsimage",
false);else{b=c.isFilePlaceholder(f);e.theme.controlManager().setActive("wsimage",b);b?k.mainEditor.plugins.wsimageoverlay.show(e,f):k.mainEditor.plugins.wsimageoverlay.hide()}});a.onSetContent.add(function(e){d('img[src*="embedthumbnail/placeholder"]',e.getBody()).addClass("missing")});a.onClick.add(function(e,b){if(d(b.target).is("img.missing")){e.selection.select(b.target);k.mainEditor.plugins.wspopup.show("imageTool",{plugin:c})}});a.plugins.paste.onPostProcess.add(function(e,b){d("img",b.node).each(function(){var f=
d(this);if(!f.attr("src").match(/https?:\/\//)){var h=Math.max(f.attr("width"),200),g=Math.max(f.attr("height"),50);f.attr("src",window.location.protocol+"//"+window.location.host+"/site/embedthumbnail/placeholder?w="+h+"&h="+g).attr("width",h).attr("height",g).addClass("missing")}})});k.isGecko&&a.onInit.add(function(){a.dom.bind(a.getBody(),"drop",function(){setTimeout(function(){d("img",a.getDoc()).each(function(){d(this).attr("alt",d(this).attr("alt").replace(/\n/g,""))})},0)})});a.plugins.wscommon.disableUntilLibsLoad(a,
"wsimage")},getInfo:function(){return{longname:"Wikispaces image",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},isFilePlaceholder:function(a){return a.nodeName=="IMG"&&!d(a).hasClass("missing")&&!d(a).hasClass("WikiMedia")&&!d(a).hasClass("WikiReference")&&!d(a).hasClass("WikiAnchor")||d(a).hasClass("WikiMediaFile")},insertImageInEditor:function(a,c){var e=this;if(c=="image"){WikispacesCommon.track("Editor","Add Image",a);var b;b=a.substring(0,
7)=="http://"||a.substring(0,8)=="https://"||a.substring(0,6)=="ftp://"?a:"/file/view/"+encodeURIComponent(a);var f=d("<img>").attr("src",b).hide().appendTo(d("body"));f.load(function(){e.insertImageInEditorCallback(a,c,f)});f.get(0).src=f.get(0).src}else{WikispacesCommon.track("Editor","Add File",a);this.insertImageInEditorCallback(a,c,null)}},insertImageInEditorCallback:function(a,c,e){var b=k.activeEditor;if("embed"!=document.forms.imageToolForm.insertMode.value){e='<a href="http://'+window.location.hostname+
"/file/view/"+encodeURIComponent(a)+'">'+a+"</a>";b.wsselection.setContent(e)}else{var f="newImage-"+wikispaces.plugins.ImagePlugin.newImageIdCounter++,h=f;if(c=="image"){c="";if(e.width()>800)c=' width="800" height="'+Math.floor(800/e.width()*e.height())+'"';e=a.substring(0,7)=="http://"||a.substring(0,8)=="https://"||a.substring(0,6)=="ftp://"?'<img id="'+f+'" src="'+a+'"'+c+"/>":'<img id="'+f+'" src="/file/view/'+encodeURIComponent(a)+'"'+c+"/>";a=k.mainEditor.plugins.wsimageoverlay}else{if(c==
"audio"){h='wikitext@@media@@type="file" key="'+a+'"';e=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e='<img src="'+window.location.protocol+"//www."+wikispaces_domain+"/site/embedthumbnail/file-audio/"+encodeURIComponent(a)+'?h=20&w=240" class="WikiMedia WikiMediaFile" id="'+f+'" title="Audio Player: '+e+'" />'}else if(c=="video"){h='wikitext@@media@@type="file" key="'+a+'"';e=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e='<img src="'+window.location.protocol+
"//www."+wikispaces_domain+"/site/embedthumbnail/file-video/"+encodeURIComponent(a)+'?h=300&w=300" class="WikiMedia WikiMediaFile" id="'+f+'" title="Video Player: '+e+'" />'}else{h="wikitext@@file@@"+a;e=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");e='<img src="'+window.location.protocol+"//www."+wikispaces_domain+"/site/embedthumbnail/file/"+encodeURIComponent(a)+'?h=40&w=200" class="WikiFile" id="'+f+'" title="File: '+e+'" />'}a=k.mainEditor.plugins.wswidgetoverlay}b.wsselection.setContent(e);
f=d("#"+f,b.getBody()).attr("id",h).get(0);b.wsselection.updateBookmarkToNode(f);b.wsselection.restore();a.show(b,f)}}});k.PluginManager.add("wsimage",wikispaces.plugins.ImagePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.ImageOverlay",{init:function(a,c){var e=this;a.onInit.add(function(b){var f=function(h){h.onClick.add(function(g,l){g.plugins.wsimage.isFilePlaceholder(l.target)?e.show(g,l.target):e.hide()})};b.onInitSubEditor.add(f);f(b)});this.overlayInit(a,c)},overlayInit:function(a){var c=this;a.onModeSwitch.add(function(e){e=="plain"&&c.hide()});a.onKeyDown.add(function(e,b){if(c.img&&(b.keyCode==8||b.keyCode==46)){c.removeImage();return false}});d(window).resize(function(){c.img&&
d(c.img).is(":visible")&&c.repositionAndShow()})},getInfo:function(){return{longname:"Wikispaces image overlay",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},overlayContent:function(){return WikispacesContent.loadContent("imageProperties")},show:function(a,c){var e=this;this.editor=a;if(this.img!=c){this.img=c;if(this.overlay==null){this.overlay=d("<div>").addClass("WikiOverlay overlayLayer").css({position:"absolute"}).html(this.overlayContent()).hide().appendTo("#pageEditor");
this.setup()}k.mainEditor.plugins.wstableoverlay.unselectTableCell();this.refreshLinkStatus(true);this.refreshAlignment();this.setCaption(d(this.img).attr("alt"),true);d(this.img).hasClass("WikiMediaFile")||d(this.img).hasClass("WikiFile")?d("#imageAttributes").hide():d("#imageAttributes").show();d(this.img).hasClass("WikiFile")?d("#imageAppearance").hide():d("#imageAppearance").show();d(this.img).height()>0?this.toggleFitImage():d(this.img).load(function(){e.toggleFitImage(c)});this.repositionAndShow()}},
hide:function(){d(this.img).closest("td,th").length&&k.mainEditor.plugins.wstableoverlay.selectTableCell(d(this.img).closest("td,th").get(0));this.img=null;this.overlay&&this.overlay.hide()},repositionAndShow:function(){this.overlay.css({left:"-10000px",top:"-10000px"}).show();this.overlay.css(this.editor.plugins.wscommon.positionBelow(this.overlay,this.img))},refreshLinkStatus:function(a){if(this.img!=null)this.findParentLinkElement(this.img)?this.setImageLink(this.findParentLinkElement(this.img).href,
a):this.unsetImageLink(a)},currentAlignment:function(){if(this.img==null)return null;var a=d(this.img).parent("div");return a.length&&a.css("text-align")=="center"?"center":d(this.img).attr("align")},refreshAlignment:function(){d("#imageAlign a").removeClass("buttonSelected");switch(this.currentAlignment()){case "left":d("#imageAlignLeft").addClass("buttonSelected");break;case "center":d("#imageAlignCenter").addClass("buttonSelected");break;case "right":d("#imageAlignRight").addClass("buttonSelected");
break}},setCaption:function(a,c){d("#captionText").html(WikispacesCommon.truncify(a,80));d("#imageCaptionInput").val(a);d(this.img).attr("alt",a);d("#captionEditor").hide();d("#existingCaption").show();if(a){d("#addImageCaption").hide();d("#imageCaptionControls").show()}else{d("#addImageCaption").show();d("#imageCaptionControls").hide()}c||this.repositionAndShow()},editCaption:function(){d("#imageCaptionControls").show();d("#existingCaption").hide();d("#captionEditor").show();d("#imageCaptionInput").focus()},
setup:function(){var a=this;d("#imageAlignLeft").click(function(){a.setImageAlignment("left");return false});d("#imageAlignCenter").click(function(){a.setImageAlignment("center");return false});d("#imageAlignRight").click(function(){a.setImageAlignment("right");return false});d("#imageAlignNone").click(function(){a.setImageAlignment("");return false});d("#imageSizeDown").click(function(){a.adjustImageSize(-0.1);return false});d("#imageSizeUp").click(function(){a.adjustImageSize(0.1);return false});
d("#imageSizeOriginal").click(function(){a.adjustImageSize(0,true);return false});d("#imageSizeFit").click(function(){a.adjustImageSize(0,false,true);return false});d("#addImageCaption, #editCaption").click(function(){a.editCaption();return false});d("#saveImageCaption").click(function(){a.setCaption(d("#imageCaptionInput").val());return false});d("#cancelCaption").click(function(){a.setCaption(d(a.img).attr("alt"));return false});d("#removeCaption").click(function(){a.setCaption(null);return false});
d("#addImageLink, #editImageLink").click(function(){a.editor.selection.select(a.img);a.editor.execCommand("wslink");return false});d("#removeImageLink").click(function(){d(a.img).parent("a").replaceWith(d(a.img).parent("a").contents());a.unsetImageLink();a.editor.wsselection.updateBookmarkToNode(a.img);return false});d("#visitImageLink").click(function(){window.open(d(a.img).parent("a").attr("href"));return false});d("#imageRemoveLink").click(function(){a.removeImage();return false})},removeImage:function(){this.editor.undoManager.begin();
var a=d(this.img);if(this.findCenteringElement(this.img))a=d(this.findCenteringElement(this.img));else if(this.findParentLinkElement(this.img))a=d(this.findParentLinkElement(this.img));var c=d("<span>",this.editor.getDoc()).insertBefore(a);a.remove();this.editor.plugins.wscommon.cursorToAndRemoveElement(c);this.editor.undoManager.end();this.hide()},toggleFitImage:function(){d(this.img).width()>800?d("#imageSizeFit").show():d("#imageSizeFit").hide()},setImageLink:function(a,c){d("#imageLinkText").html(WikispacesCommon.truncify(a,
60)).attr("title",a);d("#imageLinkControls").show();d("#addImageLink").hide();c||this.repositionAndShow()},unsetImageLink:function(a){d("#imageLinkControls").hide();d("#addImageLink").show();a||this.repositionAndShow()},updateImageCaption:function(a,c){d(this.img).attr("alt",a);c||this.repositionAndShow()},setImageAlignment:function(a,c){if(a=="center")if(this.findCenteringElement(this.img))return;else{this.img.align="";a=d("<div>",this.img.ownerDocument).css("text-align","center");var e=d(this.img);
if(e.parent().is("a"))e=e.parent();e.replaceWith(a).appendTo(a)}else{(e=this.findCenteringElement(this.img))&&d(e).replaceWith(e.childNodes);this.img.align=a}this.refreshAlignment();c||this.repositionAndShow()},findCenteringElement:function(a){for(;a;){if(a.tagName&&(a.tagName.toUpperCase()=="CENTER"||a.tagName.toUpperCase()=="DIV"&&(a.style.textAlign=="center"||a.align=="center")))return a;if(a.parentNode)a=a.parentNode;else return null}return null},findParentLinkElement:function(a){return d(a).parent("a[href]").get(0)},
adjustImageSize:function(a,c,e){var b=this,f=d(this.img);if(this.starting_width&&this.starting_height)this.adjustImageSizeCallback(a,c,e);else if(f.width()>0&&f.height()>0){this.starting_width=f.width();this.starting_height=f.height();this.adjustImageSizeCallback(a,c,e)}else f.load(function(){this.starting_width=f.width();this.starting_height=f.height();b.adjustImageSizeCallback(a,c,e)})},adjustImageSizeCallback:function(a,c,e){var b=d(this.img);if(c){b.css("height","").removeAttr("height").css("width",
"").removeAttr("width");this.repositionAndShow()}else{var f,h;if(e)if(this.starting_width>800){h=800;f=Math.round(800/this.starting_width*this.starting_height)}else{h=this.starting_width;f=this.starting_height}else if(a!=0){f=b.height()/this.starting_height;c=b.width()/this.starting_width;f=Math.floor(this.starting_height*(f+a));h=Math.floor(this.starting_width*(c+a))}if(f>0&&h>0&&f>=Math.floor(this.starting_height*0.05)&&h>=Math.floor(this.starting_width*0.05)){b.height(f);b.width(h)}this.repositionAndShow();
this.toggleFitImage();this.editor.plugins.autoresize&&this.editor.plugins.autoresize.fitEditor();this.editor.onNeedsResize&&this.editor.onNeedsResize.dispatch()}}});k.PluginManager.add("wsimageoverlay",wikispaces.plugins.ImageOverlay)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.Image",{MAX_PER_ROW:8,MAX_ROWS:8,PER_PAGE:6,IMAGE_SIZE:32,externalPosition:0,currentMode:"all",newUploads:[],swfu:null,plugin:null,editor:null,tagFilter:null,init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"imageTool",title:"Images and Files",width:600,height:465,wsselection:0,onShow:function(e){c.onShow(e)},uiSetup:function(e){c.uiSetup(e)}})},onShow:function(a){this.showPage(1);this.setPlugin(a.plugin)},setPlugin:function(a){this.plugin=
a},addPage:function(a){var c=this,e=document.createElement("a");e.href="#";d(e).click(function(){WikispacesCommon.track("Editor","Show File Page",a);c.showPage(a);return false});d(e).html(a);d(e).addClass("pageNumber");d("#imagePages").append(e).append("&nbsp;")},showPage:function(a){var c=this;this.showFileSpinner();var e=(a-1)*this.PER_PAGE,b=this.PER_PAGE,f="";if(document.imageToolForm.filename.value!=document.imageToolForm.filename.title)f=document.imageToolForm.filename.value;var h=function(){WikispacesSession.reloadSession(function(){c.showPage(a)},
3E3,function(){k.activeEditor.plugins.wscommon.sessionReloadFailed()})};d.ajaxq("imageList");d.ajaxq("imageList",{url:"/file/listjson/"+encodeURIComponent(this.currentMode),xhr:WikispacesCommon.jQueryAjaxFix,type:"GET",cache:false,data:{offset:e,pageLimit:b,filename:f,tag:this.tagFilter.getTags()},dataType:"json",global:false,error:h,success:function(g,l,o){if(o.status==0)return h.call(this,o,l,null);WikispacesSession.reloadSessionSuccess();c.loadFileData(g);c.editor.plugins.wspopup.resize("imageTool")}})},
showFileSpinner:function(){d("#filenameAutocomplete").css("background","white url('/i/spinner.gif') no-repeat center right")},hideFileSpinner:function(){d("#filenameAutocomplete").css("background-image","none")},setListMode:function(a){d(document.forms.imageToolForm.listMode).val(a);this.currentMode=a;this.tagFilter.setMode(a);this.showPage(1);this.tagFilter.showPage(1)},getCell:function(a,c){return d("#"+a+" tr").eq(Math.floor(c/this.MAX_PER_ROW)).find("td").get(c%this.MAX_PER_ROW)},addRow:function(a){var c=
document.createElement("tr");for(j=0;j<this.MAX_PER_ROW;j++)c.appendChild(document.createElement("td"));d("#"+a).append(c)},addFileRow:function(a,c,e,b,f,h){var g=this,l,o=c;if(e=="image"||this.isImage(e)){l="image";if(f)o=f}else l=this.isAudio(e)?"audio":this.isVideo(e)?"video":"file";li1=d("<li>").attr("title",c).addClass("active");h||li1.click(function(){g.plugin.insertImageInEditor(o,l);g.editor.plugins.wspopup.hide("imageTool")});a=document.createElement("img");if(l=="image"&&f){a.src=f;if(a.height>
a.width){a.width=a.width/a.height*g.IMAGE_SIZE;a.height=g.IMAGE_SIZE}else{a.height=a.height/a.width*g.IMAGE_SIZE;a.width=g.IMAGE_SIZE}}else{a.src="/file/thumbnail/"+encodeURIComponent(c)+"?size="+g.IMAGE_SIZE+(h?"&rnd="+Math.random():"");a.width=g.IMAGE_SIZE;a.height=g.IMAGE_SIZE}d(li1).append(a).append(d('<div class="fileName">').text(WikispacesCommon.truncify(c,40)));c=k.mainEditor.getParam("wsimage_page_view_group");WikispacesCommon.compareGroupPermissionValues(b,c)==1&&d('<img src="/i/icon_16_hidden.png"/>').css({"float":"right",
"padding-top":6}).attr("title","This file has more restrictive permissions than this page. Some users may not be able to see it.").attr("alt","This file has more restrictive permissions than this page. Some users may not be able to see it.").appendTo(li1);d(".fileList ul").append(li1);return li1},addFileCell:function(a,c,e,b,f,h){var g=this,l=a+"-file-"+b,o=this.getCell(a,b);if(!o){this.addRow(a);o=this.getCell(a,b)}var p,m=c;if(e=="image"||this.isImage(e)){p="image";if(f)m=f}else p=this.isAudio(e)?
"audio":this.isVideo(e)?"video":"file";a=document.createElement("td");a.style.textAlign="center";a.style.padding="5px;";a.title=c;d(a).dblclick(function(){g.plugin.insertImageInEditor(m,p);g.editor.plugins.wspopup.hide("imageTool")});h||(h=document.createElement("img"));if(p=="image"&&f){h.src=f;if(h.height>h.width){h.width=h.width/h.height*g.IMAGE_SIZE;h.height=g.IMAGE_SIZE}else{h.height=h.height/h.width*g.IMAGE_SIZE;h.width=g.IMAGE_SIZE}}else{h.src="/file/thumbnail/"+encodeURIComponent(c)+"?size="+
g.IMAGE_SIZE;h.width=g.IMAGE_SIZE;h.height=g.IMAGE_SIZE}h.onmousedown=function(){return false};f=document.createElement("div");f.className="WikiUploadFileEditor";f.appendChild(h);a.appendChild(f);c=d("<span>").attr("id",l).text(WikispacesCommon.truncate(c,13));d(f).append("<br/>").append(c);o.parentNode.replaceChild(a,o)},resetPages:function(){var a=this;d("#imagePages").empty();var c=1,e=this.pageCount;if(this.pageCount>7){c=this.currentPage-1;if(c<1)c=1;e=c+1;if(e>this.pageCount)e=this.pageCount}for(var b=
1+e-c+(e==this.pageCount?0:1)+(c==1?0:1),f=0;b<7&&(c!=1||e!=this.pageCount);){if(f%2){c--;if(c<1)c=1}else{e++;if(e>this.pageCount)e=this.pageCount}f++;b=1+e-c+(e==this.pageCount?0:1)+(c==1?0:1)}if(this.pageCount>1){if(this.currentPage==1)d("#imagePages").append('<span class="pageFirst inactive">&laquo; Previous</span>');else{b=d('<a href="#" class="pageFirst">&laquo; Previous</a>').click(function(){a.showPage(a.currentPage-1)});d("#imagePages").append(b)}if(c>1){this.addPage(1);c>2&&d("#imagePages").append(" ... ")}for(f=
c;f<=e;f++)this.addPage(f);if(this.pageCount>e){e+1<this.pageCount&&d("#imagePages").append(" ... ");this.addPage(this.pageCount)}if(this.currentPage==this.pageCount)d("#imagePages").append('<span class="inactive">Next &raquo;</span>');else{c=d('<a href="#">Next &raquo;</a>').click(function(){a.showPage(a.currentPage+1)});d("#imagePages").append(c)}}},loadFileData:function(a){var c=this;d(document.imageToolForm).find(".fileList ul").empty();var e=0;if(this.currentMode=="myrecent"){var b=(c.currentPage-
1)*c.PER_PAGE;d.each(this.newUploads,function(g,l){if(!(g<b)){if(e>=c.PER_PAGE)return false;var o=c.addFileRow("imageTable",l.f_name,l.r_mime_type,l.f_view_group,null,true);d(o).attr("id","swfu_file_"+l.id).find("div.fileName").append("&nbsp;&nbsp;").append(d("<a>").attr("href","#").addClass("uploadCancelButton").attr("id",l.id+"cancel").text("cancel").click(function(p){o.remove();c.swfu.swfu.cancelUpload(l.id,false);p.preventDefault()})).append('<div class="progressContainer"><div class="progressBar" id="'+
l.id+'progress"></div></div>');e++}})}d.each(a.files,function(g,l){if(e>=c.PER_PAGE)return false;c.addFileRow("imageTable",l.f_name,l.r_mime_type,l.f_view_group);e++});if(!e){var f=d("<li>").text("No files found").addClass("nodata");d(".fileList ul").append(f);e++}for(;e<this.PER_PAGE;){f=document.createElement("li");var h=document.createElement("img");h.src="/i/c.gif";h.height=c.IMAGE_SIZE;h.width=c.IMAGE_SIZE;f.appendChild(h);f.appendChild(document.createTextNode(" "));d(".fileList ul").append(f);
e++}this.pageCount=a.pagedata.numpages;this.currentPage=a.pagedata.current;this.resetPages();this.highlightPage(this.currentPage);this.hideFileSpinner()},highlightPage:function(a){d("#imagePages a.pageNumber").each(function(){d(this).html()==a?d(this).addClass("pageCurrent"):d(this).removeClass("pageCurrent")})},externalImageOnloadCallback:function(a){if(a.height==0)alert("The external image could not be found.");else{var c=a.src,e=c.match(/.*\/([^\/\?]+)/);e.length==2&&this.addFileCell("externalTable",
e[1],"image",this.externalPosition++,c,a)}},showExternalImage:function(){var a=this,c=document.getElementById("externalImageUrl").value;if(c){var e=new Image;d(e).one("load",function(){a.externalImageOnloadCallback(e)});d(e).one("error",function(){alert("The external image could not be found.")});e.src=c}else alert("Please enter the address of an external image.")},uiSetup:function(a){var c=this;for(i=0;i<this.MAX_ROWS;i++)this.addRow("externalTable");WikispacesSession.reloadSessionAt(0);WikispacesCommon.setInputDefaults(d("#imageDivTable .fileNameField"),
"searchDefault");d(document.imageToolForm.listMode).change(function(){c.setListMode(d(this).val())});wikispaces_isUserLoggedIn||d("#uploadFileWrapper").hide();d("#externalImageDiv form").submit(function(){c.showExternalImage();return false});d("#imageDiv .tabs .tab").each(function(e){switch(e%2){case 0:d(this).click(function(){d("#imageDiv .styleFile").show();d("#imageDiv .styleExternal").hide();return false});break;case 1:d(this).click(function(){d("#imageDiv .styleFile").hide();d("#imageDiv .styleExternal").show();
return false});break}});d(document.imageToolForm).submit(function(e){e.preventDefault()});d(document.imageToolForm.filename).keyup(function(){c.showPage(1);c.tagFilter.showPage(1)});wikispaces_username&&d(document.imageToolForm.listMode).append('<option value="myrecent">My Recent Uploads</option>');d("#imageDiv").find(".autocompleteSpace, .autocompleteTag, .autocompletePage").each(function(){WikispacesAutocomplete.initAutocomplete(this)});this.tagFilter=WikispacesCOB.initFilter(d("#imageDiv .filterWrapper"),
{tagChangeCallback:function(){c.showPage(1)},sessionFailCallback:function(){k.activeEditor.plugins.wscommon.sessionReloadFailed()},tagPageChangeCallback:function(){a.resize()}});-1!=navigator.platform.indexOf("Mac")&&d("#ctrlKeyName").html("&#8984;");this.setupSwfu()},setupSwfu:function(){try{var a=this,c=k.mainEditor;this.swfu=new WikispacesCommon.swfUpload(c.getParam("wsimage_upload_url"),c.getParam("wsimage_max_file_size"));this.swfu.swfu.queueSettings.user_upload_complete_handler=function(f){this.requireRefresh=
true;d("#swfu_file_"+f.id).attr("id","").find(".progressContainer").remove();d("#"+f.id+"cancel").remove();return true};this.swfu.swfu.settings.file_queued_handler=function(f){var h="application/octet-stream",g=f.name;if(a.isImageFilename(f.name)){h="image";f.name=f.name.replace(/\s/g,"_")}a.newUploads.push({f_name:g,r_mime_type:h,id:f.id})};this.swfu.swfu.settings.queue_complete_handler=function(){a.newUploads=[];d("#cancelQueueBtn").hide();d("#uploadFileWrapper").width("auto").height("auto");var f=
d("<iframe>").hide().load(function(){a.setListMode("myrecent");d("#filenameAutocomplete").val("");d("#imageDiv .WikiTokenAutocomplete .closebutton").click()});d("body").append(f);f.attr("src",WikispacesCommon.addUriParams(this.customSettings.confirmUploadUrl,[["remoteMode","true"]]))};var e=this.swfu.swfu.settings.file_dialog_complete_handler;this.swfu.swfu.settings.file_dialog_complete_handler=function(){if(a.newUploads.length>0){a.setListMode("myrecent");d("#filenameAutocomplete").val("");d("#imageDiv .WikiTokenAutocomplete .closebutton").click();
d("#imageDivTable .filterTagShow").effect("highlight",{},3E3);d("#uploadFileWrapper").width("1px").height("1px");d("#cancelQueueBtn").removeClass("hidden").show()}e.call(this)};d("#cancelQueueBtn").click(function(){a.swfu.swfu.cancelQueue();a.newUploads=[];d(this).attr("disabled","disabled").hide();d("#uploadFileWrapper").width("auto").height("auto");d(".progressContainer").remove();d(".uploadCancelButton").remove();var f=d("<iframe>").hide().load(function(){a.setListMode("myrecent");d("#filenameAutocomplete").val("");
d("#imageDiv .WikiTokenAutocomplete .closebutton").click()});d("body").append(f);f.attr("src",WikispacesCommon.addUriParams(a.swfu.swfu.customSettings.confirmUploadUrl,[["remoteMode","true"]]))})}catch(b){}},isImage:function(a){switch(a){case "image/png":case "image/x-png":case "image/jpeg":case "image/gif":case "image/jpg":case "image/pjpeg":return true}return false},isImageFilename:function(a){return a.match(/.*\.(?:gif|jpg|jpeg|png)$/i)},isMedia:function(a){return this.isAudio(a)||this.isVideo(a)},
isAudio:function(a){switch(a){case "audio/mpeg":case "audio/mpg":case "audio/mp3":case "audio/x-mp3":case "audio/x-mpeg":case "audio/x-mpg":case "application/asx":case "application/x-mplayer2":case "audio/x-ms-wma":case "audio/x-ms-wax":case "audio/3gpp":case "audio/3gpp2":case "audio/aac":case "audio/x-aac":case "audio/aiff":case "audio/x-aiff":case "audio/mid":case "audio/midi":case "audio/x-midi":case "audio/mp4":case "audio/m4a":case "audio/x-m4a":case "audio/wav":case "audio/x-wav":case "audio/x-pn-realaudio":case "audio/x-pn-realaudio-plugin":return true}return false},
isVideo:function(a){switch(a){case "video/x-ms-asf-plugin":case "video/x-ms-asf":case "video/x-ms-wm":case "video/x-ms-wmv":case "video/x-ms-wvx":case "video/avi":case "video/3gpp":case "video/3gpp2":case "video/m4v":case "video/x-m4v":case "video/mp4":case "video/mpeg":case "video/x-mpeg":case "video/quicktime":case "video/sd-video":case "video/flv":case "video/x-flv":case "application/x-shockwave-flash":case "application/futuresplash":return true}return false}});k.PluginManager.add("wsimagepopup",
wikispaces.popups.Image)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.LinkPlugin",{init:function(a){var c=this;this.editor=a;a.addCommand("wslink",function(){k.mainEditor.plugins.wspopup.show("linkTool",{plugin:c})});a.addButton("wslink",{title:"Insert Link",label:"Link",onclick:function(){k.activeEditor.wsExecCommand("wslink");WikispacesCommon.track("Editor","Open Link Tool")}});a.onNodeChange.add(function(e,b,f){e.theme.controlManager().setActive("wslink",f.nodeName=="A"&&!f.name||f.nodeName=="IMG"&&f.parentNode.nodeName==
"A");f.nodeName=="A"&&!f.name&&f.href.indexOf("#mce_temp_url#")==-1&&WikispacesEditor.getMode()=="visual"?k.mainEditor.plugins.wslinkoverlay.show(f):k.mainEditor.plugins.wslinkoverlay.hide()});a.onDblClick.add(function(e,b){if(b.target.nodeName=="A"||b.target.nodeName=="IMG"&&d(b.target).hasClass("WikiAnchor")){b.target.nodeName=="A"&&e.selection.select(b.target);e.execCommand("wslink")}});a.plugins.wscommon.disableUntilLibsLoad(a,"wslink")},getInfo:function(){return{longname:"Wikispaces link",author:"Tangient LLC",
authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},setupForms:function(){k.activeEditor.wsselection.restore(true);d("#switchToWiki").click();d("#switchToAnchor").show();d("#linkTextAnchor").val("");d("#linkDiv #submitLink span span").text(this.selectedLink()?"Change Link":"Add Link");if(this.selectedAnchor()){var a=this.selectedAnchor().id.match(/wikitext@@anchor@@(.*)/);a&&a[1]&&d("#linkTextAnchor").val(a[1]);d("#linkDiv #removeExistingLink").show();d("#switchToAnchor").click()}else if(this.selectedImageEnclosingLink()){this.fillFormsFromElement(this.selectedImageEnclosingLink());
d("#linkDiv #removeExistingLink").show();d("#linkDiv .trText").hide();d("#switchToAnchor").hide()}else if(this.selectedImage()||this.isBlockElementSelected()){d("#linkDiv .trText").hide();d("#switchToAnchor").hide()}else if(this.selectedLink()){this.fillFormsFromElement(this.selectedLink());text=d.trim(d(this.selectedLink()).text()).replace(/\uFEFF/g,"");d("#linkDiv #removeExistingLink").show();d("#switchToAnchor").hide();k.mainEditor.plugins.wslinkpopup.doSyncLinkText=false}else if(this.selectedText()){document.linkForm.pageName.value=
d.trim(this.selectedText());document.linkForm.linkTextWiki.value=this.selectedText();document.linkForm.linkTextExternal.value=this.selectedText();this.fillFormsFromText(d.trim(this.selectedText()));k.mainEditor.plugins.wslinkpopup.doSyncLinkText=false;d(document.linkForm.linkTextWiki).change()}},insertAnchor:function(a){var c=d("<div>").text(a).html();c=c.replace(/"/g,"&quot;");k.activeEditor.wsselection.setContent('<img src="/i/anchor.gif" class="WikiAnchor"  alt="Anchor"  id="wikitext@@anchor@@'+
c+'" title="Anchor: '+c+'"/>');WikispacesCommon.track("Editor","Add Anchor",a);return true},insertLink:function(a,c,e,b,f,h,g,l,o,p){a=this.editor;e=encodeURI(e).replace(/%25/g,"%");b=d("<a></a>",a.getDoc()).attr("href",e).addClass(l).text(c);g&&b.attr("target","_blank");f=a.dom.getOuterHTML(b.get(0));if(this.selectedImageEnclosingLink()){this.selectedImageEnclosingLink().setAttribute("href",e);g?this.selectedImageEnclosingLink().setAttribute("target","_blank"):this.selectedImageEnclosingLink().removeAttribute("target")}else if(this.selectedImage()){c=
this.selectedImage();c.parentNode.appendChild(b.text("").get(0));this.selectedImage().parentNode.replaceChild(b.get(0),c);b.get(0).appendChild(c);k.mainEditor.plugins.wsimageoverlay.refreshLinkStatus();a.wsselection.updateBookmarkToNode(c)}else if(this.selectedLink()){a.dom.replace(b.get(0),this.selectedLink());a.wsselection.updateBookmarkToNode(b.get(0))}else if(this.selectedText()&&!p){a.wsselection.restore();a.getDoc().execCommand("unlink",false,null);if(d.browser.msie){b=a.selection.getRng(true).cloneRange();
if(b.endContainer.parentNode.nodeName=="A"&&b.endOffset==0){span=d('<span class="ie-is-the-best">&nbsp</span>').insertBefore(b.endContainer.parentNode);b.setEndBefore(span.get(0));a.selection.setRng(b)}}a.execCommand("CreateLink",false,"#mce_temp_url#");d.browser.msie&&d(".ie-is-the-best",a.getDoc()).remove();b=a.dom.select("a[href='#mce_temp_url#']");for(i=0;i<b.length;i++){a.dom.setAttrib(b[i],"href",e);a.dom.removeClass(b[i],"wiki_link");a.dom.removeClass(b[i],"wiki_link_ext");a.dom.addClass(b[i],
l);g&&a.dom.setAttrib(b[i],"target","_blank");k.mainEditor.plugins.wslinkoverlay.show(b[i]);if(p&&i==0){a.dom.setHTML(b[i],d("<div>").text(c).html());break}}d("a > a",k.activeEditor.getDoc()).each(function(){d(this).parent().replaceWith(this)})}else a.wsselection.setContent(f);WikispacesCommon.track("Editor","Add Link",e);return true},removeLink:function(){var a=k.activeEditor;if(this.selectedAnchor())a.execCommand("delete");else if(a.selection.isCollapsed()){a.wsselection.restore(true);var c=a.dom.getParent(a.selection.getNode(),
"A");c&&a.dom.replace(d("<span>",a.getDoc()).get(0),c,true)}else{a.wsselection.restore();if(k.isIE&&!a.selection.isCollapsed()){a.selection.setContent('<span id="startMarker">\ufeff</span>'+a.selection.getContent()+'<span id="endMarker">\ufeff</span>');c=d("#startMarker",a.getDoc());var e=d("#endMarker",a.getDoc());a.dom.split(c.closest("a").get(0),c.get(0));a.dom.split(e.closest("a").get(0),e.get(0));var b=c.next("a");a.selection.select(b.get(0),true);c.remove();e.remove()}a.getDoc().execCommand("unlink",
false,null);a.wsselection.tightenSelection();c=d(a.selection.getRng(true).startContainer).closest("span.wiki_link,span.wiki_link_new");c.before(c.html()).remove();a.nodeChanged()}},fillFormsFromElement:function(a){this.fillFormsFromText(d(a).attr("href"));document.linkForm.linkTextWiki.value=d(a).text();document.linkForm.linkTextExternal.value=d(a).text();if(d(a).attr("target")){document.linkForm.newWindowWiki.checked=true;document.linkForm.newWindowExternal.checked=true}},fillFormsFromText:function(a){var c=
"",e="",b="",f="";a=a.replace(/^(..\/)+/,"/");var h=new RegExp("");h.compile("^(?:https?://)?([a-z0-9-]+)."+wikispaces_domain.replace(/\./g,".")+"(?:/(page/view/)?([^#/]+)?(?:#(.+))?)?$","i");var g=new RegExp("");g.compile("^(?:https?://)?"+location.hostname.replace(/\./g,".")+"(?:/(page/view/)?([^#/]+)?(?:#(.+))?)?$","i");h=h.exec(a);g=g.exec(a);var l=/^\/(page\/view\/)?([^#\/]+)?(?:#(.+))?$/i.exec(a);a=/.*@.*|^(?:[a-zA-Z0-9.+-]+:\/\/|mailto:|www\.).*/i.exec(a);if(h){c=h[1];e=h[3];if(!e&&!h[2])e=
"home";b=h[4]}else if(g){e=g[1];if(!e&&!g[2])e="home";b=g[3]}else if(l){e=l[2];if(!e&&!l[1])e="home";b=l[3]}else if(a)f=a[0];if(e){e=e.replace(/\+/g," ");e=decodeURIComponent(e);document.linkForm.pageName.value=e}if(b){b=b.replace(/\+/g," ");b=decodeURIComponent(b);document.linkForm.anchor.value=b;d(document.linkForm.anchor).change();k.mainEditor.plugins.wslinkpopup.showAnchor()}if(c)document.linkForm.space.value=c;if(f){document.linkForm.url.value=f;d("#switchToExternal").click()}},selectedAnchor:function(){return d(this.selectedImage()).filter(".WikiAnchor").get(0)},
selectedLink:function(){return this.editor.wsselection.selectedLink()},selectedImage:function(){this.editor.wsselection.restore(true);return d(this.editor.selection.getNode()).closest("img").get(0)},selectedImageEnclosingLink:function(){return d(this.selectedImage()).parent("a").get(0)},selectedText:function(){this.editor.wsselection.restore(true);return this.editor.selection.getContent({format:"text"}).replace(/\uFEFF/g,"")},isBlockElementSelected:function(){return this.editor.selection.getContent().toLowerCase().match(/(<\/?table>)|(<\/?tr>)|(<\/?td>)|(<\/?ul>)|(<\/?ol>)|(<\/?li>)/)}});
k.PluginManager.add("wslink",wikispaces.plugins.LinkPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.LinkOverlay",{init:function(a){var c=this;this.editor=a;this.overlay=null;a.onInit.add(function(e){var b=function(f){f.onClick.add(function(h,g){g.target.nodeName=="A"?c.show(g.target):c.hide()})};e.onInitSubEditor.add(b);b(e)});a.onModeSwitch.add(function(e){e=="plain"&&c.hide()});d(window).resize(function(){c.link&&d(c.link).is(":visible")&&c.repositionAndShow()})},getInfo:function(){return{longname:"Wikispaces link overlay",author:"Tangient LLC",authorurl:"http://wikispaces.com",
infourl:"http://wikispaces.com",version:"0.1"}},overlayContent:function(){return WikispacesContent.loadContent("linkProperties")},show:function(a){if(this.link!=a){this.link=a;if(this.overlay==null){this.overlay=d("<div>").addClass("WikiOverlay overlayLayer").css({position:"absolute"}).html(this.overlayContent()).hide().appendTo("#pageEditor");this.setup()}k.mainEditor.plugins.wstableoverlay.unselectTableCell();a=d(this.link).attr("href");if(a.substring(0,1)=="/"){a=a.substring(1);d("#linkOverlayLabelPage").show();
d("#linkOverlayLabelUrl").hide()}else{d("#linkOverlayLabelPage").hide();d("#linkOverlayLabelUrl").show()}a=WikispacesCommon.truncify(a,60);d("#linkOverlayHref").html(a);this.repositionAndShow()}},hide:function(){d(this.link).closest("td,th").length&&k.mainEditor.plugins.wstableoverlay.selectTableCell(d(this.link).closest("td,th").get(0));this.overlay&&this.overlay.hide();this.link=null},repositionAndShow:function(){this.overlay.css({left:"-10000px",top:"-10000px"}).show();this.overlay.css(this.editor.plugins.wscommon.positionBelow(this.overlay,
this.link))},setup:function(){var a=this;d("#linkOverlayVisit").click(function(){a.visitLink();return false});d("#linkOverlayChange").click(function(){a.changeLink();return false});d("#linkOverlayRemove").click(function(){a.removeLink();return false})},visitLink:function(){window.open(d(this.link).attr("href"));this.hide()},changeLink:function(){this.editor.execCommand("wslink");this.hide()},removeLink:function(){this.editor.undoManager.begin();this.editor.selection.select(this.link);this.editor.plugins.wslink.removeLink();
this.editor.undoManager.end();this.hide()}});k.PluginManager.add("wslinkoverlay",wikispaces.plugins.LinkOverlay)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.Link",{linkTextChanged:false,doSyncLinkText:true,anchorFailure:false,pageNameFailure:false,linkTextFailure:false,linkType:"Wiki",tooManyPages:false,editor:null,plugin:null,init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"linkTool",title:"Insert Link",width:440,height:250,wsselection:2,onShow:function(e){c.onShow(e)},uiSetup:function(e){c.uiSetup(e)}})},setPlugin:function(a){this.plugin=a},onShow:function(a){this.setPlugin(a.plugin);
this.resetForms();if(a.plugin){a.plugin.setupForms();this.showValidWikiLink()}},showValidWikiLink:function(){var a=document.linkForm.pageName.value;d(document.linkForm.pageNameSelect).val(a);if(d(document.linkForm.pageNameSelect).val()==a&&!this.tooManyPages)this.switchToSelect();else{this.switchToAutocomplete();setTimeout(function(){document.linkForm.pageName.autocompleter.findValue()},10)}},resetForms:function(){this.linkTextChanged=false;this.doSyncLinkText=true;this.linkTextFailure=this.pageNameFailure=
this.anchorFailure=false;this.linkType="Wiki";document.linkForm.linkTextWiki.value="";document.linkForm.linkTextExternal.value="";document.linkForm.space.value=wikispaces_spaceName;document.linkForm.pageName.value="";d(document.linkForm.pageNameSelect).val("");document.linkForm.anchor.value="";document.linkForm.url.value="";document.linkForm.newWindowWiki.checked=false;document.linkForm.newWindowExternal.checked=false;d("#anchorCellOff").show();d("#anchorCellOn").hide();d("#switchToWiki").click();
d("#linkDiv div.linkToolInputError").hide();d("#linkDiv #removeExistingLink").hide();d("#linkDiv .trText").show();d("#linkDiv #pageName").removeClass("ac_match ac_nomatch")},changeSpaceName:function(a){var c=d("input#pageName").get(0).autocompleter;c.setExtraParams({space:a});c.flushCache()},switchToAutocomplete:function(){d("#pageNameSelect").hide();d("#pageName").parent().show();d("#pageName").focus();d("#pageName").change()},switchToSelect:function(){d("#pageName").parent().hide();d("#pageNameSelect").show();
d("#pageNameSelect").val(d("#pageName").val())},loadWikiPages:function(a){var c=this,e=function(){WikispacesSession.reloadSession(function(){c.loadWikiPages(a)},3E3,function(){k.activeEditor.plugins.wscommon.sessionReloadFailed()})};d.ajax({url:"/space/pagelistajax/",xhr:WikispacesCommon.jQueryAjaxFix,type:"GET",async:true,cache:true,dataType:"xml",global:false,error:e,success:function(b,f,h){if(h.status==0)return e.call(this,h,f,null);log("load page list ajax success",b);WikispacesSession.reloadSessionSuccess();
b=d(b);if(b.find("tooMany").length)c.disableSelect();else{c.switchToSelect();var g=[];b.find("page").each(function(){var l=d(this).text();l=d("<option>").attr("value",l).text(WikispacesCommon.truncate(l,43));g.push(l[0])});d("#pageNameSelect").append(g)}a&&a()}})},addAnchor:function(){var a=document.linkForm.linkTextAnchor.value;if(!a.match(/^[^\]\|]+$/)){alert("Please correct the anchor name error before continuing.");return false}return this.plugin.insertAnchor(a)},addLink:function(a){var c=document.linkForm["linkText"+
a].value,e=document.linkForm.url.value,b=document.linkForm.space.value,f=document.linkForm.anchor.value,h=document.linkForm.pageName.value,g=document.linkForm["newWindow"+a].checked;if(a=="Wiki"){e="";e=h;if(b==""||e==""){alert("Please enter a wiki and page name.");return false}if(f!="")f="#"+f;e=b==wikispaces_spaceName?"/"+encodeURIComponent(e)+f:"http://"+b+"."+wikispaces_domain+"/"+encodeURIComponent(e)+f;if(this.pageNameFailure){alert("Please correct the page name error before continuing.");return false}if(this.anchorFailure){alert("Please correct the anchor error before continuing.");
return false}}else if(e==""){alert("Please enter a URL.");return false}else e.match(/^(?:[a-zA-Z0-9.+-]+:\/\/|mailto:)/)||(e=e.indexOf("@")>0?"mailto:"+e:"http://"+e);if(this.linkTextFailure){alert("Please correct the link text error before continuing.");return false}var l="wiki_link";if(a=="External")l="wiki_link_ext";if(d("#linkDiv .trText").is(":visible")){var o="";if(d.trim(c)==""){alert("Please enter text for the link.");return false}for(;c.charAt(c.length-1)==" ";){c=c.slice(0,c.length-1);o+=
" "}}return this.plugin.insertLink(a,c,e,b,h,f,g,l,o,this.linkTextChanged)},disableSelect:function(){this.tooManyPages=true;d("#switchToPage").hide();this.switchToAutocomplete()},checkPageName:function(a){var c=document.getElementById("pageNameError");a=a.value;if(this.pageNameFailure=/^\.\.?\s*$/.test(a)){c.innerHTML="Wiki page names cannot be . or ..";c.style.display="block";return this.pageNameFailure}if(this.pageNameFailure=/[\[\]:|\/{}$\"#@+]/.test(a)){c.innerHTML='Wiki page names cannot contain: [ ] : | / { } $ + " # @';
c.style.display="block";return this.pageNameFailure}if(a.length>255){this.pageNameFailure=true;c.innerHTML="Wiki page name cannot be more than 255 characters";c.style.display="block";return this.pageNameFailure}c.innerHTML="";c.style.display="none";return this.pageNameFailure},checkLinkText:function(a){var c=d("#linkDiv div.linkTextError"),e=new RegExp;e.compile("]]|]$");(this.linkTextFailure=e.test(a.value))?c.each(function(){this.innerHTML="Link text must not end with ] or contain ]]"}):c.each(function(){this.innerHTML=
""});c.show()},checkAnchor:function(a){var c=d(a).nextAll(".linkToolInputError:first");document.getElementById("anchorError");(this.anchorFailure=!/^[^\]\|]+$/.test(a.value))?c.html("Anchors cannot contain | or ]").show():c.html("").hide()},clickWikiLink:function(){this.linkType="Wiki";d("#linkDiv .selected").removeClass("selected");d("#switchToWiki").addClass("selected");d("#linkDiv .tabContents").hide();d("#linkDiv .styleWiki").show();d("#linkTextExternal").val()&&d("#linkTextWiki").val(d("#linkTextExternal").val());
document.linkForm.newWindowWiki.checked=document.linkForm.newWindowExternal.checked;d("#linkTextWiki").focus()},clickExternalLink:function(){this.linkType="External";d("#linkDiv .selected").removeClass("selected");d("#switchToExternal").addClass("selected");d("#linkDiv .tabContents").hide();d("#linkDiv .styleExternal").show();d("#linkTextWiki").val()&&d("#linkTextExternal").val(d("#linkTextWiki").val());document.linkForm.newWindowExternal.checked=document.linkForm.newWindowWiki.checked;d("#url").focus()},
clickAnchorLink:function(){this.linkType="Anchor";d("#linkDiv .selected").removeClass("selected");d("#switchToAnchor").addClass("selected");d("#linkDiv .tabContents").hide();d("#linkDiv .styleAnchor").show();d("#linkTextAnchor").focus()},showAnchor:function(){d("#anchorCellOn").show();d("#anchorCellOff").hide();document.linkForm.anchor.disabled||document.linkForm.anchor.focus()},syncLinkText:function(a){if(!this.checkPageName(a)&&this.doSyncLinkText){d(document.linkForm.linkTextWiki).val(d(a).val());
d(document.linkForm.linkTextExternal).val(d(a).val())}},uiSetup:function(a){var c=this;this.loadWikiPages(function(){c.showValidWikiLink()});var e=function(){k.activeEditor.focus();a.close();k.mainEditor.plugins.wsimageoverlay.refreshLinkStatus();return false};d("#linkDiv").find(".autocompleteSpace, .autocompleteTag, .autocompletePage").each(function(){WikispacesAutocomplete.initAutocomplete(this)});d("#pageNameSelect").change(function(){d(this).val()=="@@"?c.switchToAutocomplete():d(document.linkForm.pageName).val(d(this).val()).change()});
var b=function(){c.syncLinkText(this)};d("#pageName").change(b).keyup(b);b=document.linkForm.pageName.autocompleter;var f=b.options.onItemSelect;b.options.onItemSelect=function(h,g){f(h,g);d(document.linkForm.pageName).change()};d("#url").change(function(){d(this).val(d(this).val().replace(/[\]\[{}|]/g,encodeURIComponent))});d("#switchToWiki").click(function(){c.clickWikiLink();a.resize();return false});d("#switchToExternal").click(function(){c.clickExternalLink();a.resize();return false});d("#switchToAnchor").click(function(){c.clickAnchorLink();
a.resize();return false});d("#linkTextWiki").keydown(function(){c.doSyncLinkText=false;c.linkTextChanged=true});d("#linkTextExternal").keydown(function(){c.doSyncLinkText=false;c.linkTextChanged=true});b=function(){c.checkLinkText(this)};d("#linkTextWiki").change(b).keyup(b);d("#linkTextExternal").change(b).keyup(b);d("#cancelLink").click(e);d("#switchToSpace").change(function(){c.changeSpaceName(this.value)});d("#switchToPage").click(function(){c.switchToSelect();return false});d("#wikiAnchor").click(function(){c.showAnchor();
a.resize();return false});b=function(){c.checkAnchor(this)};d("#anchor").change(b).keyup(b);d("#linkTextAnchor").change(b).keyup(b);d("#removeExistingLink").click(function(h){c.plugin.removeLink();e();h.preventDefault()});d("#submitLink").click(function(h){h.preventDefault();if(c.linkType=="Anchor")c.addAnchor()&&e();else c.addLink(c.linkType)&&e();return false})}});k.PluginManager.add("wslinkpopup",wikispaces.popups.Link)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.ListPlugin",{init:function(a){function c(h){var g=null;if(d(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").size()>0)g=d(a.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").get(0).nodeName;d(a.selection.getNode()).closest("ul,ol");a.execCommand(h);if(k.isWebKit&&g){h=a.selection.getBookmark();d(a.selection.getNode()).closest("li").wrapInner("<"+g+">");a.selection.moveToBookmark(h)}b.mergeLists(a.selection.getNode())}var e=this,b=this;this.editor=a;this.selectedItem=
null;a.addCommand("wsInsertOrderedList",function(){c("InsertOrderedList")});a.addCommand("wsInsertUnorderedList",function(){c("InsertUnorderedList")});a.onNodeChange.add(function(h,g,l){e.selectedItem=d(l).closest("li").get(0);g=h.wsselection&&h.wsselection.selectedElements("table").length>0;h.theme.controlManager().setDisabled("insertorderedlist",g);h.theme.controlManager().setDisabled("insertunorderedlist",g);h.theme.controlManager().setDisabled("hr",e.selectedItem!=null)});a.onKeyDown.addToTop(function(h,
g){if(!(!e.selectedItem||g.ctrlKey||g.altKey)){if(g.keyCode=="9"){try{h.wsExecCommand("useCSS",false,true)}catch(l){}h.undoManager.add();h.undoManager.begin();d(".wsTmpLiWorkingClass",h.getDoc()).removeClass("wsTmpLiWorkingClass");var o=d(h.selection.getNode()).closest("li").addClass("wsTmpLiWorkingClass").children("ol,ul")[0];if(o){for(var p=h.selection.getBookmark();o;){h.dom.split(o.parentNode,o);o=d(".wsTmpLiWorkingClass",h.getDoc()).eq(0).removeClass("wsTmpLiWorkingClass").end().eq(1).children("ol,ul")[0]}h.selection.moveToBookmark(p)}d(".wsTmpLiWorkingClass",
h.getDoc()).removeClass("wsTmpLiWorkingClass");if(g.shiftKey)if(k.isGecko){p=h.selection.getBookmark();o=d(h.selection.getNode()).closest("li");var m=o.parent("ol,ul");if(m.length)o=m.children().length>1?d(h.dom.split(m[0],o[0])):m.children().replaceAll(m);o.parent().is("ol,ul")||o.replaceWith(d("<p>",h.getDoc()).append(o.contents()));h.selection.moveToBookmark(p)}else h.wsExecCommand("outdent",false,"");else{h.wsExecCommand("indent",false,"");if(k.isWebKit){p=h.selection.getBookmark();d(h.selection.getStart()).closest("li").addClass("wsholdstart");
d(h.selection.getEnd()).closest("li").addClass("wsholdend");var n=false,q=false;d(h.selection.getStart()).parents("ul,ol").last().find("li").each(function(s,r){if(!n){if(d(r).is(".wsholdstart")){d(r).removeClass("wsholdstart");q=true}if(d(r).is(".wsholdend")){d(r).removeClass("wsholdend");n=true}q&&d(r).children("br:first-child").remove()}});h.selection.moveToBookmark(p)}if(k.isGecko){o=d(h.selection.getNode()).parent().closest("blockquote");m=o.children();if(1==m.length&&m.eq(0).is("ol,ul")){p=h.selection.getBookmark();
m=m[0].nodeName.toLowerCase();o.wrapInner("<"+m+">").children().eq(0).unwrap();h.selection.moveToBookmark(p)}}}h.undoManager.end();g.preventDefault();g.stopPropagation();return false}k.isGecko&&h.onSetContent.add(function(){d("li",h.getBody()).each(function(s,r){r.childNodes.length==0&&d(r).html("<br/>")})})}});var f=false;a.onKeyDown.addToTop(function(h,g){if(!(!e.selectedItem||g.ctrlKey||g.altKey)){if(g.keyCode=="13"&&!g.shiftKey&&k.isIE){var l=d(h.selection.getNode()).closest("li");if(l.length&&
l.text()==""&&!l.find("img").length){h.selection.setContent('<span id="_ws_new_cursor">\ufeff</span>');l.parent().find("li").each(function(m,n){d(n).text()==""&&!d(n).find("img").length&&d(n).html('<span class="wsTemp">\ufeff</span>')});l=d(h.dom.split(l.parent()[0],l[0]));l.parent().find("span.wsTemp").remove();if(!l.parent().is("ol,ul")){l.find("br:last-child").length||l.append("<br>");l.wrapInner("<p>").replaceWith(l.contents())}var o=d("#_ws_new_cursor",h.getDoc());o.after(h.getDoc().createTextNode(""));
h.selection.select(o[0].nextSibling,true);h.selection.collapse(false);o.remove();k.dom.Event.cancel(g);return}else{l=d(h.selection.getNode()).closest("h1,h2,h3,h4,h5,h6,p,div").closest("li");if(l.length){h.selection.setContent('<span id="_ws_splitonme">\ufeff</span><span id="_ws_new_cursor">\ufeff</span>');l=d("#_ws_splitonme",h.getDoc());d(h.dom.split(l.closest("li")[0],l[0])).remove();l=d("#_ws_new_cursor",h.getDoc()).closest("h1,h2,h3,h4,h5,h6,p,div");l.replaceWith(l.contents());o=d("#_ws_new_cursor",
h.getDoc());l=o.closest("li");o.remove();l.prepend(h.getDoc().createTextNode(""));h.selection.select(l[0].firstChild,true);h.selection.collapse(false);k.dom.Event.cancel(g);return}}}if(g.keyCode=="13"){l=function(){var m=d(h.selection.getNode()).closest("li").find("ul,ol").first();m.length||(m=d(h.selection.getNode()).next("ul,ol"));var n=d("<li>&nbsp;</li>").insertBefore(m);m.appendTo(n);m=d("<span>",h.getDoc()).prependTo(n);h.plugins.wscommon.cursorToAndRemoveElement(m);k.dom.Event.cancel(g)};if(k.isGecko&&
!g.shiftKey&&h.wsselection.isInFrontOf("ul,ol"))l();else if((k.isGecko||k.isWebKit)&&d(h.selection.getNode()).text()==""&&!d(h.selection.getNode()).find("img").length&&d(h.selection.getNode()).parents("ol,ul").length>=2){l=d(h.selection.getNode()).closest("li");var p;if(l.parent("ul,ol").prev("li").get(0)){p=d("<span>",h.getDoc()).prependTo(d("<li><br/>").insertAfter(l.parent()));k.isGecko&&setTimeout(function(){d("ul > br:only-child",h.getDoc()).parent().remove()},100)}else p=d("<span>",h.getDoc()).prependTo(d("<li><br/>").insertAfter(l.parents("li").first()));
setTimeout(function(){h.plugins.wscommon.cursorToAndRemoveElement(p)},100);l.remove();k.dom.Event.cancel(g)}else if(k.isWebKit)if(g.shiftKey&&h.wsselection.isInFrontOf("ul,ol"))d(h.selection.getNode()).closest("li").find("ul,ol").first().before("<br/>");else if(!g.shiftKey&&d(h.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").size()>0)if(h.wsselection.isAtTheEndOf("li")){p=d("<span>",h.getDoc()).prependTo(d("<li><br/>").insertAfter(d(h.selection.getNode()).parent("li")));h.plugins.wscommon.cursorToAndRemoveElement(p);
k.dom.Event.cancel(g)}else if(h.wsselection.isInFrontOf("ul,ol"))reinsertNestedList();else f=true}}});a.onKeyUp.add(function(h,g){if(!(g.shiftKey||g.ctrlKey||g.altKey))if(k.isWebKit){if(e.selectedItem&&g.keyCode=="8"){g=d(h.selection.getNode()).closest("li");var l=g.next("li").children();if(l.eq(0).is("ul,ol")){l=l.eq(0);l.remove();g.append(l);g.next("li").children().length==0&&g.next("li").remove()}}if(f){g=d(h.selection.getNode()).closest("h1,h2,h3,h4,h5,h6").wrap("<li>");h.plugins.wscommon.cursorToAndRemoveElement(d("<span>",
h.getDoc()).prependTo(g));f=false}}})},mergeLists:function(a){var c=this.editor;for(a=d(a).parents("ul,ol").last();a.prev().is("ul,ol");)a=a.prev();for(;a.is("ul,ol");){a.find("ol,ul").each(function(e,b){e=d(b);if(e.closest("body")[0]==c.getBody()&&e.prev().length&&e.prev()[0].nodeName==e[0].nodeName&&c.plugins.wscommon.areNodesAdjacent(e.prev()[0],e[0])){e.prepend(e.prev().html());e.prev().remove()}});a=a.next();if(a[0]&&a[0].nodeName==a.prev()[0].nodeName){a.prepend(a.prev().html());a.prev().remove()}}},
getInfo:function(){return{longname:"Wikispaces list",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});k.PluginManager.add("wslist",wikispaces.plugins.ListPlugin)})(tinymce,jQuery);
(function(k,d){var a=["WikiAnchor","WikiReference","WikiMediaRss","WikiMediaToc","WikiMediaCustom"];k.create("wikispaces.plugins.ObjectResizePlugin",{init:function(c){this.editor=c;var e=this;c.onInit.add(function(){if(k.isGecko){c.onMouseDown.add(function(b,f){e.enableObjectResizing(e.isResizable(f.target))});c.onKeyDown.add(function(b,f){f.keyCode>=33&&f.keyCode<=40&&e.enableObjectResizing(false)})}k.isIE&&c.dom.bind(c.getDoc(),"controlselect",function(b){return e.isResizable(b.srcElement)})})},
getInfo:function(){return{longname:"Wikispaces object resize",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},isResizable:function(c){c=d(c);return c.is("img,pre")&&!this.hasAnyClass(c,a)},enableObjectResizing:function(c){if(this.resizingEnabled!==c){this.resizingEnabled=c;try{this.editor.execCommand("enableObjectResizing",false,c,{skip_undo:true})}catch(e){}this.editor.execCommand("mceRepaint",false)}},hasAnyClass:function(c,e){for(var b=0;b<
e.length;b++)if(d(c).hasClass(e[b]))return true;return false}});k.PluginManager.add("wsobjectresize",wikispaces.plugins.ObjectResizePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.PopupPlugin",{popups:{},popupStack:[],zIndex:4E5,BORDER_HEIGHT:40,BORDER_WIDTH:15,register:function(a){if(!a.wsname||this.popups[a.wsname])return false;a=d.extend({},a);this.popups[a.wsname]=a},show:function(a,c){var e=this.popups[a];if(!e)return false;if(e.wsselection!==undefined&&e.wsselection!==false){e.stackPosition>=0||k.activeEditor.undoManager.begin();k.activeEditor.wsselection.save(e.wsselection)}if(!e.popup)e.popup=this._openPopup(e);if((a=this._getTopPopup())&&
e.wsname==a.wsname)return e.popup;e.stackPosition>=0&&this.popupStack.splice(e.stackPosition,1);a&&a.popup.blur();a=this._getMaxZIndex()||this.zIndex;var b=d("#"+e.popup.id);b.css("z-index",a+2);e.stackPosition=this.popupStack.length;this.popupStack.push(e);e.popup.focus();b.show();d(window).bind("resize."+e.popup.id,function(){clearTimeout(e.popup.resizeTimeoutId);e.popup.resizeTimeoutId=setTimeout(function(){e.popup.resize()},10)});e.popup.resize(true);this._lightBox();if(e.onShow){c||(c={});e.onShow(c)}return e.popup},
hide:function(a){a=this.popups[a];if(!a||!a.popup)return false;if(a.stackPosition>=0){this.popupStack.splice(a.stackPosition,1);a.stackPosition=-1;var c=this._getTopPopup();if(c)c.popup.focus();else{k.activeEditor.focus();a.wsselection!==undefined&&a.wsselection!==false&&k.activeEditor.wsselection.restore()}a.wsselection!==undefined&&a.wsselection!==false&&k.activeEditor.undoManager.end()}d(window).unbind("."+a.popup.id);d("#"+a.popup.id).hide();this._lightBox();return true},resize:function(a,c){a=
this.popups[a];if(!a||!a.popup)return false;a.popup.resize(c);return true},_getTopPopup:function(){return this.popupStack[this.popupStack.length-1]},_getMaxZIndex:function(){var a=this._getTopPopup();if(!a)return 0;return d("#"+a.popup.id).css("z-index")},_lightBox:function(){var a=this._getMaxZIndex()-1;a<0?d("#mceModalBlocker").hide():d("#mceModalBlocker").css("z-index",a).show()},_openPopup:function(a){var c=this;a=d.extend({type:"dialog",inline:1,min_width:a.width,min_height:a.height},a);if(a.content==
undefined)a.content="<div>"+WikispacesContent.loadContent(a.wsname)+"</div>";var e=k.mainEditor.windowManager.open(a),b=d("#"+e.id);b.find(".mceOk").blur();k.dom.Event.remove(e.id,"mousedown",e.mousedownFunc);k.dom.Event.remove(e.id,"click",e.clickFunc);b.css({width:"",height:"",overflow:""});this._setPopupSize(e,{width:a.width,height:a.height,overflow:"hidden"});d.extend(e,{close:function(){c.hide(a.wsname)},blur:function(){b.removeClass("mceFocus")},focus:function(){b.addClass("mceFocus")},resize:function(f){c._resizePopup(this,
f)}});b.find(".mceTop").css({MozUserSelect:"none",KhtmlUserSelect:"None",cursor:"default"}).bind("selectstart",function(){return false});b.find(".mceClose").click(function(){e.close();return false});a.uiSetup&&a.uiSetup(e);this._resizePopup(e);return e},_setPopupSize:function(a,c){d("#"+a.id+" .mceMiddle > span > div").css(c)},_resizePopup:function(a,c){if(!a)return false;var e=this,b=d("#"+a.id+" .mceMiddle > span > div").children().eq(0);d("#"+a.id).ready(function(){setTimeout(function(){var f=
{margin:true},h=b.outerWidth(f),g=b.outerHeight(f);if(d.browser.safari){alternateWidth=b.outerWidth();alternateHeight=b.outerHeight();if(alternateWidth>h)h=alternateWidth;if(alternateHeight>g)g=alternateHeight}var l=0,o=function(){var n=d(this).outerWidth(f)+l,q=d(this).outerHeight(f)+l;if(n>h)h=n;if(q>g)g=q};b.find("table").each(o);l=20;b.find("iframe").each(o);if(g<a.features.min_height)g=a.features.min_height;if(h<a.features.min_width)h=a.features.min_width;o={};var p=false,m=false;m=d(window).height()-
e.BORDER_HEIGHT;p=d(window).width()-e.BORDER_WIDTH;if(g>m)h+=d.getScrollbarWidth();if(h>p){g+=d.getScrollbarWidth();h=p;o.overflowX="scroll";p=true}else o.overflowX="hidden";if(g>m){g=m;o.overflowY="scroll";m=true}else o.overflowY="hidden";o.width=h;o.height=g;e._setPopupSize(a,o);e._moveIntoView(a,c)},10)})},_moveIntoView:function(a,c){var e=d(window).height(),b=d(window).width();a=d("#"+a.id);var f={};if(c){f.top=(e-a.height()+this.BORDER_WIDTH)/2;f.left=(b-a.width())/2}else{c=parseInt(a.css("top"));
var h=parseInt(a.css("left"));e=e-a.height()-c-this.BORDER_WIDTH/2;b=b-a.width()-h-this.BORDER_WIDTH/2;if(e<0)f.top=c+e;if(b<0)f.left=h+b}a.css(f)}});k.PluginManager.add("wspopup",wikispaces.plugins.PopupPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.PreviewPlugin",{init:function(a){this.editor=a;var c=this;a.addCommand("preview",function(){c.showPreview()});a.addCommand("endPreview",function(){c.hidePreview()});a.onModeSwitch.add(function(){d("#previewBox").length&&c.hidePreview()})},getInfo:function(){return{longname:"Wikispaces preview",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},showPreview:function(){var a=this;this.getPreviewData(this.editor.plugins.wscommon.fullContent(true,
"empty"),WikispacesEditor.getMode(),function(c){a.hideEditor();c=d("<div></div>").attr("id","previewBox").addClass("wiki editorLayer").css({width:"100%",position:"relative"}).html(c);d(a.editor.getContainer()).append(c);a.editor.theme.showToolSet("preview");WikispacesCommentManager.hideAll();a.commentSpaces=WikispacesCommentManager.preemptSpaces();WikispacesCommentManager.readOnly=true;a.previewSpace=new WikispacesCommentSpace(c,"#wsMainEditor_container","#wsMainEditor_container")})},hidePreview:function(){d("#previewBox").remove();
this.editor.theme.showToolSet();d(".mceToolbar.spinner").remove();d(".mceToolbar").show();this.showEditor();WikispacesCommentManager.removeSpace(this.previewSpace);WikispacesCommentManager.restoreSpaces(this.commentSpaces);WikispacesCommentManager.readOnly=false;if(WikispacesEditor.getMode()=="visual"){WikispacesCommentManager.redrawAll(true);WikispacesCommentManager.forceWidth()}else WikispacesCommentManager.hideAll()},getPreviewData:function(a,c,e){var b=this,f=d("<div></div>").attr("id","previewSpinner").addClass("wikispaces_content").addClass("mceToolbar spinner").css({textAlign:"center"}).html('Loading Preview <img src="/i/spinner.gif" alt="" width="18" height="18" style="padding-top: 9px; vertical-align: -4px;"/>');
d(".mceToolbar").hide();d(b.editor.plugins.wscommon.editorToolbar()).append(f);var h=function(){WikispacesSession.reloadSession(function(){b.showPreview()},3E3,function(){b.editor.plugins.wscommon.sessionReloadFailed();d(".mceToolbar.spinner").remove();d(".mceToolbar").show()})};d.ajax({url:"/page/preview/"+encodeURIComponent(wikispaces_page),xhr:WikispacesCommon.jQueryAjaxFix,type:"POST",async:true,cache:false,data:{content:a,mode:c},dataType:"xml",global:false,error:h,success:function(g,l,o){if(o.status==
0)return h.call(this,o,l,null);log("showPreviewResponse",g);WikispacesSession.reloadSessionSuccess();g=d(g);g.find("preview").length&&e(g.find("preview").text());d(".mceToolbar.spinner").remove();d(".mceToolbar").show();if(!g.find("preview").length)if(g.find("error").length){g=g.find("error").attr("message");alert(g)}else alert("An unexpected error occurred.")}})},hideEditor:function(){this.bookmark=null;try{this.bookmark=this.editor.selection.getBookmark(2)}catch(a){}d(".WikiOverlay").hide();this.frameHeight=
d(this.editor.plugins.wscommon.editorIFrame()).height();d(this.editor.getContentAreaContainer()).hide();d("#referenceEditors").hide()},showEditor:function(){d(this.editor.getContentAreaContainer()).show();d(this.editor.plugins.wscommon.editorIFrame()).height(this.frameHeight);d("#referenceEditors").show();var a=this;setTimeout(function(){try{a.bookmark&&a.editor.selection.moveToBookmark(a.bookmark)}catch(c){}a.editor.focus();a.editor.wsselection.ensureCursor()},100)}});k.PluginManager.add("wspreview",
wikispaces.plugins.PreviewPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.ReferencePlugin",{popup:null,init:function(a){this.editor=a;var c=this;a.onBeforeSetContent.addToTop(function(h,g){if((g.load||g.wsautoload)&&WikispacesEditor.getMode()=="visual"){c.removeReferenceEditors();c.pullOutReferences(g)}});a.onModeSwitch.add(function(h){h=="plain"&&c.removeReferenceEditors()});var e=function(){for(var h=0;h<c.referenceCount();h++){var g=d(a.getDoc()).find("#citation-"+h).length>0,l=c.isReferenceActive(h);if(l&&!g||!l&&g)c.toggleReference(h)}},
b=function(){e()};a.onChange.add(function(){setTimeout(b,0)});a.onUndo.add(b);a.onRedo.add(b);var f=false;a.onKeyDown.add(function(h){f=!h.selection.isCollapsed()});a.onKeyUp.add(function(h,g){if(g.keyCode==8||g.keyCode==46||f)e()});a.onDblClick.add(function(h,g){if(d(g.target).is("img.WikiReference")){h=c.elementIdToRefId(d(g.target).attr("id"));h=k.editors["reference-editor-"+h];d.scrollTo(h.getContentAreaContainer(),{axis:"y",duration:500});h.focus()}})},getInfo:function(){return{longname:"Wikispaces reference",
author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},elementIdToRefId:function(a){return a.match(/-(\d+)$/)[1]},pullOutReferences:function(a){var c=false,e=this;a.content=a.content.replace(/(&lt;ref(?:&gt;|>)((?:.|\n)*?)&lt;\/ref(?:&gt;|>))|(<pre\s+.*?>)|(<\/pre>)/gmi,function(b,f,h,g,l){if(f&&!c){b=e.referenceCount();h=e.makeReferenceHtml(b);e.addReferenceEditor(b,f);return h}else if(g)c=true;else if(l)c=false;return b})},pushInReferences:function(a){log("pushInReferences");
return a.replace(/<img[^>]*?id="?citation-(\d+)[^>]*?>/ig,function(c,e){return"&lt;ref&gt;"+k.editors["reference-editor-"+e].getContent()+"&lt;/ref&gt;"})},makeReferenceHtml:function(a){return'<img src="/i/icon_16_numbersquare.png" alt="Reference - double click to edit" title="Reference - double click to view" width="16" height="16" class="WikiReference" id="citation-'+a+'"/> '},insertReferenceAtSelection:function(){var a=this.referenceCount();this.editor.wsselection.setContent(this.makeReferenceHtml(a));
var c=d(this.editor.getDoc()).find("#citation-"+a);c=d(this.editor.getDoc()).find("img.WikiReference").index(c);return this.addReferenceEditor(a,"Type the content of your reference here.",c)},addReferenceEditor:function(a,c,e){var b="reference-editor-"+a;c='<div id="reference-editor-container-'+a+'" class="editorLayer referenceEditorContainer"><textarea id="'+b+'">'+c+"</textarea></div>";d("#referenceEditors").length==0&&d("#pageEditor").append('<div id="referenceEditors"></div>');typeof e!="undefined"&&
d("div#referenceEditors > div:nth-child("+(e+1)+")").size()>0?d("div#referenceEditors > div:nth-child("+(e+1)+")").before(c):d("#referenceEditors").append(c);return this.editor.plugins.wssubeditor.create(b,{reference_reference_id:a,height:"50",theme:"-reference"})},toggleReference:function(a){if(this.isReferenceActive(a)){d("#reference-editor-container-"+a).hide();this.editor.focus();this.editor.undoManager.begin();d(this.editor.getDoc()).find("#citation-"+a).remove();this.editor.undoManager.end()}else d("#reference-editor-container-"+
a).show()},isReferenceActive:function(a){return d("#reference-editor-container-"+a).is(":visible")},referenceCount:function(){return d("#referenceEditors div.referenceEditorContainer").size()},removeReferenceEditors:function(){d.each(k.editors.concat(),function(){if(this.id.match(/^reference-editor/)){this.remove();this.destroy()}});d("#referenceEditors").remove()}});k.PluginManager.add("wsreference",wikispaces.plugins.ReferencePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.util.TimeTracker",{TimeTracker:function(a){this.bucket_=a?a.sort(this.sortNumber):this.DEFAULT_BUCKET},startTime_:null,stopTime_:null,bucket_:null,DEFAULT_BUCKET:[100,500,1500,2500,5E3],_getTimeDiff:function(){return this.stopTime_-this.startTime_},sortNumber:function(a,c){return a-c},_recordStartTime:function(a){this.startTime_=a!=undefined?a:(new Date).getTime()},_recordEndTime:function(a){this.stopTime_=a!=undefined?a:(new Date).getTime()},_track:function(a,
c,e){a=c!=undefined&&c.length!=0?a._createEventTracker(c):a._createEventTracker("TimeTracker");var b;for(c=0;c<this.bucket_.length;c++)if(this._getTimeDiff()<this.bucket_[c]){b=c==0?"0-"+this.bucket_[0]:this.bucket_[c-1]+"-"+(this.bucket_[c]-1);break}b||(b=this.bucket_[c-1]+"+");try{a._trackEvent(b,e,this._getTimeDiff())}catch(f){}},_setHistogramBuckets:function(a){this.bucket_=a.sort(this.sortNumber)}});k.create("wikispaces.plugins.SavePlugin",{timeTracker:null,init:function(a){this.editor=a;this.noDirtyCheck=
false;this.timeTracker=new wikispaces.util.TimeTracker;this.timeTracker._setHistogramBuckets([6E4,12E4,3E5,6E5,12E5,18E5,36E5]);this.timeTracker._recordStartTime();var c=this;a.addCommand("wsSave",function(){c.save()});a.addCommand("wsSaveAndContinue",function(){c.saveAndContinue()});a.onSaveContent.add(function(){c.editor.plugins.wsautosave.autosave(false)});a.onInit.add(function(){window.onbeforeunload=function(){if(!c.noDirtyCheck&&c.isContentDirty()){k.mainEditor.plugins.wsautosave.autosave(false);
return"You have not saved your changes."}}})},createControl:function(a,c){var e=this;if(a=="wssave"){var b=c.createSplitButton("wssave",{title:"Save",label:"Save","class":"btn",onclick:function(){e.editor.wsExecCommand("wsSave")}}),f,h,g;b.onRenderMenu.add(function(l,o){f=o.add({title:"Save with Comment",icon:"saveWithComment",onclick:function(){k.mainEditor.plugins.wspopup.show("saveWithComment");d("#saveWithCommentComment").focus()}});f.setDisabled(true);g=o.add({title:"Save and Continue",icon:"saveContinue",
onclick:function(){l.setDisabled(true);e.editor.wsExecCommand("wsSaveAndContinue")}});g.setDisabled(true);h=o.add({id:"switchEditorModes",title:WikispacesEditor.getMode()=="visual"?"Wikitext Editor":"Visual Editor",icon:"saveTextEditor",onclick:function(){e.editor.execCommand("wstext")}})});b.originalShow=b.showMenu;b.showMenu=function(){var l=d(window).scrollTop();b.originalShow();d(window).scrollTop(l);d("#menu_wsMainEditor_wsMainEditor_wssave_menu").css({borderBottom:"1px solid #d4d0c9",borderRight:"1px solid #d4d0c9"}).appendTo(document.body);
e.editor.plugins.wstoolbarscroll.moveScroller();if(WikispacesContent.isLoaded){f.setDisabled(false);g.setDisabled(false)}e.editor.plugins.wscommon.reloadFailed&&h.setDisabled(true)}}else if(a=="wscancel")b=c.createButton("wscancel",{title:"Cancel",label:"Cancel","class":"btn",onclick:function(){WikispacesCommon.track("Editor","Stop","Cancel");e.timeTracker._recordEndTime();try{_gaq.push(function(){e.timeTracker._track(_gat._getTrackerByName(),undefined,"Editor")})}catch(l){}e.isContentDirty()&&e.editor.plugins.wsautosave.autosave(false);
e.noDirtyCheck=true;document.location=e.editor.getParam("wssave_cancel_url")}});return b},getInfo:function(){return{longname:"Wikispaces save",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},save:function(){this.editor.plugins.wsautosave.autosave(false);var a;if(this.editor.plugins.wsautosave.mergeStatus=="failed")if(confirm("Someone else has saved changes to this page since you started editing. You are about to overwrite some of their changes.\n\nClick OK to save. Your edits will overwrite the other person's changes.\n\nClick Cancel to return to editing. We will show you the other person's saved changes. Where there are conflicts, you can copy their changes into your edit by hand.")){WikispacesCommon.track("Editor",
"Concurrent Editing","Merge Failed - Overwrite");a=this.editor.plugins.wscommon.fullContent(true,"bookmarks,empty")}else{WikispacesCommon.track("Editor","Concurrent Editing","Merge Failed - Cancel");this.editor.plugins.wsautosave.showConcurrentEditorPopup();return false}else a=this.editor.plugins.wsautosave.mergeStatus=="success"?this.editor.plugins.wsautosave.mergeResult:this.editor.plugins.wscommon.fullContent(true,"bookmarks,empty");WikispacesCommon.track("Editor","Stop","Save");this.timeTracker._recordEndTime();
try{_gaq.push(function(){this.timeTracker&&this.timeTracker._track(_gat._getTrackerByName(),undefined,"Editor")})}catch(c){}var e=d(this.editor.getElement()).closest("form");this.noDirtyCheck=true;this.addComments(e.get(0));e.find("textarea[name=WikispacesEditorContent]").val(a);e.append('<input type="hidden" name="update" value="1"/>').submit()},saveAndContinue:function(){this.editor.plugins.wsautosave.autosave(false);if(this.editor.plugins.wsautosave.mergeStatus=="failed")if(confirm("Someone else has saved changes to this page since you started editing. You are about to overwrite some of their changes.\n\nClick OK to save. Your edits will overwrite the other person's changes.\n\nClick Cancel to return to editing. We will show you the other person's saved changes. Where there are conflicts, you can copy their changes into your edit by hand."))WikispacesCommon.track("Editor",
"Concurrent Editing","Merge Failed - Overwrite");else{WikispacesCommon.track("Editor","Concurrent Editing","Merge Failed - Cancel");this.editor.plugins.wsautosave.showConcurrentEditorPopup();return false}var a=this.editor.plugins.wscommon.fullContent(true,"bookmarks,empty"),c=d(this.editor.getElement()).closest("form");this.noDirtyCheck=true;this.addComments(c.get(0));c.find("textarea[name=WikispacesEditorContent]").val(a);c.attr("target","target_editor");c.append('<input type="hidden" id="update" name="update" value="1"/><input type="hidden" id="saveAndContinue" name="saveAndContinue" value="1"/>').submit();
this.editor.plugins.wscomment.markCommentsSaved()},isContentDirty:function(){if(WikispacesEditor.getMode()=="visual"){for(var a=0;a<k.editors.length;a++)if(k.editors[a].isDirty())return true;return false}else return k.mainEditor.plugins.wstext.isDirty()},addComments:function(a){d(a).find("input.pageComment").remove();d.each(this.editor.plugins.wscomment.newComments(),function(c,e){d(a).append(d("<input>",{type:"hidden","class":"pageComment",name:"pageComments["+c+"]",value:e}))})}});k.PluginManager.add("wssave",
wikispaces.plugins.SavePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.SaveWithComment",{editor:null,init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"saveWithComment",title:"Save With Comment",width:500,height:100,uiSetup:function(e){c.uiSetup(e)}})},uiSetup:function(a){var c=this.editor;d("#saveWithCommentComment").keydown(function(e){switch(e.which){case 13:d("#saveWithCommentSave").click();break;case 27:d("#saveWithCommentCancel").click();break}});d("#saveWithCommentSave").click(function(e){WikispacesCommon.track("Editor",
"Stop","Comment");var b=d(c.getContainer()).closest("form").get(0).comment;if(!b){b=d('<input type="text" name="comment" style="display:none;">').get(0);d(c.getContainer()).closest("form").append(b)}b.value=d("#saveWithCommentComment").val();c.wsExecCommand("wsSave");e.preventDefault();return false});d("#saveWithCommentCancel").click(function(e){a.close();e.preventDefault();return false})}});k.PluginManager.add("wssavewithcommentpopup",wikispaces.popups.SaveWithComment)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.SelectionPlugin",{init:function(a){a.onInit.add(function(){a.wsselection=new wikispaces.util.Selection(a)});if(!k.isIE){a.onKeyUp.add(function(c,e){e.keyCode==16&&!c.selection.isCollapsed()&&c.wsselection.tightenSelection()});a.onMouseUp.add(function(c){c.selection.isCollapsed()||c.wsselection.tightenSelection()});a.onExecCommand.add(function(c){c.selection.isCollapsed()||c.wsselection.tightenSelection()})}},getInfo:function(){return{longname:"Wikispaces selection",
author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});k.create("wikispaces.util.Selection",{bookmark:null,type:null,textBookmark:null,editor:null,Selection:function(a){this.editor=a},save:function(a){if(WikispacesEditor.getMode()=="visual"&&this.bookmark||WikispacesEditor.getMode()!="visual"&&this.textBookmark)return null;return this.saveOver(a)},saveOver:function(a){if(WikispacesEditor.getMode()=="visual"){this.bookmarkIsCollapsed=this.editor.selection.isCollapsed();
try{this.bookmark=this.editor.selection.getBookmark(a);this.type=a;return this.bookmark}catch(c){return null}}a=this.editor.plugins.wstext.editorTextArea();this.editor.plugins.wstext.prepareSelection(a);return this.textBookmark={start:a.sel_start,end:a.sel_end}},updateBookmarkToNode:function(a){this.editor.selection.select(a);this.editor.nodeChanged();a=this.type;if(a===null)a=0;this.saveOver(a)},restore:function(a){if(WikispacesEditor.getMode()=="visual"){if(this.bookmark){this.editor.selection.moveToBookmark(d.extend({},
this.bookmark,{keep:a}));this.bookmarkIsCollapsed&&this.editor.selection.collapse(true);if(!a)this.type=this.bookmark=null}}else if(this.textBookmark){this.editor.plugins.wstext.setSelectionRange(this.editor.plugins.wstext.editorTextArea(),this.textBookmark.start,this.textBookmark.end);if(!a)this.textBookmark=null}},setContent:function(a,c){var e=this.editor;if(WikispacesEditor.getMode()=="visual"){a=d("<div>").append(a);a.find("img").addClass("NewWikiImage");a=a.html();e.focus();this.restore();c&&
this.avoid(c);e.selection.setContent(a);e.undoManager.add();e.onNeedsResize&&e.onNeedsResize.dispatch();d("img.NewWikiImage",e.selection.getNode()).removeClass("NewWikiImage").load(function(){e.onNeedsResize&&e.onNeedsResize.dispatch()}).each(function(){this.src=this.src})}else{this.editor.plugins.wstext.editorTextArea().focus();this.restore();this.editor.plugins.wstext.insertInEditor(a);if(this.textBookmark)this.textBookmark.end=this.textBookmark.start}},avoid:function(a){var c=this.editor.selection;
if(a=d(c.getNode()).closest(a).get(0)){c.select(a);c.collapse()}},selectedLink:function(){if(this.bookmark&&this.bookmark.id){var a=d("#"+this.bookmark.id+"_start",this.editor.getDoc()).closest("a");if(a.length>0)return a.get(0);a=d("#"+this.bookmark.id+"_end",this.editor.getDoc()).closest("a");if(a.length>0)return a.get(0);a=d("#"+this.bookmark.id+"_start",this.editor.getDoc()).next("a");if(a.length>0)return a.get(0)}return d(this.editor.selection.getNode()).closest("a").get(0)},ensureCursor:function(){if(!(k.isIE||
WikispacesEditor.getMode()!="visual")){var a=this;setTimeout(function(){d("input.WikiSearchInput").first().focus();d(a.editor.plugins.wscommon.editorIFrame()).focus()},500)}},selectAll:function(){this.editor.selection.select(this.editor.getBody(),true)},canStepIntoNode:function(a){if(!a||a.nodeType!=3&&a.nodeType!=1)return false;switch(a.nodeName){case "BR":case "HR":case "EMBED":case "FRAMESET":case "FRAME":case "IFRAME":case "IMG":case "OBJECT":return false;default:return true}},tightenSelection:function(){if(!k.isIE){for(var a=
this.editor.selection,c=a.getRng(true),e=c.startContainer,b=c.startOffset,f=c.endContainer,h=c.endOffset;c.compareBoundaryPoints(Range.START_TO_END,c)>0;){if(f.nodeType==3){if(0<h)break;l=f.previousSibling}else if(f.nodeType==1)l=h>0?f.childNodes[h-1]:f.previousSibling;else break;var g=null;if(!l){l=f.parentNode;g=0}if(!this.canStepIntoNode(l))break;if(g===null)if(l.nodeType==3)g=l.nodeValue.length;else if(l.nodeType==1)g=l.childNodes.length;else break;f=l;h=g;c.setEnd(f,h)}if(c.compareBoundaryPoints(Range.START_TO_END,
c)<=0){f=e;h=b;c.setStart(e,b)}for(var l=null;c.compareBoundaryPoints(Range.START_TO_END,c)>0;){if(e.nodeType==3){if(e.nodeValue.length>b)break;l=e.nextSibling}else if(e.nodeType==1)l=b<e.childNodes.length?e.childNodes[b]:e.nextSibling;else break;g=null;if(!l){l=e.parentNode;if(l.nodeType==3)g=l.nodeValue.length;else if(l.nodeType==1)g=l.childNodes.length}if(!this.canStepIntoNode(l))break;if(g===null)g=0;e=l;b=g;c.setStart(e,b)}c.compareBoundaryPoints(Range.START_TO_END,c)<=0&&c.setEnd(f,h);a.setRng(c)}},
isInitialTextNode:function(a){if(a.nodeType!=3)return false;for(a=a.prevSibling;a!=null;){if(a.nodeType!=3||a.nodeValue!="")return false;a=a.prevSibling}return true},isTerminalTextNode:function(a){if(a.nodeType!=3)return false;for(a=a.nextSibling;a!=null;){if(a.nodeType!=3||a.nodeValue!="")return false;a=a.nextSibling}return true},isAtTheBeginningOf:function(a){if(!this.editor.selection.isCollapsed()||!d(this.editor.selection.getNode()).closest(a).length>0)return false;var c=this.editor.selection.getRng(true);
if(c.startOffset!=0||!this.isInitialTextNode(c.startContainer))return false;for(c=this.editor.selection.getNode();!d(c).is(a);){if(d(c).prev().size()>0)return false;c=c.parentNode}return true},isAtTheEndOf:function(a){if(!this.editor.selection.isCollapsed()||!d(this.editor.selection.getNode()).closest(a).length>0)return false;var c=this.editor.selection.getRng(true);if(c.endContainer.length!=c.endOffset||!this.isTerminalTextNode(c.endContainer))return false;for(c=this.editor.selection.getNode();!d(c).is(a);){if(d(c).next().size()>
0)return false;c=c.parentNode}return true},mineOrParentsNextSibling:function(a,c){return d(a).next().size()==0&&a.parentNode?this.mineOrParentsNextSibling(a.parentNode,c):d(a).next().is(c)},isInFrontOf:function(a){if(!this.editor.selection.isCollapsed())return false;var c=this.editor.selection.getRng(true);if(c.endContainer.nodeType!=3||c.endContainer.length!=c.endOffset)return false;return d(c.endContainer.nextSibling).is(a)?true:this.mineOrParentsNextSibling(this.editor.selection.getNode(),a)},
selectedElements:function(a){var c=this.editor.selection.getRng(true),e=c.endContainer.nodeType!=1?c.endContainer.parentNode:c.endContainer;c=c.startContainer.nodeType!=1?c.startContainer.parentNode:c.startContainer;for(var b=[];c!=null;){d(c).is(a)&&b.push(c);if(c==e)break;if(d(c).has(e).size()>0){d(c).find("*").each(function(){d(this).is(a)&&b.push(this);if(this==e)return false});break}d(c).find(a).each(function(){b.push(this)});c=d(c).next().size()>0?d(c).next().get(0):d(c).parents().next().get(0)}return b},
normalizeOutsideLinks:function(){var a=this.editor.selection.getRng(true),c=a.startContainer;if(c.nodeType==3)c=c.parentNode;d(c).is("a")&&a.setStartBefore(c);c=a.endContainer;if(c.nodeType==3)c=c.parentNode;d(c).is("a")&&a.setEndAfter(c);this.editor.selection.setRng(a)},contentBefore:function(){var a=this.editor.selection.getRng(true),c=a.cloneRange();c.collapse(true);c.insertNode(d("<span>",this.editor.getDoc()).attr("id","_CB").get(0));c=this.editor.getContent({format:"raw",no_events:1});d("#_CB",
this.editor.getDoc()).remove();this.editor.selection.setRng(a);return(a=c.match(/<span id="_CB"/i))?c.substring(0,a.index):""},contentAfter:function(){var a=this.editor.selection.getRng(true),c=a.cloneRange();c.collapse(false);c.insertNode(d("<span>",this.editor.getDoc()).attr("id","_CB").get(0));c=this.editor.getContent({format:"raw",no_events:1});d("#_CB",this.editor.getDoc()).remove();this.editor.selection.setRng(a);return(a=c.match(/<span id="_CB".*?\/span>/i))?c.substr(a.index+a[0].length):""},
withinCode:function(){return d(this.editor.selection.getStart()).closest("pre").size()>0||d(this.editor.selection.getEnd()).closest("pre").size()>0},withinMath:function(){var a=/\[\[math\]\]/g,c=this.contentBefore().match(a);a=this.contentAfter().match(a);return c&&c.length%2!=0||a&&a.length%2!=0}});k.PluginManager.add("wsselection",wikispaces.plugins.SelectionPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.StylePlugin",{firstTime:true,init:function(a){var c=this;this.editor=a;a.addCommand("wsStyle",function(){WikispacesCommon.track("Editor","Open Style Tool");var e=a.selection;if(d(e.getNode()).closest("pre").length)alert("You cannot apply a style inside of a code block.");else{var b=c.getSelectedSpan(e);e=c.getSelectedDiv(e);k.mainEditor.plugins.wspopup.show("stylePopupContents",{plugin:c,span:b,div:e})}});a.addButton("wsstyle",{title:"Style Text",onclick:function(){k.activeEditor.wsExecCommand("wsStyle")}});
a.onNodeChange.add(function(e,b,f){WikispacesContent.isLoaded&&b.setDisabled("wsstyle",e.wsselection&&e.wsselection.withinCode());b.setActive("wsstyle",d(f).closest("span,div,font,strike,s").length>0)});a.plugins.wscommon.disableUntilLibsLoad(a,"wsstyle")},getInfo:function(){return{longname:"Wikispaces style",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},applyStyle:function(){WikispacesCommon.track("Editor","Apply Style");var a=d(document.styleForm.styleText).val(),
c=k.activeEditor;c.wsselection.restore();if(c.selection.isCollapsed()){var e=d(c.selection.getNode()).closest("span").get(0);if(e){c.selection.setContent('<span id="splitter">\ufeff</span>');var b=d("#splitter",c.getDoc()).removeAttr("id").get(0);c.dom.split(e,b);c.selection.select(b,true);if(!k.isWebKit){c.selection.collapse();d(b).remove()}}}else this.removeStyle();e=c.dom.parseStyle(a);if(e["text-align"]&&e["text-align"]!="auto"){a=d(c.selection.getNode()).closest("div,p,td,th,li,h1,h2,h3,h4,h5,h6");
if(a.length){if(!a.is("div")){b=c.selection.getBookmark();div=d("<div>",c.getDoc());a.wrapInner("<div>");a=a.children("div").eq(0);c.selection.moveToBookmark(b)}a.css("text-align",e["text-align"]);delete e.display;delete e["text-align"]}}else if(!e["text-align"]||e["text-align"]=="auto")d(c.selection.getNode()).closest("div,p,td,th,li,h1,h2,h3,h4,h5,h6").css("text-align","");a="";for(var f in e)a+=f+": "+e[f]+";\n";if(a){if(c.selection.isCollapsed()&&k.isIE)return this.applyCaretStyleIE(c,a);c.formatter.register("ws_style",
{inline:"span",styles:e});c.formatter.apply("ws_style")}},applyCaretStyleIE:function(a,c){var e=a.dom.uniqueId(),b=a.getDoc(),f=b.selection.createRange();a.selection.setContent(d("<div>").append(d("<span>").attr("style",c).attr("id",e).text("\ufeff")).html());f.moveToElementText(d("#"+e,b)[0]);f.select()},removeStyle:function(){var a=k.activeEditor;a.wsselection.restore(true);a.formatter.remove("wsremoveformat",null,null);a.nodeChanged()},setSpanText:function(a){if(a)if(a=d(a).attr("style")){var c=
this;document.styleForm.removeStyleButton.disabled=false;d.each(k.activeEditor.dom.parseStyle(a),function(e,b){"function"!=typeof b&&c.setSpanTextValue(e,b)})}},setSpanTextValue:function(a,c){var e=WikispacesCommon.normalizeCssSelector(a);log("setting "+a+" as "+e+" with "+c);switch(e){case "fontSize":d(document.styleForm.styleSize).val(c);break;case "fontFamily":c=c.replace(/,\s*/gi,", ");d(document.styleForm.styleFont).val(c);break;case "color":c=(new RGBColor(c)).toHex().toUpperCase();d(document.styleForm.styleColor).val(c);
d.farbtastic("#colorpickerColor").setColor(c);break;case "backgroundColor":c=(new RGBColor(c)).toHex().toUpperCase();d(document.styleForm.styleBackgroundColor).val(c);d.farbtastic("#colorpickerBackgroundColor").setColor(c);break;case "textAlign":d(document.styleForm.styleAlignment).val(c);break;case "verticalAlign":d(document.styleForm.styleVertical).val(c);if(d(document.styleForm.styleVertical).val()!=c){a=d("<option>").val(c).html(c);d(document.styleForm.styleVertical).append(a);d(document.styleForm.styleVertical).val(c)}break;
case "textDecoration":if(c=="line-through"||c=="lineThrough")d(document.styleForm.styleStrike).attr("checked",true);break;case "accelerator":case "csstext":case "cssText":break;default:d(document.styleForm.styleText).val(d(document.styleForm.styleText).val()+"\n"+a+": "+c+";")}},getUsedColors:function(){var a=[];d.each(k.editors,function(){d(this.dom.select("span,div")).each(function(){var c=d(this);if(c.css("color")&&c.css("color")!="transparent")a[a.length]=(new RGBColor(c.css("color"))).toHex().toUpperCase();
if(c.css("backgroundColor")&&c.css("backgroundColor")!="transparent")a[a.length]=(new RGBColor(c.css("backgroundColor"))).toHex().toUpperCase()})});return a},getSelectedDiv:function(a){a.getRng(true).cloneContents();var c=null;c||(c=d(a.getNode()).closest("div").get(0));return c},getSelectedSpan:function(a){for(var c=a.getRng(true).cloneContents(),e=null,b=0;b<c.childNodes.length;++b){var f=c.childNodes[b];if(!(f.nodeType==3&&(f.nodeValue==""||f.nodeValue=="\ufeff"))){if(f.nodeType!=1||e){e=null;
break}e=f}}e||(e=d(a.getNode()).closest("span,font,strike,s").get(0));if(e&&e.nodeName.toLowerCase().match(/^(font|strike|s)$/)){a=e.nodeName.toLowerCase();if(a=="s")a="strike";c=k.explode(k.settings.font_size_style_values);c={font:{backgroundColor:e.style.backgroundColor,color:e.color,fontFamily:e.face,fontSize:c[parseInt(e.size)-1]},strike:{textDecoration:"line-through"}};this.editor.wsselection.restore();this.editor.wsselection.save();a=this.editor.dom.create("span",{style:c[a]});this.editor.dom.replace(a,
e,1);this.editor.wsselection.restore(true);e=a}return e}});k.PluginManager.add("wsstyle",wikispaces.plugins.StylePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.Style",{plugin:null,currentColorInput:null,init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"stylePopupContents",title:"Color and Style",width:680,height:400,wsselection:0,onShow:function(e){c.onShow(e)},uiSetup:function(e){c.uiSetup(e)}})},onShow:function(a){this.setPlugin(a.plugin);this.resetSpanText();var c=[];if(a.plugin){a.plugin.setSpanText(a.div);a.plugin.setSpanText(a.span);c=this.dedupeColors(a.plugin.getUsedColors())}this.setupSwatches(this.getStyleColors(c));
this.mergeBasicStyleToAdvanced();this.updatePreviewStyle();this.editor.selection.isCollapsed()?d("#removeStyleButton").hide():d("#removeStyleButton").show()},setPlugin:function(a){this.plugin=a},resetSpanText:function(){this.resetSpanStyleSize();this.resetSpanStyleFont();this.resetSpanStyleColor();this.resetSpanStyleBackgroundColor();this.resetSpanStyleAlignment();this.resetSpanStyleVertical();this.resetSpanStyleStrike();d(document.styleForm.styleText).val("")},resetSpanStyleSize:function(){d(document.styleForm.styleSize).val("100%")},
resetSpanStyleFont:function(){d(document.styleForm.styleFont).val("")},resetSpanStyleColor:function(){d.farbtastic("#colorpickerColor").setColor("#000000");d(document.styleForm.styleColor).val("")},resetSpanStyleBackgroundColor:function(){d.farbtastic("#colorpickerBackgroundColor").setColor("#FFFFFF");d(document.styleForm.styleBackgroundColor).val("")},resetSpanStyleAlignment:function(){d(document.styleForm.styleAlignment).val("")},resetSpanStyleVertical:function(){d(document.styleForm.styleVertical).val("")},
resetSpanStyleStrike:function(){d(document.styleForm.styleStrike).attr("checked",false)},mergeAdvancedStyleToBasic:function(){var a=d(document.styleForm.styleText).val(),c;(c=a.match(/^\s*font-size:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("font-size",c[1]):this.resetSpanStyleSize();(c=a.match(/^\s*font-family:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("font-family",c[1]):this.resetSpanStyleFont();(c=a.match(/^\s*color:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("color",c[1]):this.resetSpanStyleColor();
(c=a.match(/^\s*background-color:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("background-color",c[1]):this.resetSpanStyleBackgroundColor();(c=a.match(/^\s*text-align:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("text-align",c[1]):this.resetSpanStyleAlignment();(c=a.match(/^\s*vertical-align:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("vertical-align",c[1]):this.resetSpanStyleVertical();(c=a.match(/^\s*text-decoration:\s*(.+?);*\s*$/mi))?this.plugin.setSpanTextValue("text-decoration",
c[1]):this.resetSpanStyleStrike()},updatePreviewStyle:function(){d(".styleBasic").css("display")!="none"&&this.mergeBasicStyleToAdvanced();var a=d.trim(document.styleForm.styleText.value).replace(/;?\n/gmi,"; ");d("#stylePreviewApplied").attr("style",a)},mergeBasicStyleToAdvanced:function(){var a=d(document.styleForm.styleText).val(),c=d(document.styleForm.styleSize).val(),e=d(document.styleForm.styleFont).val(),b=d(document.styleForm.styleColor).val(),f=d(document.styleForm.styleBackgroundColor).val(),
h=d(document.styleForm.styleAlignment).val(),g=d(document.styleForm.styleVertical).val(),l=d(document.styleForm.styleStrike).attr("checked");a=c&&c!="100%"?a.match(/^\s*font-size:\s*.*$/gmi)?a.replace(/^\s*font-size:\s*.*$/gmi,"font-size: "+c+";"):a+"\nfont-size: "+c+";":a.replace(/^\s*font-size:\s*.*$/gmi,"");a=e?a.match(/^\s*font-family:\s*.*$/gmi)?a.replace(/^\s*font-family:\s*.*$/gmi,"font-family: "+e+";"):a+"\nfont-family: "+e+";":a.replace(/^\s*font-family:\s*.*$/gmi,"");a=b?a.match(/^\s*color:\s*.*$/gmi)?
a.replace(/^\s*color:\s*.*$/gmi,"color: "+b+";"):a+"\ncolor: "+b+";":a.replace(/^\s*color:\s*.*$/gmi,"");a=f?a.match(/^\s*background-color:\s*.*$/gmi)?a.replace(/^\s*background-color:\s*.*$/gmi,"background-color: "+f+";"):a+"\nbackground-color: "+f+";":a.replace(/^\s*background-color:\s*.*$/gmi,"");if(h){a=a.match(/^\s*text-align:\s*.*$/gmi)?a.replace(/^\s*text-align:\s*.*$/gmi,"text-align: "+h+";"):a+"\ntext-align: "+h+";";a.match(/^\s*display:\s*block;\s*$/gmi)||(a+="\ndisplay: block;")}else{a=
a.replace(/^\s*text-align:\s*.*$/gmi,"");a=a.replace(/^\s*display:\s*block;\s*$/gmi,"")}a=g?a.match(/^\s*vertical-align:\s*.*$/gmi)?a.replace(/^\s*vertical-align:\s*.*$/gmi,"vertical-align: "+g+";"):a+"\nvertical-align: "+g+";":a.replace(/^\s*vertical-align:\s*.*$/gmi,"");if(l)if(a.match(/^\s*text-decoration:\s*.*$/gmi))a=a.replace(/^\s*text-decoration:\s*.*$/gmi,"text-decoration: line-through;");else a+="\ntext-decoration: line-through;";else a=a.replace(/^\s*text-decoration:\s*.*$/gmi,"");d(document.styleForm.styleText).val(d.trim(a))},
dedupeColors:function(a){a.sort();for(var c=[],e=null,b=0;b<a.length;b++){if(a[b]!=e)c[c.length]=a[b];e=a[b]}return c},getBasicColors:function(){return["#000000","#404040","#808080","#C0C0C0","#FFFFFF","#FF0000","#00FF00","#0000FF","#FFFF00","#00FFFF","#FF00FF","#800000","#008000","#000080","#808000","#008080","#800080"]},getStyleColors:function(a){for(var c=this.getBasicColors(),e=0;e<a.length;e++){for(var b=false,f=0;f<c.length;f++)if(a[e]==c[f]){b=true;break}b||(c[c.length]=a[e])}return c},setupSwatches:function(a){var c=
this;d("#styleColors").empty();for(var e={"float":"left",margin:"3px",width:"20px",height:"15px",cursor:"crosshair",border:"1px black solid"},b=0;b<a.length;b++){var f=document.createElement("div");e["background-color"]=a[b];d(f).css(e);d(f).attr("title",a[b]);d(f).click(function(h){c.chooseStyleColor(d(this).css("backgroundColor"));h.preventDefault()});d("#styleColors").append(f)}},chooseStyleColor:function(a){if(a=(new RGBColor(a)).toHex().toUpperCase()){var c=this.currentColorInput.name;d.farbtastic("#colorpicker"+
c.substring(5)).setColor(a);document.styleForm[c].focus()}},adjustFont:function(a){var c=d(document.styleForm.styleSize).val();if(c.match(/%\s*$/gi)){c=parseInt(c);c+=a;d(document.styleForm.styleSize).val(c+"%")}this.updatePreviewStyle()},uiSetup:function(a){var c=this;d("#switchToAdvanced").click(function(){c.hideColorPickers();c.mergeBasicStyleToAdvanced();d("#stylePopupContents .styleAdvanced").show();d("#stylePopupContents .styleBasic").hide();return false});d("#switchToBasic").click(function(){c.mergeAdvancedStyleToBasic();
d("#stylePopupContents .styleAdvanced").hide();d("#stylePopupContents .styleBasic").show();return false});d("#styleAdvancedTextarea").keyup(function(){c.updatePreviewStyle()});d("#styleAdvancedTextarea").change(function(){c.updatePreviewStyle()});d("#styleFont").focus(function(){c.hideColorPickers()});d("#styleFont").change(function(){c.updatePreviewStyle()});d("#sizeDown").click(function(){c.hideColorPickers();c.adjustFont(-10);return false});d("#styleSize").focus(function(){c.hideColorPickers()});
d("#styleSize").keyup(function(){c.updatePreviewStyle()});d("#sizeUp").click(function(){c.hideColorPickers();c.adjustFont(10);return false});d("#styleColor").focus(function(){c.hideColorPickers();d("#colorpickerColor").show();d("#styleColors").show();c.currentColorInput=this});d("#styleColor").focus(function(){c.updatePreviewStyle()});d("#styleBackgroundColor").focus(function(){c.hideColorPickers();d("#colorpickerBackgroundColor").show();d("#styleColors").show();c.currentColorInput=this});d("#styleBackgroundColor").focus(function(){c.updatePreviewStyle()});
d("#styleAlignment").focus(function(){c.hideColorPickers()});d("#styleAlignment").change(function(){c.updatePreviewStyle()});d("#styleVertical").focus(function(){c.hideColorPickers()});d("#styleVertical").change(function(){c.updatePreviewStyle()});d("#styleStrike").focus(function(){c.hideColorPickers()});d("#styleStrike").click(function(){c.updatePreviewStyle()}).change(function(){c.updatePreviewStyle()});var e=function(){k.activeEditor.focus();a.close();return false};d("#applyStyleButton").click(function(){d("#stylePopupContents .styleBasic").is(":visible")&&
c.mergeBasicStyleToAdvanced();c.plugin.applyStyle();return e()});d("#removeStyleButton").click(function(){c.plugin.removeStyle();return e()});d("#styleCancel").click(e);d("#colorpickerColor").farbtastic(function(b){c.farbtasticCallback.call(this,b,document.styleForm.styleColor);c.updatePreviewStyle()});d("#colorpickerBackgroundColor").farbtastic(function(b){c.farbtasticCallback.call(this,b,document.styleForm.styleBackgroundColor);c.updatePreviewStyle()})},farbtasticCallback:function(a,c){d(c).css({backgroundColor:a,
color:this.hsl[2]>0.5?"#000":"#fff"});d(c).each(function(){this.value=a})},hideColorPickers:function(){d("#colorpickerColor").hide();d("#colorpickerBackgroundColor").hide();d("#styleColors").hide()}});k.PluginManager.add("wsstylepopup",wikispaces.popups.Style)})(tinymce,jQuery);
(function(k){k.create("wikispaces.plugins.SubEditorPlugin",{init:function(d){this.editor=d;d.onInitSubEditor=new k.util.Dispatcher(d);this.plugins=d.getParam("wssubeditor_plugins");this.options=d.getParam("wssubeditor_options");var a=this.options.setup,c=function(b){b.onInit.add(function(f){d.onInitSubEditor.dispatch(f)})};this.options.setup=a?function(b){a(b);c(b)}:c;var e=this;d.addCommand("wssubeditor",function(){e.create()})},getInfo:function(){return{longname:"Wikispaces sub editor",author:"Tangient LLC",
authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},create:function(d,a,c){this.options.elements=d;this.options.plugins=c?c:this.plugins;k.init(jQuery.extend({},this.options,a));return k.editors[d]}});k.PluginManager.add("wssubeditor",wikispaces.plugins.SubEditorPlugin)})(tinymce);
(function(k,d){k.create("wikispaces.plugins.TablePlugin",{init:function(a){function c(b,f){var h=f.ownerDocument,g=h.createRange();g.setStartBefore(f);g.setEnd(b.endContainer,b.endOffset);b=h.createElement("body");b.appendChild(g.cloneContents());g=b.innerHTML.replace(/<(br|img)[^>]*>/gi,"-");g=g.replace(/<table[^>]*>\s*(<tbody[^>]*>\s*)?(<tr[^>]*>\s*|(<tr[^>]*>\s*)?<t(d|h)[^>]*>)/g,"");g=g.replace(/<[^>]+>/g,"");return g.length==0}var e=this;this.editor=a;this.emptyCellContents=k.isIE?"&nbsp;":"<br/>";
a.addCommand("wsTable",function(){if(!a.dom.getParent(a.selection.getNode(),"TABLE,UL,OL")){k.mainEditor.plugins.wspopup.show("tablePopupContents",{plugin:e});d("#tablePopupContents input").first().focus()}});a.addButton("wstable",{title:"Insert Table",label:"Table",onclick:function(){k.activeEditor.wsExecCommand("wsTable");WikispacesCommon.track("Editor","Open Table Tool")}});a.onNodeChange.add(function(b,f,h){h=b.selection.getStart();if(!(h&&!d(h).parents().andSelf().is(".mceContentBody"))){f=b.dom.getParent(h,
"td,th");var g=h.nodeName==="TABLE"||!!f;if(WikispacesEditor.getMode()=="visual"){b.theme.controlManager().setActive("wstable",g);b.theme.controlManager().setDisabled("wstable",d(h).parents().is("ol,ul"))}else{b.theme.controlManager().setActive("wstable",false);b.theme.controlManager().setDisabled("wstable",false)}f&&!d(h).is("img")&&WikispacesEditor.getMode()=="visual"?k.mainEditor.plugins.wstableoverlay.selectTableCell(f):k.mainEditor.plugins.wstableoverlay.unselectTableCell()}});a.onInit.add(function(b){if(!k.isIE){var f=
function(){var h;for(h=b.getBody().lastChild;h&&h.nodeType==3&&!h.nodeValue.length;h=h.previousSibling);h&&h.nodeName=="TABLE"&&b.dom.add(b.getBody(),"p",null,'<br mce_bogus="1" />')};k.isGecko&&b.onKeyDown.add(function(h,g){var l,o,p=h.dom;if(g.keyCode==37||g.keyCode==38){l=h.selection.getRng();if((o=p.getParent(l.startContainer,"table"))&&h.getBody().firstChild==o)if(c(l,o)){l=p.createRng();l.setStartBefore(o);l.setEndBefore(o);h.selection.setRng(l);g.preventDefault()}}});b.onKeyUp.add(f);b.onSetContent.add(f);
b.onVisualAid.add(f);b.onPreProcess.add(function(h,g){(g=g.node.lastChild)&&g.childNodes.length==1&&g.firstChild.nodeName=="BR"&&h.dom.remove(g)});f()}});a.onKeyDown.addToTop(function(b,f){if(!(!k.mainEditor.plugins.wstableoverlay.selectedTableCell||f.ctrlKey||f.altKey)){if(f.keyCode=="9"){var h=d(k.mainEditor.plugins.wstableoverlay.selectedTableCell),g;if(f.shiftKey){g=h.prev("td,th");if(g.length==0&&h.parents("tr").eq(0).prev("tr").length>0)g=h.parents("tr").eq(0).prev("tr").find("td,th").eq(h.parents("tr").eq(0).prev("tr").find("td,th").length-
1);if(!g.length){k.mainEditor.plugins.wstableoverlay.addNewRow(false,true);g=h.parents("tr").eq(0).prev("tr").find("td,th").eq(h.parents("tr").eq(0).prev("tr").find("td,th").length-1)}}else{g=h.next("td,th");if(g.length==0&&h.parents("tr").eq(0).next("tr").length>0)g=h.parents("tr").eq(0).next("tr").find("td,th").eq(0);if(!g.length){k.mainEditor.plugins.wstableoverlay.addNewRow(false,false);g=h.parents("tr").eq(0).next("tr").find("td,th").eq(0)}}if(g.length){g=g.get(0);b.selection.select(g,true);
b.selection.collapse(true);k.mainEditor.plugins.wstableoverlay.selectTableCell(g);k.activeEditor.undoManager.add();f.preventDefault();f.stopPropagation()}}if(k.isWebKit&&(f.keyCode==8||f.keyCode==46)){f=d(b.selection.getNode()).closest("li:first-child");if(f.size()>0&&f.text()==""){b.undoManager.begin();h=f.parent();f.remove();h.children().size()==0&&h.remove();span=d("<span>",b.getDoc()).prependTo(k.mainEditor.plugins.wstableoverlay.selectedTableCell);b.plugins.wscommon.cursorToAndRemoveElement(span);
b.undoManager.end()}}}});a.plugins.wscommon.disableUntilLibsLoad(a,"wstable")},getInfo:function(){return{longname:"Wikispaces table",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},addTable:function(a,c){WikispacesCommon.track("Editor","Add Table",a+"x"+c);if(isNaN(a)||a<1)a=1;if(isNaN(c)||c<1)c=1;for(var e='<table class="wiki_table" id="__newTable__">\n',b=0;b<a;b++){e+="<tr>\n";for(var f=0;f<c;f++)e+="<td>"+this.emptyCellContents+"</td>\n";
e+="</tr>\n"}e+="</table>\n";a=this.editor;a.wsselection.setContent(e);e=a.dom.select("#__newTable__")[0];a.dom.split(d(e).closest("p,div,h1,h2,h3,h4,h5,h6")[0],e);e=a.dom.select("#__newTable__")[0];a.dom.setAttrib(e,"id",null);c=a.dom.select("td",e);for(i=0;i<c.length;i++){d(c[i]).height()<20&&d(c[i]).height(20);d(c[i]).width()<5&&d(c[i]).width(5)}e=a.dom.select("td",e)[0];a.selection.select(e.firstChild);a.selection.collapse(true);a.controlManager.setDisabled("table",true);a.controlManager.setActive("table",
true);k.mainEditor.plugins.wstableoverlay.selectTableCell(e);k.mainEditor.controlManager.setActive("wstable",true)}});k.PluginManager.add("wstable",wikispaces.plugins.TablePlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.TableOverlay",{selectedTableCell:null,init:function(a){var c=this;a.onModeSwitch.add(function(e){e=="plain"&&c.hide()});d(window).resize(function(){c.selectedTableCell&&d(c.selectedTableCell).is(":visible")&&c.show(a,c.selectedTableCell)});this.emptyCellContents=k.isIE?"&nbsp;":"<br/>"},show:function(a,c){this.editor=a;this.cell=c;if(!this.menuHandleLoaded){d("#pageEditor").append(WikispacesContent.loadContent("tableMenu"));this.setupMenu();this.menuHandleLoaded=
true}d("#tablePropertiesMenuHandle").css({position:"absolute",left:"-10000px",top:"-10000px"}).addClass("overlayLayer").show();d("#tableProperties").hide();a=this.editor.plugins.wscommon.getPositionWith(d("#tablePropertiesMenuHandle").get(0),d(this.cell).get(0),2);d("#tablePropertiesMenuHandle").css(a);this.updateMenu(c)},showProperties:function(){d("#tableProperties").css({position:"absolute",left:"-10000px",top:"-10000px"}).addClass("overlayLayer").show();d("#tablePropertiesMenuHandle").hide();
var a=this.editor.plugins.wscommon.getPositionWith(d("#tableProperties").get(0),d(this.cell).get(0),2);d("#tableProperties").css(a)},hide:function(){d("#tablePropertiesMenuHandle").hide();d("#tableProperties").hide()},updateMenu:function(a){if(d(a).is("td")){d("#tablePropertiesList .headerToggleLabel").text("Make Header");d("#tablePropertiesList .alignmentMenu").not(".tableAlignmentMenu").removeClass("disabledMenu")}else{d("#tablePropertiesList .headerToggleLabel").text("Remove Header");d("#tablePropertiesList .alignmentMenu").not(".tableAlignmentMenu").addClass("disabledMenu")}d(a).attr("colspan")>
1?d("#tablePropertiesList .mergeSplit").removeClass("disabledMenu"):d("#tablePropertiesList .mergeSplit").addClass("disabledMenu");d(a).prev("td,th").length>0?d("#tablePropertiesList .mergeLeft").removeClass("disabledMenu"):d("#tablePropertiesList .mergeLeft").addClass("disabledMenu");d(a).next("td,th").length>0?d("#tablePropertiesList .mergeRight").removeClass("disabledMenu"):d("#tablePropertiesList .mergeRight").addClass("disabledMenu")},tablePropertiesShow:function(a,c){a.is("ul")&&a.is(":visible")&&
a.slideUp("fast");if(a.is("ul")&&!a.is(":visible")){d(c).slideUp("fast");a.slideDown("fast")}},getScope:function(a){var c;a=d(a);if(a.is("#cellItem")||a.parents("#cellItem").length)c="Cell";else if(a.is("#rowItem")||a.parents("#rowItem").length)c="Row";else if(a.is("#colItem")||a.parents("#colItem").length)c="Col";else if(a.is("#tableItem")||a.parents("#tableItem").length)c="Table";return c},setupMenu:function(){var a=this;d("#tablePropertiesMenuHandle").click(function(c){c.stopPropagation();d("#tablePropertiesList ul").hide();
a.showProperties();return false});d("#tablePropertiesList ul").hide();d("#tablePropertiesList .topmenu").click(function(c){c.stopPropagation();a.tablePropertiesShow(d(this).next(),"#tablePropertiesList li ul:visible");return false});d("#tablePropertiesList .submenu").click(function(c){c.stopPropagation();a.tablePropertiesShow(d(this).next(),"#tablePropertiesList li ul li ul:visible");return false});d("#cellItem, #rowItem, #colItem, #tableItem").mouseover(function(){var c="highlight"+a.getScope(this);
a[c]("highlightTableCell");return true});d("#cellItem, #rowItem, #colItem, #tableItem").mouseout(function(){a.removeHighlight();return true});d("#tableProperties .mergeMenu li").mouseover(function(){var c,e;switch(d(this).attr("class")){case "mergeLeft":e=true;c="highlight"+a.getScope(this)+"ForMerge";break;case "mergeRight":e=false;c="highlight"+a.getScope(this)+"ForMerge";break;case "mergeUp":e=true;c="highlight"+a.getScope(this)+"ForRowMerge";break;case "mergeDown":e=false;c="highlight"+a.getScope(this)+
"ForRowMerge";break}c&&a[c](e);return true});d("#tableProperties .mergeMenu li").mouseout(function(){a.removeHighlight("highlightTableCellForMerge");return true});d("#tableProperties .mergeMenu li").click(function(){var c,e;switch(d(this).attr("class")){case "mergeLeft":e=true;c="merge"+a.getScope(this);break;case "mergeRight":e=false;c="merge"+a.getScope(this);break;case "mergeUp":e=true;c="mergeRow"+a.getScope(this);break;case "mergeDown":e=false;c="mergeRow"+a.getScope(this);break;case "mergeSplit":e=
a.selectTableCell;c="splitCell";break}a[c](e);return false});d("#tableProperties .headerMenu").click(function(){var c="convert"+a.getScope(this)+"Type";a[c]();return false});d("#tableProperties .addMenu li").mouseover(function(){var c,e;switch(d(this).attr("class")){case "addPre":log("pre");e=true;c="addNew"+a.getScope(this);break;case "addPost":log("post");e=false;c="addNew"+a.getScope(this);break}a[c](true,e);return true});d("#tableProperties .addMenu li").mouseout(function(){a.removePreviews();
return true});d("#tableProperties .addMenu li").click(function(){var c,e;switch(d(this).attr("class")){case "addPre":e=true;c="addNew"+a.getScope(this);break;case "addPost":e=false;c="addNew"+a.getScope(this);break}a[c](false,e);return false});d("#tableProperties .alignmentMenu li").click(function(){var c="align"+a.getScope(this),e=d(this).attr("class");a[c](e);return true});d("#tableProperties .removeMenu").mouseover(function(){var c="highlight"+a.getScope(this)+"ForRemoval";a[c]();return true});
d("#tableProperties .removeMenu").mouseout(function(){a.removeHighlight("highlightTableCellForRemoval");return true});d("#tableProperties .removeMenu").click(function(){var c="remove"+a.getScope(this);a[c]();return false})},selectTableCell:function(a){log("selectTableCell",a);this.selectedTableCell=a;this.show(k.activeEditor,a)},unselectTableCell:function(){if(this.selectedTableCell){this.removeHighlight();this.selectedTableCell=null}this.hide()},highlightCell:function(a){this.selectedTableCell&&
d(this.selectedTableCell).addClass(a)},highlightCellForMerge:function(a){if(this.selectedTableCell)a?d(this.selectedTableCell).prev("td,th").addClass("highlightTableCellForMerge"):d(this.selectedTableCell).next("td,th").addClass("highlightTableCellForMerge")},highlightCellForRowMerge:function(a){if(this.selectedTableCell){var c=this.getColumnNumber(this.selectedTableCell);a?this.getColumnInPosition(d(this.selectedTableCell).parent().prev("tr").children("td,th"),c).addClass("highlightTableCellForMerge"):
this.getColumnInPosition(d(this.selectedTableCell).parent().next("tr").children("td,th"),c).addClass("highlightTableCellForMerge")}},convertCells:function(a,c){var e=this.editor.getDoc();this.removeHighlight();this.editor.undoManager.begin();d(a).each(function(){var b=parseInt(d(this).attr("colspan")),f=e.createElement(c);d(f).attr("colspan",b);d(f).html(d(this).html());d(this).replaceWith(f);this==this.selectedTableCell&&this.selectTableCell(f)});this.editor.undoManager.end();this.unselectTableCell()},
convertCellType:function(){this.convertCells(this.selectedTableCell,d(this.selectedTableCell).is("td")?"th":"td")},convertColType:function(){var a=this.getColCells(this.getColumnNumber(this.selectedTableCell),false),c=d(this.selectedTableCell).is("td")?"th":"td";this.convertCells(a,c)},convertRowType:function(){var a=d(this.selectedTableCell).parent("tr").find("td,th"),c=d(this.selectedTableCell).is("td")?"th":"td";this.convertCells(a,c)},mergeCell:function(a){if(this.selectedTableCell){var c=this.editor.getDoc();
this.removeHighlight();this.removePreviews();this.editor.undoManager.begin();var e=parseInt(d(this.selectedTableCell).attr("colspan")>1?d(this.selectedTableCell).attr("colspan"):1);a?d(this.selectedTableCell).prev("td,th").remove():d(this.selectedTableCell).next("td,th").remove();a="td";if(d(this.selectedTableCell).is("th"))a="th";a=c.createElement(a);d(a).html(d(this.selectedTableCell).html());d(a).attr("colspan",e+1);d(this.selectedTableCell).replaceWith(a);this.editor.undoManager.end();e=d(a).parent("tr").eq(0);
c=c.createElement("tr");d(c).html(d(e).html());d(e).after(c);d(e).remove();this.unselectTableCell()}},splitCell:function(){if(this.selectedTableCell&&d(this.selectedTableCell).attr("colspan")>1){var a="td";if(d(this.selectedTableCell).is("th"))a="th";a="<"+a+">"+d(this.selectedTableCell).html()+"</"+a+">";for(var c=parseInt(d(this.selectedTableCell).attr("colspan"))-1,e=0;e<c;e++)a+="<td>"+this.emptyCellContents+"</td>";this.removeHighlight();this.removePreviews();this.editor.undoManager.begin();
d(this.selectedTableCell).replaceWith(a);this.editor.undoManager.end();this.unselectTableCell()}},highlightTable:function(a){this.selectedTableCell&&d(this.selectedTableCell).parents("table.wiki_table").eq(0).find("td,th").each(function(){d(this).addClass(a)})},highlightSelectedTable:function(){this.highlightTable("highlightTableCell")},highlightTableForRemoval:function(){this.highlightTable("highlightTableCellForRemoval")},highlightSelectedRow:function(){this.highlightRow("highlightTableCell")},
highlightRowForRemoval:function(){this.highlightRow("highlightTableCellForRemoval")},highlightRow:function(a){this.selectedTableCell&&d(this.selectedTableCell).parent("tr").eq(0).find("td,th").each(function(){d(this).addClass(a)})},getColumnNumber:function(a){var c=0;a=d(a).prevAll("td,th");for(var e=0;e<a.length;e++)c+=parseInt(d(a[e]).attr("colspan")>1?d(a[e]).attr("colspan"):1);return c},getColumnInPosition:function(a,c){for(var e=0;e<a.length;e++)if(this.getColumnNumber(a[e])>=c)return a[e]},
highlightSelectedCol:function(){this.highlightCol("highlightTableCell")},highlightColForRemoval:function(){this.highlightCol("highlightTableCellForRemoval")},highlightCol:function(a){if(this.selectedTableCell){var c=this.getColCells(this.getColumnNumber(this.selectedTableCell),false);d(c).each(function(){d(this).addClass(a)})}},removeHighlight:function(a){a?d(this.selectedTableCell).parents("table.wiki_table").find("."+a).each(function(){d(this).removeClass(a)}):d(this.selectedTableCell).parents("table.wiki_table").find(".highlightTableCell,.highlightTableCellForRemoval,.highlightTableCellForMerge").each(function(){d(this).removeClass("highlightTableCell").removeClass("highlightTableCellForRemoval").removeClass("highlightTableCellForMerge")})},
addNewRow:function(a,c){if(this.selectedTableCell){for(var e=0,b=d(this.selectedTableCell).parent("tr").eq(0).find("td,th"),f=0;f<b.length;f++)e+=parseInt(d(b[f]).attr("colspan")>1?d(b[f]).attr("colspan"):1);if(a)b='<tr class="tablePreview"><td colspan="'+e+'">'+this.emptyCellContents+"</td></tr>";else{b="<tr>";for(f=0;f<e;f++)b+="<td>"+this.emptyCellContents+"</td>";b+="</tr>";this.removeHighlight();this.removePreviews();this.editor.undoManager.begin()}c?d(this.selectedTableCell).parent("tr").eq(0).before(b):
d(this.selectedTableCell).parent("tr").eq(0).after(b);if(!a){this.editor.undoManager.end();this.unselectTableCell()}}},addNewCol:function(a,c){if(this.selectedTableCell){if(a)var e='<td class="tablePreview">&nbsp;&nbsp;&nbsp;&nbsp;</td>';else{e="<td>"+this.emptyCellContents+"</td>";this.removeHighlight();this.removePreviews();this.editor.undoManager.begin()}var b=this.getColumnNumber(this.selectedTableCell);if(!c){var f=parseInt(d(this.selectedTableCell).attr("colspan")>1?d(this.selectedTableCell).attr("colspan"):
1);b=b+f-1}b=this.getColCells(b,true);d(b).each(function(){c?d(this).before(e):d(this).after(e)});if(!a){this.editor.undoManager.end();this.unselectTableCell()}}},removeTable:function(){if(this.selectedTableCell){this.removeHighlight();this.editor.undoManager.begin();d(this.selectedTableCell).parents("table.wiki_table").eq(0).remove();this.editor.undoManager.end();this.unselectTableCell()}},removeCol:function(){if(this.selectedTableCell){var a=this.getColCells(this.getColumnNumber(this.selectedTableCell),
false);this.removeHighlight();this.editor.undoManager.begin();d(a).each(function(){d(this).remove()});this.editor.undoManager.end();this.unselectTableCell()}},removeRow:function(){if(this.selectedTableCell){this.removeHighlight();this.editor.undoManager.begin();d(this.selectedTableCell).parent("tr").eq(0).remove();this.editor.undoManager.end();this.unselectTableCell()}},alignCell:function(a){if(d(this.selectedTableCell).is("td")){this.removeHighlight();this.editor.undoManager.begin();d(this.selectedTableCell).css("text-align",
a);this.editor.undoManager.end();this.unselectTableCell()}},alignRow:function(a){var c=d(this.selectedTableCell).parent("tr").eq(0).find("td,th");this.removeHighlight();this.editor.undoManager.begin();d(c).each(function(){d(this).is("td")&&d(this).css("text-align",a)});this.editor.undoManager.end();this.unselectTableCell()},alignCol:function(a){var c=this.getColCells(this.getColumnNumber(this.selectedTableCell),false);this.removeHighlight();this.editor.undoManager.begin();d(c).each(function(){d(this).is("td")&&
d(this).css("text-align",a)});this.editor.undoManager.end();this.unselectTableCell()},alignTable:function(a){var c=d(this.selectedTableCell).parents("table.wiki_table").eq(0).find("td,th");this.removeHighlight();this.editor.undoManager.begin();d(c).each(function(){d(this).is("td")&&d(this).css("text-align",a)});this.editor.undoManager.end();this.unselectTableCell()},getColCells:function(a,c){if(this.selectedTableCell){for(var e=d(this.selectedTableCell).parents("table.wiki_table").eq(0).find("tr"),
b=[],f=0;f<e.length;f++)for(var h=d(e[f]).children(),g=0,l=0;l<h.length;l++){g+=parseInt(d(h[l]).attr("colspan")>1?d(h[l]).attr("colspan"):1);if(g>a){b[b.length]=h[l];break}else if(g>a&&c){b[b.length]=h[l-1];break}}return b}},removePreviews:function(){d(this.selectedTableCell).parents("table.wiki_table").find(".tablePreview").each(function(){d(this).remove()})}});k.PluginManager.add("wstableoverlay",wikispaces.plugins.TableOverlay)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.Table",{plugin:null,init:function(a){var c=this;a.plugins.wspopup.register({wsname:"tablePopupContents",title:"Insert Table",width:280,height:100,wsselection:0,onShow:function(e){c.onShow(e)},uiSetup:function(e){c.uiSetup(e)}})},setPlugin:function(a){this.plugin=a},onShow:function(a){this.setPlugin(a.plugin)},uiSetup:function(a){var c=this;d("#addTableButton").click(function(){c.plugin.addTable(document.insertTableForm.rows.value,document.insertTableForm.cols.value);
a.close()});d("#tableCancelLink").click(function(){a.close();return false})}});k.PluginManager.add("wstablepopup",wikispaces.popups.Table)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.ToolbarScrollPlugin",{init:function(a){var c=this;a.onInit.add(function(){d(".mceExternalToolbar").before('<div id="mceToolbarAnchor">');d(window).scroll(c.moveScroller);c.moveScroller()})},moveScroller:function(){var a=d(".mceExternalToolbar"),c=a.height();d(window).scrollTop()>d("#mceToolbarAnchor").offset().top-c?a.css({position:"fixed",top:"0px"}):a.css({position:"absolute",top:"-"+(c+4)+"px"});if(d("#menu_wsMainEditor_wsMainEditor_wssave_menu").is(":visible")){a=
d("#wsMainEditor_wssave_action");d("#menu_wsMainEditor_wsMainEditor_wssave_menu").css({left:Math.min(a.offset().left,d(window).scrollLeft()+d(window).width()-d("#menu_wsMainEditor_wsMainEditor_wssave_menu").width()-3)+"px",top:a.offset().top+a.outerHeight()+"px"})}if(d("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu").is(":visible")){a=d("#wsMainEditor_formatlistbox");d("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu").css({left:a.offset().left+"px",top:a.offset().top+a.outerHeight()+"px"})}},
getInfo:function(){return{longname:"Wikispaces toolbar scroll",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}}});k.PluginManager.add("wstoolbarscroll",wikispaces.plugins.ToolbarScrollPlugin)})(tinymce,jQuery);
(function(k){var d=k.util.Dispatcher;k.UndoManager=function(a){function c(){return k.trim(a.getContent({format:"raw",no_events:1}))}var e;return e={typing:0,onAdd:new d(e),onUndo:new d(e),onRedo:new d(e),undoData:[],currentLevel:null,redoData:[],nestLevel:0,getLevels:function(){var b=[],f=[];jQuery.each(this.undoData,function(){b.push(this.content)});jQuery.each(this.redoData,function(){f.push(this.content)});return[b,this.currentLevel.content,f]},begin:function(){this.add();++this.nestLevel},end:function(){--this.nestLevel;
this.add()},add:function(b){return k.mainEditor.plugins.wsundomain.add(a,b)},remove:function(){return k.mainEditor.plugins.wsundomain.remove(a)},undo:function(){return k.mainEditor.plugins.wsundomain.undo()},redo:function(){return k.mainEditor.plugins.wsundomain.redo()},clear:function(){return k.mainEditor.plugins.wsundomain.clear()},hasUndo:function(){return k.mainEditor.plugins.wsundomain.hasUndo()},hasRedo:function(){return k.mainEditor.plugins.wsundomain.hasRedo()},updateButtonState:function(){return k.mainEditor.plugins.wsundomain.updateButtonState()},
subAdd:function(b){if(this.nestLevel>0)return null;var f=a.settings;b=b||{};b.content=c();if(e.currentLevel&&e.currentLevel.content==b.content)return null;f.custom_undo_redo_levels&&e.redoData.length+e.undoData.length>f.custom_undo_redo_levels+1&&e.dropOldestUndo();b.bookmark=a.selection.getBookmark(2,true);e.clearRedo();e.undoData.push(e.currentLevel);e.currentLevel=b;e.onAdd.dispatch(e,b);a.isNotDirty=0;return b},subRemove:function(){if(this.nestLevel>0)return null;return e.undoData.pop()},beforeChange:function(){if(e.currentLevel)e.currentLevel.beforeBookmark=
a.selection.getBookmark(2,true)},clearRedo:function(){e.redoData=[]},dropOldestUndo:function(){return e.undoData.shift()},subUndo:function(){if(e.typing){e.add();e.typing=0}if(!e.subHasUndo())return null;e.redoData.push(e.currentLevel);e.currentLevel=e.undoData.pop();a.setContent(e.currentLevel.content,{format:"raw",no_events:true});a.selection.moveToBookmark(e.currentLevel.beforeBookmark);e.onUndo.dispatch(e,e.currentLevel);return e.currentLevel},subRedo:function(){if(!e.subHasRedo())return null;
e.undoData.push(e.currentLevel);e.currentLevel=e.redoData.pop();a.setContent(e.currentLevel.content,{format:"raw",no_events:true});a.selection.moveToBookmark(e.currentLevel.bookmark);e.onRedo.dispatch(e,e.currentLevel);return e.currentLevel},subClear:function(){e.undoData=[];e.currentLevel={content:c(),bookmark:a.selection.getBookmark(2,true)};e.redoData=[];e.typing=0},subHasUndo:function(){return e.undoData.length>0||e.typing},subHasRedo:function(){return e.redoData.length>0}}};k.create("wikispaces.plugins.UndoPlugin",
{init:function(a){a.onNodeChange.add(function(c){c.undoManager.updateButtonState()});a.onDeactivate.add(function(c){if(c.undoManager.typing){c.undoManager.add();c.undoManager.typing=0}});a.onInit.add(function(c){c.undoManager.subClear();k.mainEditor.plugins.wsundomain.removeEditor(c)});a.onKeyDown.add(function(c,e){e.keyCode==16||e.keyCode==17||e.keyCode==18||c.undoManager.updateButtonState()})}});k.PluginManager.add("wsundo",wikispaces.plugins.UndoPlugin)})(tinymce);
(function(k){k.create("wikispaces.plugins.UndoMainPlugin",{undoData:[],redoData:[],init:function(d){this.editor=d},add:function(d,a){a=d.undoManager.subAdd(a);if(!a)return null;this.clearRedo();var c=this.editor.settings;c.custom_undo_redo_levels&&this.undoData.length>c.custom_undo_redo_levels&&this.undoData.shift().undoManager.dropOldestUndo();this.undoData.push(d);this.updateButtonState();return a},remove:function(d){if(this.undoData.length==0)return null;var a=this.undoData.pop();if(a!=d){this.undoData.push(a);
return null}(d=a.undoManager.subRemove())||this.undoData.push(a);return d},undo:function(){if(k.activeEditor.undoManager.typing){this.add(k.activeEditor);k.activeEditor.undoManager.typing=0}if(!(this.undoData.length<=0)){var d=this.undoData.pop();if(d.destroyed)return this.undo();this.redoData.push(d);d.focus();d=d.undoManager.subUndo();this.updateButtonState();return d}},redo:function(){if(this.hasRedo()){var d=this.redoData.pop();this.undoData.push(d);d.focus();d=d.undoManager.subRedo();this.updateButtonState();
return d}},clear:function(){this.undoData=[];this.redoData=[];jQuery.each(k.editors,function(){this.undoManager.subClear()});this.updateButtonState()},clearRedo:function(){this.redoData=[];jQuery.each(k.editors,function(){this.undoManager.clearRedo()});this.updateButtonState()},hasUndo:function(){return this.undoData.length>0||k.activeEditor.undoManager.typing},hasRedo:function(){return this.redoData.length>0},updateButtonState:function(){var d=this.editor.controlManager;d.setDisabled("undo",!this.hasUndo());
d.setDisabled("redo",!this.hasRedo())},removeEditor:function(d){var a;jQuery.each([this.undoData,this.redoData],function(){for(var c=a=0;c<this.length;++c)if(this[c]==d)++a;else this[c-a]=this[c];this.length-=a});this.updateButtonState()}});k.PluginManager.add("wsundomain",wikispaces.plugins.UndoMainPlugin)})(tinymce);
(function(k,d){k.create("wikispaces.plugins.WidgetPlugin",{init:function(a){var c=this;c.editor=a;a.addCommand("wsWidget",function(){c.openWidget()});a.addButton("wswidget",{title:"Embed Widget",label:"Widget",onclick:function(){k.activeEditor.wsExecCommand("wsWidget")}});a.onNodeChange.add(function(e,b,f){if(WikispacesEditor.getMode()!="visual")e.theme.controlManager().setActive("wswidget",false);else{e.theme.controlManager().setDisabled("wswidget",e.plugins.wscommon.isCommentEditor());b=c.findWidgetPlaceholder(f);
e.theme.controlManager().setActive("wswidget",!!b);b?k.mainEditor.plugins.wswidgetoverlay.show(e,b):k.mainEditor.plugins.wswidgetoverlay.hide()}});a.onDblClick.add(function(e,b){e=null;if(e=c.findWidgetPlaceholder(b.target))c.openWidget(e)});a.onKeyPress.addToTop(function(e,b){if(b.keyCode==13){var f=e.selection.getNode();f=d(f).closest("pre,code");if(f.length){var h=false;if(k.isWebKit){if(f.text().substr(-1)!="\n")h=true;e.selection.setContent('\n<span id="wsHold"></span>')}else e.selection.setContent('<br/><span id="wsHold">\ufeff</span>');
e.plugins.wscommon.cursorToAndRemoveElement(d("#wsHold",e.getDoc()).get(0));if(h&&f.text().substr(-1)=="\n"){e.selection.setContent('\n<span id="wsHold"></span>');e.plugins.wscommon.cursorToAndRemoveElement(d("#wsHold",e.getDoc()).get(0))}b.preventDefault();b.stopPropagation();return false}}});a.plugins.wscommon.disableUntilLibsLoad(a,"wswidget")},getInfo:function(){return{longname:"Wikispaces widgets",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},
openWidget:function(a){a||(a=this.findWidgetPlaceholder(this.editor.selection.getNode()));if(!d(a).is(".WikiMediaToc, .WikiMediaTocFlat")){var c=a?a.id:"";this.selectedPlaceholder=a;WikispacesCommon.track("Editor","Open Media Tool");k.mainEditor.plugins.wspopup.show("mediaTool",{plugin:this,mediaString:c})}},insertWidget:function(a,c){WikispacesCommon.track("Editor","Add Media",c);if(this.selectedPlaceholder){d(this.selectedPlaceholder).replaceWith(a);k.mainEditor.plugins.wswidgetoverlay.hide()}else this.editor.wsselection.setContent(a)},
findWidgetPlaceholder:function(a){return d(a).is("img.WikiMedia")&&!d(a).hasClass("WikiMediaFile")?a:null},insertCharacter:function(a){WikispacesCommon.track("Editor","Add Character",a);k.activeEditor.wsselection.setContent(a)},insertToc:function(a){WikispacesCommon.track("Editor","Insert Toc",a);a?k.activeEditor.wsselection.setContent('<img id="wikitext@@toc@@flat" class="NewWikiMedia WikiMedia WikiMediaTocFlat" title="Table of Contents" src="'+window.location.protocol+"//www."+wikispaces_domain+
'/site/embedthumbnail/toc/flat?w=100&h=16"/>',"h1,h2,h3,h4,h5,h6"):k.activeEditor.wsselection.setContent('<img id="wikitext@@toc@@normal" class="NewWikiMedia WikiMedia WikiMediaToc" title="Table of Contents" src="'+window.location.protocol+"//www."+wikispaces_domain+'/site/embedthumbnail/toc/normal?w=225&h=100"/>',"h1,h2,h3,h4,h5,h6")},insertReference:function(){var a=k.mainEditor.plugins.wsreference.insertReferenceAtSelection();k.mainEditor.focus();setTimeout(function(){d.scrollTo(a.getContentAreaContainer(),
{axis:"y",duration:500});a.focus();a.wsselection.selectAll()},100)},insertReferences:function(){WikispacesCommon.track("Editor","Insert References");k.mainEditor.wsselection.setContent("\n&lt;references/&gt;")},insertCode:function(){var a=k.activeEditor,c=a.dom.encode(document.codeMediaForm.code.value);c=c.replace(/\r\n|\n|\r/g,"<br/>");var e=a.dom.encode(document.codeMediaForm.format.value);e||(e="text");WikispacesCommon.track("Editor","Add Code",e);a.wsselection.setContent('<pre id="wsTempPre" class="'+
e+'">'+c+"</pre>");c=d("#wsTempPre",a.getDoc());e=c.closest("p,div,h1,h2,h3,h4,h5,h6");e.length&&a.dom.split(e.get(0),c.get(0));c=d("#wsTempPre",a.getDoc());if(c.nextAll("p,div,h1,h2,h3,h4,h5,h6").length){a.selection.select(c.nextAll("p,div,h1,h2,h3,h4,h5,h6").get(0),true);a.selection.collapse(true)}c.removeAttr("id");document.codeMediaForm.reset();a.onNeedsResize.dispatch()}});k.PluginManager.add("wswidget",wikispaces.plugins.WidgetPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.popups.Widget",{previousSection:"wikispaces",currentMenu:"wikispaces",currentSection:"wikispaces",editor:null,plugin:null,COMMAND_URL_PARAM:"wikispacesCommandUrl",customPlugins:[],init:function(a){var c=this;c.editor=a;a.plugins.wspopup.register({wsname:"mediaTool",title:"Widgets",width:680,height:420,wsselection:0,onShow:function(e){c.onShow(e)},uiSetup:function(e){c.uiSetup(e)}});a.plugins.wspopup.register({wsname:"mediaPreview",title:"Widget Preview",width:340,
height:340,uiSetup:function(e){d("#closePreviewButton").click(function(){e.close()})}});this.registerPlugin({options:{id:"glogster",name:"Glogster",type:"media",category:"poster",logo:"/i/glogster_widget_160x70.jpg",url:"http://edu.glogster.com/?page=wiki_spaces&wikiaction=login",homepage_url:"http://edu.glogster.com",terms_url:"http://edu.glogster.com/terms-of-use"}})},setPlugin:function(a){this.plugin=a},onShow:function(a){this.setPlugin(a.plugin);this.resetMediaForms();if(a.plugin){a.plugin.editor.plugins.wsreference?
d("#referenceMediaMenuEntry").show():d("#referenceMediaMenuEntry").hide();wikispaces_isMain&&wikispaces_spaceName=="www"&&d("#includeTagCloudMediaMenuEntry, #includeEditorsMediaMenuEntry, #includeNavbarMediaMenuEntry, #includePageListMediaMenuEntry, #includeWikiListMediaMenuEntry").hide()}d("#mediaDiv form").attr("action","/page/embedmedia/"+encodeURIComponent(wikispaces_page)+"?mode="+encodeURIComponent(WikispacesEditor.getMode())+"&editorVersion=3");a.mediaString?this.loadMedia(a.mediaString):this.setMediaMenu("wikispaces")},
loadMedia:function(a){document.genericMediaForm.media.value=a;document.genericMediaForm.submit()},addWidget:function(a,c){this.plugin.insertWidget(a,c);d("#mediaDiv .cancelMediaLink").eq(0).click()},setMediaError:function(a){d("#mediaError").show().text(a)},resetMediaForms:function(){d("#mediaContent .mediaForm").each(function(){this.reset()});d("#mediaContent .autocompletePage").not("#includePageMediaMenu input").val(wikispaces_page);wikispaces_isMain&&wikispaces_spaceName=="www"&&d("#mediaContent .autocompletePage").not("#includePageMediaMenu input").attr("readonly",
"readonly");d("#mediaError").hide().html("")},setMediaPreview:function(a){this.editor.plugins.wspopup.show("mediaPreview");d("#mediaPreviewArea").html(a)},startMediaSpinner:function(){this.previousSection=this.currentSection;this.setMediaMenu("spinner");d("#mediaContent").addClass("mediaContentSpinner");d("#mediaError").hide().html("")},stopMediaSpinner:function(){d("#mediaContent").removeClass("mediaContentSpinner");this.setMediaMenu(this.previousSection)},setMediaMenu:function(a){log("setMediaMenu",
a);var c=false;if(d("#"+a+"MediaMenuEntry").parents("#mediaMenu").length==1){d("#"+this.currentMenu+"MediaMenuEntry").removeClass("activeMediaMenuEntry");d("#"+a+"MediaMenuEntry").addClass("activeMediaMenuEntry");this.currentMenu=a;c=true}if(a=="showcustom")a="custom";document.getElementById(a+"MediaMenu")||(a="wikispaces");d("#"+a+"MediaMenu").find("input.autocompletePage").each(function(){var e=this.autocompleter;setTimeout(function(){e.findValue()},1)});d("#"+a+"MediaMenu").find("input.autocompleteTag").each(function(){var e=
this.autocompleter;setTimeout(function(){e.findValue()},1)});d("#"+this.currentSection+"MediaMenu").hide();d("#"+a+"MediaMenu").show();this.currentSection=a;c&&a!="custom"||a=="wikispaces"||a=="spinner"||a=="flickr"||a=="gabbly"||a=="yackpack"||a=="bittybrowser"||a=="toc"||a=="reference"||a.substring(0,7)=="include"||d("#"+a+"MediaMenu").is(".hideTextMediaInstructions")?d(document.otherMediaForm).hide():d(document.otherMediaForm).show();if(a!="spinner")document.otherMediaForm.mediaType.value=a;d("#"+
a+"MediaMenu").find('input[type="text"],textarea').eq(0).focus()},submitYackpack:function(){var a="http://www.yackpack.com/walkietalkie/?"+encodeURIComponent(document.yackpackMediaForm.channel.value);document.otherMediaForm.embedText.value=a;document.otherMediaForm.save.click()},submitBittyBrowser:function(){document.otherMediaForm.embedText.value='bitty browser\nwebsite: "'+document.bittybrowserMediaForm.url.value+'"';document.otherMediaForm.save.click()},embedGabbly:function(){document.otherMediaForm.embedText.value=
"<iframe src='http://cw.gabbly.com/gabbly/cw.jsp?e=1&t="+encodeURIComponent(location.protocol+"//"+location.host+"/"+wikispaces_page)+"' scrolling='no' style='width:300px; height:250px;' frameborder='0'></iframe>";document.otherMediaForm.save.click()},uiSetup:function(a){var c=this,e=function(){a.close();return false};d("#mediaDiv ul li").live("click",function(){var b=this.id;b=b.substring(0,b.indexOf("MediaMenuEntry"));if(c.currentMenu!="spinner"){c.setMediaMenu(b);a.resize()}return false});d("#tocMediaForm #tocSubmitButton").click(function(){c.plugin.insertToc();
return e()});d("#tocMediaForm #flatSubmitButton").click(function(){c.plugin.insertToc(true);return e()});d("#referenceMediaForm").submit(function(b){c.plugin.insertReference();b.preventDefault();b.stopPropagation();return e()});d("#referencesMediaForm").submit(function(b){c.plugin.insertReferences();b.preventDefault();b.stopPropagation();return e()});d("#mediaDiv .mediaForm").submit(function(){c.startMediaSpinner()});d("#bittybrowserMediaForm").submit(function(){c.submitBittyBrowser()});d("#gabblyMediaForm").submit(function(b){c.embedGabbly();
b.preventDefault();b.stopPropagation();return false});d("#yackpackMediaForm").submit(function(b){c.submitYackpack();b.preventDefault();b.stopPropagation();return false});d("#codeMediaForm").submit(function(b){if(d(k.activeEditor.selection.getNode()).closest("pre").length){alert("You cannot insert a code block inside another code block");c.stopMediaSpinner()}else{c.plugin.insertCode(document.codeMediaForm.code.value,document.codeMediaForm.format.value);e()}b.preventDefault();b.stopPropagation();return false});
d("#includeCharMediaMenu td").hover(function(){d(this).addClass("hl")},function(){d(this).removeClass("hl")});d("#includeCharMediaMenu td").click(function(){c.plugin.insertCharacter(d(this).html(),d(this).text());e()});d("#mediaDiv .cancelMediaLink").click(e);d("#mediaDiv").find(".autocompleteSpace, .autocompleteTag, .autocompletePage").each(function(){WikispacesAutocomplete.initAutocomplete(this)});d("#rssDescInput").change(function(){if(this.checked){d("#rssDescRow input").attr("disabled",false);
d("#rssDescRow th").removeClass("disabled")}else{d("#rssDescRow input").attr("disabled",true);d("#rssDescRow th").addClass("disabled")}});d.each(this.customPlugins,function(){if(this.options.type=="media"){var b=d("<img>").attr("title",this.options.name).attr("alt",this.options.name).attr("src",this.options.logo);b=d("<a>").attr("href","#widget-"+this.options.id).append(b);b=d("<li>").attr("id",this.options.id+"MediaMenuEntry").addClass("mediaMenuEntry").append(b);d("#"+this.options.category+"MediaMenu ul li:last").before(b);
b=document.location.protocol+"//"+document.location.host+"/site/editorplugin/"+encodeURIComponent(this.options.id);b=WikispacesCommon.addUriParams(this.options.url,[[c.COMMAND_URL_PARAM,b]]);b=d("<div>").attr("id",this.options.id+"MediaMenu").addClass("hideTextMediaInstructions").addClass("mediaInstructions").hide().html('<div><iframe class="pluginIframe" frameborder="0" src="'+b+'" id="'+this.options.id+'-pluginIframe" name="'+this.options.id+'-pluginIframe"></iframe><p class="mediaInstructionsTerms">The content above is provided by <a href="'+
this.options.homepage_url+'" target="_blank">Glogster</a> and is governed by their <a href="'+this.options.terms_url+'" target="_blank">terms of service</a>.</p></div>');d("#mediaContent").find(".mediaInstructions:last").after(b)}})},runCustomPluginCommand:function(a,c,e){switch(a){case "cancel":d("#mediaDiv .cancelMediaLink").click();break;case "preview":this.setMediaPreview(e.content);break;case "submit":document.otherMediaForm.embedText.value=e.content;document.otherMediaForm.mediaType.value=c;
document.otherMediaForm.save.click();break;default:alert("The "+c+" plugin requested an invalid operation.");break}},registerPlugin:function(a){this.customPlugins[this.customPlugins.length]=a}});k.PluginManager.add("wswidgetpopup",wikispaces.popups.Widget)})(tinymce,jQuery);
(function(k){var d=k.DOM;k.create("wikispaces.themes.WikispacesTheme",{init:function(a){var c=this;c.editor=a;var e=["Bold","Italic","Underline","InsertUnorderedList","InsertOrderedList"];a.onInit.add(function(){var f=jQuery.extend(true,{},a.formatter.get("removeformat"));a.formatter.register("wsremoveformat",f);for(f=49;f<=57;f++)delete a.shortcuts["ctrl,,,"+f];a.onNodeChange.add(function(g,l,o){if(WikispacesEditor.getMode()=="visual"){k.each(e,function(p){c.controlManager().get(p.toLowerCase()).setDisabled(g.wsselection&&
g.wsselection.withinCode());c.controlManager().get(p.toLowerCase()).setActive(g.queryCommandState(p))});l=c.getHeaderParent(o);c.controlManager().get("formatlistbox").select(l?l.nodeName.toLowerCase():"p")}if(c.controlManager().get("insertunorderedlist").isActive()&&c.controlManager().get("insertorderedlist").isActive())jQuery(o).closest("ul,ol").is("ul")?c.controlManager().get("insertorderedlist").setActive(false):c.controlManager().get("insertunorderedlist").setActive(false)});try{a.execCommand("enableInlineTableEditing",
false,false,{skip_undo:true})}catch(h){}if(WikispacesEditor.getMode()=="plain"&&a.plugins.wstext){a.plugins.wstext.flipToText(jQuery("#wsMainEditor").val());WikispacesCommon.track("Editor","Start","Text")}else WikispacesCommon.track("Editor","Start","Visual");a.id=="wsMainEditor"&&jQuery("#wsMainEditor_container .mceIframeContainer").click(function(){var g=jQuery("<span>",a.getDoc()).appendTo(k.mainEditor.getBody());k.mainEditor.plugins.wscommon.cursorToAndRemoveElement(g);jQuery(".WikiOverlay").hide()});
k.isIE&&a.dom.bind(a.getDoc(),"controlselect",function(g){jQuery(g.srcElement).is("img,pre")&&a.onClick.dispatch(a,g)})});var b=false;a.onKeyDown.add(function(f,h){if(!(h.ctrlKey||h.altKey)){if(h.keyCode=="9"){h.preventDefault();h.stopPropagation()}if(h.keyCode==8||h.keyCode==46)b=!f.selection.isCollapsed()}});a.onKeyUp.add(function(f,h){if((h.keyCode==8||h.keyCode==46)&&b)f.undoManager.add()});k.isWebKit&&a.onKeyUp.add(function(f,h){if((h.keyCode==8||h.keyCode==46)&&b&&jQuery.trim(jQuery(f.getBody()).text())==
""&&f.dom.isBlock(jQuery(f.getBody()).children().get(0))){f.undoManager.begin();jQuery(f.getDoc().body).children().remove();h=jQuery("<span>",f.getDoc()).appendTo(f.getDoc().body).after("<br/>");f.plugins.wscommon.cursorToAndRemoveElement(h);f.undoManager.end();f.undoManager.remove()}});a.onActivate.add(function(f){c.controlManager().editor=f;jQuery(f.getContentAreaContainer()).addClass("active_editor")});a.onDeactivate.add(function(f){jQuery(f.getContainer()).is(":visible")&&f.selection.collapse();
jQuery(f.getContentAreaContainer()).removeClass("active_editor")});a.onModeSwitch=new k.util.Dispatcher(a);a.onModeSwitch.add(function(f){k.each(e,function(h){c.controlManager().get(h.toLowerCase()).setActive(false)});f=="plain"?jQuery("#switchEditorModes span.mceText").text("Visual Editor").attr("title","Visual Editor"):jQuery("#switchEditorModes span.mceText").text("WikiText Editor").attr("title","WikiText Editor");c.showToolSet()});a.setClean=function(){this.startContent=k.trim(this.getContent({format:"raw",
no_events:1}))};a.addCommand("wsInsertHorizontalRule",function(){k.isWebKit?a.execCommand("InsertHtml",false,"<hr>"):a.execCommand("InsertHorizontalRule")});a.wsExecCommand=function(f,h,g,l){switch(f){case "Bold":case "Italic":case "Underline":case "wsFormatBlock":case "wsInsertHorizontalRule":case "wsInsertOrderedList":case "wsInsertUnorderedList":WikispacesEditor.getMode()!="plain"&&a.undoManager.add();break}switch(f){case "Bold":case "Italic":case "Underline":case "wsFormatBlock":case "wsInsertHorizontalRule":case "wsInsertOrderedList":case "wsInsertUnorderedList":case "wslink":case "wsimage":case "wsTable":case "wsWidget":case "wsStyle":case "preview":case "endPreview":if(WikispacesEditor.getMode()==
"plain"){this.execCommand(f+"Text",h,g,l);break}default:this.execCommand(f,h,g,l)}}},controlManager:function(){return k.mainEditor.controlManager},getHeaderParent:function(a){a=this.editor.dom.getParents(a);for(i=0;i<a.length;i++)if(a[i].nodeName.toLowerCase().match(/h\d/))return a[i]},showToolSet:function(a){var c=jQuery("#wsMainEditor_tools1 td > *:first-child");switch(a){case "preview":c.css("visibility","hidden");jQuery("#wsMainEditor_wssave_action").css("visibility","visible");jQuery("#wsMainEditor_wssave_open").css("visibility",
"visible");jQuery("#wsMainEditor_wsendpreview").css("visibility","visible");jQuery("#wsMainEditor_wsendpreview").css(jQuery.browser.msie&&jQuery.browser.version>=8?{left:-60,top:7}:{left:585,top:28});jQuery.browser.webkit&&jQuery("#wsMainEditor_wsendpreview").parent().css("position","");break;default:c.css("visibility","visible");jQuery("#wsMainEditor_wsendpreview").css("visibility","hidden");if(WikispacesEditor.getMode()=="plain"){jQuery("#wsMainEditor_wscomment").css("visibility","hidden");jQuery("#wsMainEditor_undo").css("visibility",
"hidden");jQuery("#wsMainEditor_redo").css("visibility","hidden")}break}},renderUI:function(a){var c=this,e=c.editor,b=e.controlManager,f=d.insertAfter(d.create("div",{id:e.id+"_container","class":"mceEditor "+e.settings.skin+"Skin"}),a.targetNode),h=d.add(f,"div",{id:e.id+"_external","class":"mceExternalToolbar toolbarLayer"});d.insertAfter(d.create("div",{id:e.id+"_overlay","class":"editorcPopup_modalBlocker blockerLayer",style:"display: block !important; "}),a.targetNode);c.toolbar=b.createToolbar("tools1");
c.toolbar.add(b.createButton("bold",{title:"Bold",onclick:function(){k.activeEditor.wsExecCommand("Bold");WikispacesCommon.track("Editor","Bold")}}));c.toolbar.add(b.createButton("italic",{title:"Italic",onclick:function(){k.activeEditor.wsExecCommand("Italic");WikispacesCommon.track("Editor","Italic")}}));c.toolbar.add(b.createButton("underline",{title:"Underline",onclick:function(){k.activeEditor.wsExecCommand("Underline");WikispacesCommon.track("Editor","Underline")}}));c.toolbar.add(b.createControl("wsstyle"));
c.toolbar.add(b.createControl("wscomment"));c.toolbar.add(b.createSeparator());var g=b.createListBox("formatlistbox",{title:"Format",onselect:function(o){k.activeEditor.wsExecCommand("wsFormatBlock",false,o);WikispacesCommon.track("Editor","Select Font",o);jQuery("#wsMainEditor_formatlistbox").removeClass("mceListBoxSelected")}});g.onRenderMenu.add(function(o,p){p.onShowMenu.add(function(){k.activeEditor.wsselection.save(2);if(!p.alreadyRendered){p.alreadyRendered=true;var m=function(q){if(document.defaultView&&
document.defaultView.getComputedStyle)return document.defaultView.getComputedStyle(q,"");else if(q.currentStyle)return q.currentStyle},n=function(q,s,r){if(document.defaultView&&document.defaultView.getComputedStyle)for(var t=0;t<s.length;t++){var y=s[t],u=s.getPropertyValue(y),v=q.getPropertyValue(y);u&&u!=v&&jQuery(r).css(y,u)}else for(y in s){y=y.replace(/\-(\w)/g,function(z,A){return A.toUpperCase()});u=s[y];v=q[y];u&&u!=v&&jQuery(r).css(y,u)}};jQuery(document.body).append('<div class="wiki" style="display: none;" id="styleHolder"><h1>h1</h1><h2>h2</h2><h3>h3</h3><h4>h4</h4><h5>h5</h5><h6>h6</h6><span>span</span></div>');
jQuery("#styleHolder").children().each(function(){var q;q=this.nodeName.toLowerCase()=="span"?jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu .toolbar_formatmenu_normal .mceText"):jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu .toolbar_formatmenu_"+this.nodeName.toLowerCase()+" .mceText");var s=m(jQuery("#styleHolder").get(0)),r=m(this);n(s,r,q.get(0));q.css("white-space","nowrap")})}});p.onHideMenu.add(function(){k.activeEditor.wsselection.restore();setTimeout(function(){k.activeEditor.focus()},
100)});p.settings.max_height=185});g.add("Heading 1","h1",{"class":"toolbar_formatmenu_h1"});g.add("Heading 2","h2",{"class":"toolbar_formatmenu_h2"});g.add("Heading 3","h3",{"class":"toolbar_formatmenu_h3"});g.add("Heading 4","h4",{"class":"toolbar_formatmenu_h4"});g.add("Heading 5","h5",{"class":"toolbar_formatmenu_h5"});g.add("Heading 6","h6",{"class":"toolbar_formatmenu_h6"});g.add("Normal","p",{"class":"toolbar_formatmenu_normal"});c.toolbar.add(g);g.originalShow=g.showMenu;g.showMenu=function(){var o=
jQuery(window).scrollTop();g.originalShow();jQuery(window).scrollTop(o);jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu tr.mceFirst td").css("height",0);jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu tr.mceFirst td a").html("").css({position:"relative",height:0,padding:0});jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu_co").css("height","auto").css("width","auto");jQuery("#menu_wsMainEditor_wsMainEditor_formatlistbox_menu").css({borderBottom:"1px solid #d4d0c9",
borderRight:"1px solid #d4d0c9"}).appendTo(document.body);e.plugins.wstoolbarscroll.moveScroller();o=k.DOM.select("a","menu_"+g.menu.id)[1];jQuery(o).is(":visible")&&o.focus();g.menu._focusIdx=1};c.toolbar.add(b.createSeparator());c.toolbar.add(b.createButton("insertorderedlist",{title:"Numbered List",onclick:function(){k.activeEditor.wsExecCommand("wsInsertOrderedList");WikispacesCommon.track("Editor","Add Ordered List")}}));c.toolbar.add(b.createButton("insertunorderedlist",{title:"Bulleted List",
onclick:function(){k.activeEditor.wsExecCommand("wsInsertUnorderedList");WikispacesCommon.track("Editor","Add Unordered List")}}));c.toolbar.add(b.createButton("hr",{title:"Insert Horizontal Rule",onclick:function(){k.activeEditor.wsExecCommand("wsInsertHorizontalRule");WikispacesCommon.track("Editor","Add Horizontal Rule")}}));c.toolbar.add(b.createSeparator());c.toolbar.add(b.createControl("wslink"));c.toolbar.add(b.createControl("wsimage"));c.toolbar.add(b.createControl("wswidget"));c.toolbar.add(b.createControl("wstable"));
c.toolbar.add(b.createSeparator());c.toolbar.add(b.createButton("undo",{title:"Undo",onclick:function(){k.activeEditor.wsExecCommand("Undo");WikispacesCommon.track("Editor","Undo")}}));c.toolbar.add(b.createButton("redo",{title:"Redo",onclick:function(){k.activeEditor.wsExecCommand("Redo");WikispacesCommon.track("Editor","Redo")}}));c.toolbar.add(b.createSeparator());c.toolbar.add(b.createButton("wspreview",{title:"Preview",label:"Preview","class":"btn",onclick:function(){k.mainEditor.wsExecCommand("preview",
false,false,{skip_undo:true});WikispacesCommon.track("Editor","Preview")}}));c.toolbar.add(b.createButton("wsendpreview",{title:"Continue Editing",label:"Continue Editing","class":"btn continueBtn",onclick:function(){k.mainEditor.wsExecCommand("endPreview",false,false,{skip_undo:true})}}));c.toolbar.add(b.createControl("wscancel"));var l=b.createControl("wssave");c.toolbar.add(l);c.toolbar.renderTo(h);jQuery(h).find(".btn span.mceButtonLabel").wrap("<span />");jQuery(h).find(".btn.mceSplitButton span.mceSplitButtonLabel").wrap("<span />");
jQuery(h).find(".btn.mceSplitButton span.mceOpen").removeClass("btn").wrap("<span />");jQuery.browser.msie&&jQuery.browser.version>="8.0"&&jQuery(h).find(".btn.mceSplitButton span.mceOpen").html("&zwj;");jQuery(h).find(".btn.mceAction").addClass("pill-l");jQuery(h).find(".btn.mceOpen").addClass("pill-r");jQuery("#wsMainEditor_formatlistbox_open").click(function(){return false}).bind("mousedown",function(){g.showMenu();return false});c.preventMenuClose=false;jQuery("#menu_wsMainEditor_wsMainEditor_wssave_menu").live("mouseover",
function(){c.preventMenuClose=true;jQuery("#menu_wsMainEditor_wsMainEditor_wssave_menu").die("mouseover");jQuery(this).hover(function(){return c.preventMenuClose=true},function(){c.preventMenuClose=false;setTimeout(function(){c.preventMenuClose||l.hideMenu()},500);return true})});jQuery(h).find("#wsMainEditor_wssave .btn.mceOpen").click(function(o){c.preventMenuClose=!c.preventMenuClose;l.showMenu();o.preventDefault();return false});jQuery(h).find("#wsMainEditor_wssave .btn.mceOpen").hoverIntent({sensitivity:3,
interval:200,over:function(){l.showMenu()},timeout:500,out:function(){c.preventMenuClose||l.hideMenu()}});jQuery(h).prepend('<table style="width: 100%; border-collapse: collapse; background: transparent;" ><tr style="height: 21px;"><td style="width:10px; background: url(/i/window-bar-nl.png) no-repeat left bottom; padding: 0;"><img src="/i/c.gif" width="10" height="21" alt="" /></td><td style="width:75%; background: url(/i/window-bar-n.png) repeat-x left bottom; padding: 0;"></td><td style="width:23px; background: url(/i/window-bar-yl.png) no-repeat left bottom; padding: 0;"><img src="/i/c.gif" width="23" height="21" alt="" /></td><td style="width:25%; background: url(/i/window-bar-m.png) repeat-x left bottom; padding: 0; text-align: right;"><span id="autosaveStatus"></span></td><td style="width:10px; background: url(/i/window-bar-mr.png) no-repeat left bottom; padding: 0;"><img src="/i/c.gif" width="10" height="21" alt="" /></td></tr></table>');
jQuery("#wsMainEditor_external").css({MozUserSelect:"none",KhtmlUserSelect:"None",cursor:"default"}).bind("selectstart",function(){return false});a=d.add(f,"div",{"class":"mceIframeContainer editorLayer active_editor",style:"position: relative;"});f=d.add(f,"div",{style:"display: none;"});return{iframeContainer:a,editorContainer:e.id+"_container",sizeContainer:f,deltaHeight:0}},getInfo:function(){return{longname:"Wikispaces theme",author:"Tangient LLC",authorurl:"http://wikispaces.com",version:"0.1"}}});
k.ThemeManager.add("wikispaces",wikispaces.themes.WikispacesTheme)})(tinymce);
(function(k){k.create("wikispaces.plugins.ImageTextPlugin:wikispaces.plugins.ImagePlugin",{init:function(d){var a=this;this.editor=d;d.addCommand("wsimageText",function(){k.mainEditor.plugins.wspopup.show("imageTool",{plugin:a})})},getInfo:function(){return{longname:"Wikispaces image text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},insertImageInEditorCallback:function(d,a,c){if("embed"==document.forms.imageToolForm.insertMode.value)if(a==
"audio"||a=="video")this.editor.wsselection.setContent('[[media type="file" key="'+d+'"]]');else{var e="";if(a=="image"&&c.width>800)e=' width="800" height="'+Math.floor(800/c.width*c.height)+'"';this.editor.wsselection.setContent("[["+a+":"+d+e+"]]")}else this.editor.wsselection.setContent("[[http://"+window.location.hostname+"/file/view/"+encodeURIComponent(d)+"|"+d+"]]")}});k.PluginManager.add("wsimagetext",wikispaces.plugins.ImageTextPlugin)})(tinymce);
(function(k,d){k.create("wikispaces.plugins.LinkTextPlugin:wikispaces.plugins.LinkPlugin",{init:function(a){var c=this;this.editor=a;a.addCommand("wslinkText",function(){k.mainEditor.plugins.wspopup.show("linkTool",{plugin:c})})},getInfo:function(){return{longname:"Wikispaces link (text)",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},setupForms:function(){var a;this.editor.wsselection.restore(true);this.editor.plugins.wstext.expandSelectionToTag("[[",
"","]]");var c=d.trim(this.editor.plugins.wstext.getSelectedText());d("#linkTextAnchor").val("");var e="",b="",f="",h="",g="",l="";if(c){var o=true;if(a=c.match(/^\[\[(@)?((?:[a-zA-Z0-9.+-]+:\/\/|mailto:).*?)(?:\|(.*))?\]\]$/i)){if(a[1])g=a[1];if(a[3])l=a[3];if(a[2]){h=a[2];l||(l=h)}d("#linkDiv #removeExistingLink").show()}else if(a=c.match(/\[\[(@)?(?:([a-z0-9-]+):)?([^:|\/\[\]\{\}\$#@\\]+)(?:\#([A-Za-z][-A-Za-z0-9_ ]*))?(?:\|([^\[\]\xff]+))?\]\]/)){if(a[1])g=a[1];if(a[2])e=a[2];if(a[3])b=a[3];if(a[4])f=
a[4];if(a[5])l=a[5];l||(l=e&&e!=wikispaces_spaceName?e+" : "+b:b);d("#linkDiv #removeExistingLink").show()}else{l=c;o=false}if(o){if(b)document.linkForm.pageName.value=b;if(f)document.linkForm.anchor.value=f;if(e)document.linkForm.space.value=e;if(h)document.linkForm.url.value=h;if(g){document.linkForm.newWindowWiki.checked=true;document.linkForm.newWindowExternal.checked=true}}else this.fillFormsFromText(l)}if(l){document.linkForm.linkTextWiki.value=l;document.linkForm.linkTextExternal.value=l;d(document.linkForm.linkTextWiki).keydown().change()}document.linkForm.anchor.value&&
d("#wikiAnchor").click();document.linkForm.url.value&&d("#switchToExternal").click()},insertLink:function(a,c,e,b,f,h,g){var l="";if(g)l="@";if(a=="Wiki"){a=(b==wikispaces_spaceName?"":b+":")+f;this.editor.wsselection.setContent("[["+l+a+(h?h:"")+(c==a?"":"|"+c)+"]] ");WikispacesCommon.track("Editor","Add Link",b+":"+a)}else{e=encodeURI(e).replace(/%25/g,"%");this.editor.wsselection.setContent("[["+l+e+(e==c?"":"|"+c)+"]] ");WikispacesCommon.track("Editor","Add Link",e)}return true},insertAnchor:function(a){WikispacesCommon.track("Editor",
"Add Anchor",a);this.editor.wsselection.setContent("[[#"+a+"]]");return true},removeLink:function(){WikispacesCommon.track("Editor","Remove Link");if(this.editor.plugins.wstext.expandSelectionToTag("[[","","]]")){var a=this.editor.plugins.wstext.getSelectedText();if(a!="[[code]]"&&!a.match(/^\[\[media /)&&!a.match(/^\[\[file /)&&!a.match(/^\[\[image /)&&!a.match(/^\[\[include /)){a=a.match(/(\s*)\[\[([^\]]*)\]\](\s*)/);a=a[1]+a[2]+a[3];this.editor.plugins.wstext.insertInEditor(a);return}}alert("Please put your cursor inside of the link wikitext to remove it.")}});
k.PluginManager.add("wslinktext",wikispaces.plugins.LinkTextPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.PreviewTextPlugin:wikispaces.plugins.PreviewPlugin",{init:function(a){this.editor=a;var c=this;a.addCommand("previewText",function(){c.showPreview()});a.addCommand("endPreviewText",function(){c.hidePreview()})},getInfo:function(){return{longname:"Wikispaces preview text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},hideEditor:function(){d("#plainTextEditor").hide()},showEditor:function(){d("#plainTextEditor").show()}});
k.PluginManager.add("wspreviewtext",wikispaces.plugins.PreviewTextPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.StyleTextPlugin:wikispaces.plugins.StylePlugin",{init:function(a){var c=this;this.editor=a;a.addCommand("wsStyleText",function(){var e=c.editor.plugins.wstext.getSelectedText();k.mainEditor.plugins.wspopup.show("stylePopupContents",{plugin:c,text:e})})},getInfo:function(){return{longname:"Wikispaces style text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},setSpanText:function(a){if(a.text)if((a=
a.text.match(/^<span\s+.*?style="([\s\S]*?)"[\s\S]*<\/span>$/i))&&a.length==2){a=a[1].split(";");for(var c=0;c<a.length;c++){var e=a[c].split(":"),b=d.trim(e[0]);e=d.trim(e[1]);if(b&&e){this.setSpanTextValue(b,e);document.styleForm.removeStyleButton.disabled=false}}}},applyStyle:function(){WikispacesCommon.track("Editor","Apply Style");var a=d.trim(document.styleForm.styleText.value);if(a.length>0){var c=this.editor.plugins.wstext.getSelectedText(),e=c.match(/^<span [\s\S]*?>([\s\S]*)<\/span>$/i);
if(e&&e.length==2)c=e[1];document.getElementById("textEditor").focus();this.editor.plugins.wstext.insertInEditor('<span style="'+a+'">'+c+"</span>")}else this.removeStyle();return false},removeStyle:function(){WikispacesCommon.track("Editor","Remove Style");var a=this.editor.plugins.wstext.getSelectedText().match(/^<span [\s\S]*?>([\s\S]*)<\/span>$/i);a&&a.length==2&&this.editor.plugins.wstext.insertInEditor(a[1])},getUsedColors:function(){var a=[],c=this.editor.plugins.wstext.getContent().match(/style=\"[^\"]*?color:\s*.*?[;\"]/gi);
if(c)for(var e=0;e<c.length;e++){var b=c[e].match(/color:\s*(.*?)[;\"]/i);a[a.length]=(new RGBColor(b[1])).toHex().toUpperCase()}return a}});k.PluginManager.add("wsstyletext",wikispaces.plugins.StyleTextPlugin)})(tinymce,jQuery);
(function(k){k.create("wikispaces.plugins.TableTextPlugin:wikispaces.plugins.TablePlugin",{init:function(d){var a=this;this.editor=d;d.addCommand("wsTableText",function(){k.mainEditor.plugins.wspopup.show("tablePopupContents",{plugin:a})})},getInfo:function(){return{longname:"Wikispaces table text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},addTable:function(d,a){WikispacesCommon.track("Editor","Add Table",d+"x"+a);for(var c="",e=0;e<d;e++){c+=
"\n||";for(cols=0;cols<a;cols++)c+=" ||"}c+="\n";this.editor.wsselection.setContent(c)}});k.PluginManager.add("wstabletext",wikispaces.plugins.TableTextPlugin)})(tinymce);
(function(k,d){k.create("wikispaces.plugins.TextPlugin",{init:function(a){var c=this;c.editor=a;a.addCommand("wstext",function(){WikispacesEditor.getMode()=="visual"?c.switchToTextEditor():c.switchToVisualEditor()});a.addCommand("BoldText",function(){c.wrapTextEditorSelection("**")});a.addCommand("ItalicText",function(){c.wrapTextEditorSelection("//")});a.addCommand("UnderlineText",function(){c.wrapTextEditorSelection("__")});a.addCommand("wsFormatBlockText",function(e,b){e="";if(b=="h1")e="=";else if(b==
"h2")e="==";else if(b=="h3")e="===";else if(b=="h4")e="====";else if(b=="h5")e="=====";else if(b=="h6")e="======";if(e)if(c.getSelectedText())c.insertInEditor("\n"+e+c.getSelectedText()+e+"\n");else{b=document.getElementById("textEditor");c.prepareSelection(b);var f=b.sel_start+e.length+1;c.insertInEditor("\n"+e+e+"\n");c.setSelectionRange(b,f,f)}document.getElementById("textEditor").focus()});a.addCommand("wsInsertOrderedListText",function(){c.addListInTextEditor("#")});a.addCommand("wsInsertUnorderedListText",
function(){c.addListInTextEditor("*")});a.addCommand("wsInsertHorizontalRuleText",function(){c.insertInEditor("\n----\n")})},getInfo:function(){return{longname:"Wikispaces text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},flipToText:function(a){this.editor.undoManager.clear();d("#plainTextEditor").show();d("#textEditor").show().val(a);d("html, body").animate({scrollTop:0},"fast");d("#wsMainEditor_container").css("position","static");WikispacesEditor.setMode("plain");
this.editor.onModeSwitch.dispatch("plain");d(this.editor.getContentAreaContainer()).hide();setTimeout(function(){d("#textEditor").focus()},500);if(k.isIE){a=function(){d("#textEditor").css("width",d("#textEditor").parent().width()-10)};a();d(window).resize(a)}this.setClean()},switchToTextEditor:function(){var a=this;this.convertContent(this.editor.plugins.wscommon.fullContent(true),"plain",function(c){a.flipToText(c)},function(){a.switchToTextEditor()});WikispacesCommon.track("Editor","Switch Mode To",
"Text")},switchToVisualEditor:function(){var a=this;this.convertContent(this.editor.plugins.wstext.getContent(),"visual",function(c){d("#plainTextEditor").hide();d(a.editor.getContentAreaContainer()).show();d("html, body").animate({scrollTop:0},"fast");WikispacesEditor.setMode("visual");a.editor.onModeSwitch.dispatch("visual");a.editor.setContent(c,{load:true});a.editor.undoManager.clear();a.editor.onNeedsResize.dispatch();setTimeout(function(){a.editor.onNeedsResize.dispatch()},1E3);a.editor.wsselection.ensureCursor();
a.editor.focus();d("#wsMainEditor_container").css("position","relative")},function(){a.switchToVisualEditor()});WikispacesCommon.track("Editor","Switch Mode To","Visual")},convertContent:function(a,c,e,b){var f=this,h=d("<div></div>").attr("id","textSpinner").addClass("wikispaces_content").addClass("mceToolbar spinner").css({textAlign:"center"}).html('Loading <img src="/i/spinner.gif" alt="" width="18" height="18" style="padding-top: 9px; vertical-align: -4px;"/>');d(".mceToolbar").hide();d(f.editor.plugins.wscommon.editorToolbar()).append(h);
var g=function(){WikispacesSession.reloadSession(b,3E3,function(){f.editor.plugins.wscommon.sessionReloadFailed();d(".mceToolbar.spinner").remove();d(".mceToolbar").show()})};d.ajax({url:"/page/convert/"+encodeURIComponent(wikispaces_page),xhr:WikispacesCommon.jQueryAjaxFix,type:"POST",async:false,cache:false,data:{content:a,mode:c},dataType:"xml",global:false,error:g,success:function(l,o,p){if(p.status==0)return g.call(this,p,o,null);WikispacesSession.reloadSessionSuccess();l=d(l).find("convert");
l.length&&e(l.text());d(".mceToolbar.spinner").remove();d(".mceToolbar").show()}})},editorTextArea:function(){return d("#textEditor").get(0)},getContent:function(){return d("#textEditor").val()},isDirty:function(){return this.getContent()!=this.cleanContent},setClean:function(){this.cleanContent=this.getContent()},insertInEditor:function(a){var c=document.getElementById("textEditor");c.focus();if(document.selection){sel=document.selection.createRange();sel.text=a;sel.select()}else if(c.selectionStart||
c.selectionStart=="0"){var e=c.selectionStart,b=c.selectionEnd,f=c.scrollTop;d(c).val(c.value.substring(0,e)+a+c.value.substring(b,c.value.length));c.scrollTop=f;e==b?this.setSelectionRange(c,e+a.length,e+a.length):this.setSelectionRange(c,e,e+a.length);this.editor.wsselection.saveOver()}else c.value+=a},setSelectionRange:function(a,c,e){if(a.setSelectionRange)return a.setSelectionRange(c,e);a=a.createTextRange();a.collapse(true);a.moveEnd("character",e);a.moveStart("character",c);a.select()},wrapTextEditorSelection:function(a){var c=
this.getSelectedText(),e=c.length;c=c.replace(/^\s+/,"");var b=e-c.length;c=c.replace(/\s+$/,"");var f=e-b-c.length;e="";e=c.substring(0,a.length)==a&&c.substring(c.length-a.length,c.length)==a?c.substring(a.length,c.length-a.length):a+c+a;for(a=0;a<b;a++)e=" "+e;for(a=0;a<f;a++)e+=" ";b=document.getElementById("textEditor");this.prepareSelection(b);a=b.sel_start;c=b.sel_end;f=e.length;this.insertInEditor(e);a==c?this.setSelectionRange(b,a+f/2,a+f/2):this.setSelectionRange(b,a,f+a);this.editor.wsselection.saveOver();
b.focus()},getSelectedText:function(){var a=document.getElementById("textEditor");if(a){this.prepareSelection(a);return a.sel_text?a.sel_text:""}return""},prepareSelection:function(a){a.sel_text="";a.sel_text_pre="";a.sel_text_post="";a.sel_start=0;a.sel_end=0;a.focus();if(typeof a.selectionStart=="number"){a.sel_start=a.selectionStart;a.sel_end=a.selectionEnd}else if(document.selection){var c=document.selection.createRange();if(c.parentElement()!=a)return;var e=c.duplicate();e.moveToElementText(a);
e.setEndPoint("EndToEnd",c);e=e.text.length;c=e-c.text.length;for(var b=a.value,f=e-1;f>=c;--f)b.charAt(f)=="\n"&&--e;for(f=c-1;f>=0;--f)if(b.charAt(f)=="\n"){--e;--c}a.sel_start=c;a.sel_end=e}e=d(a).val();a.sel_text=e.substring(a.sel_start,a.sel_end);a.sel_text_pre=e.substring(0,a.sel_start);a.sel_text_post=e.substring(a.sel_end)},expandSelectionToLine:function(){var a=document.getElementById("textEditor");this.prepareSelection(a);for(var c,e=d(a).val(),b=a.sel_start-1;b>=0;b--)if(e.charAt(b)=="\n"){c=
b+1;break}for(b=a.sel_end;b<e.length&&e.charAt(b)!="\n";b++);this.setSelectionRange(a,c,b);return true},expandSelectionToTag:function(a,c,e){var b=this.getSelectedText().replace(/^\s+/,"").replace(/\s+$/,"");if(b){if(b.substring(0,c.length+a.length)==a+c&&b.substring(b.length-e.length,b.length)==e)return true;return false}b=document.getElementById("textEditor");this.prepareSelection(b);var f=0,h=0,g=b.sel_start-1;if(g<0)g=0;var l=null,o=d(b).val();for(g=g;g>=0;g--)if(o.substr(g,a.length+c.length)==
a+c){if(h==0){l=g;break}h--}else if(o.substr(g,a.length)==a)return false;else o.substr(g,e.length)==e&&b.sel_start-g>=e.length&&h++;if(l==null)return false;g=b.sel_end-(e.length-1);if(g<0)g=0;if(g<l+a.length+c.length)g=l+a.length+c.length;for(g=g;g<o.length-1;g++)if(o.substr(g,e.length)==e){if(f==0){this.setSelectionRange(b,l,g+e.length);this.editor.wsselection.saveOver();return true}f--}else o.substr(g,a.length)==a&&f++;return false},addListInTextEditor:function(a){this.getSelectedText()||this.expandSelectionToLine();
var c=document.getElementById("textEditor");this.prepareSelection(c);var e=c.sel_text,b="",f=true;e=e.split("\n");for(var h=0;h<e.length;h++){var g;if(g=e[h].match(/^(\#|\*|\>)+\s(.*)$/i)){if(g[1].charAt(0)!=a)f=false;b+="\n"+a+" "+g[2]}else{f=false;b+="\n"+a+" "+e[h]}}if(c.sel_text_pre.length==0||c.sel_text_pre.charAt(c.sel_text_pre.length-1)=="\n")b=b.substring(1,b.length);if(f){e=c.sel_text;b="";e=e.split("\n");for(h=0;h<e.length;h++)if(g=e[h].match(/^(\#|\*|\>)+\s(.*)$/i))b+=g[2]+"\n";if(c.sel_text.charAt(c.sel_text.length-
1)!="\n")b=b.substring(0,b.length-1)}this.insertInEditor(b)}});k.PluginManager.add("wstext",wikispaces.plugins.TextPlugin)})(tinymce,jQuery);
(function(k,d){k.create("wikispaces.plugins.WidgetOverlay:wikispaces.plugins.ImageOverlay",{getInfo:function(){return{longname:"Wikispaces widget overlay",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},init:function(a,c){var e=this;a.onInit.add(function(b){var f=function(h){h.onClick.add(function(g,l){(l=g.plugins.wswidget.findWidgetPlaceholder(l.target))?e.show(g,l):e.hide()})};b.onInitSubEditor.add(f);f(b)});this.overlayInit(a,c)},show:function(a,
c){this.parent(a,c);d(c).is(".WikiMediaRss, .WikiMediaInclude, .WikiMediaToc, .WikiMediaTocFlat")?d("#mediaAppearance").hide():d("#mediaAppearance").show();d(c).is(".WikiMediaToc, .WikiMediaTocFlat")?d("#mediaEdit").hide():d("#mediaEdit").show();this.repositionAndShow()},overlayContent:function(){return WikispacesContent.loadContent("mediaProperties")},refreshAlignment:function(){d("#mediaAlign a").removeClass("buttonSelected");switch(this.currentAlignment()){case "left":d("#mediaAlignLeft").addClass("buttonSelected");
break;case "center":d("#mediaAlignCenter").addClass("buttonSelected");break;case "right":d("#mediaAlignRight").addClass("buttonSelected");break}},setup:function(){var a=this;d("#mediaAlignLeft").click(function(){a.setImageAlignment("left");return false});d("#mediaAlignCenter").click(function(){a.setImageAlignment("center");return false});d("#mediaAlignRight").click(function(){a.setImageAlignment("right");return false});d("#mediaAlignNone").click(function(){a.setImageAlignment("");return false});d("#mediaSizeDown").click(function(){a.adjustImageSize(-0.1);
return false});d("#mediaSizeUp").click(function(){a.adjustImageSize(0.1);return false});d("#mediaSizeOriginal").click(function(){a.adjustImageSize(0,true);return false});d("#mediaSizeFit").click(function(){a.adjustImageSize(0,false,true);return false});d("#mediaEditLink").click(function(){a.editor.plugins.wswidget.openWidget(a.img);return false});d("#mediaRemoveLink").click(function(){a.editor.undoManager.add();a.editor.dom.remove(a.img);a.hide();return false})},toggleFitImage:function(){d(this.img).width()>
800?d("#mediaSizeFit").show():d("#mediaSizeFit").hide()}});k.PluginManager.add("wswidgetoverlay",wikispaces.plugins.WidgetOverlay)})(tinymce,jQuery);
(function(k){k.create("wikispaces.plugins.WidgetTextPlugin:wikispaces.plugins.WidgetPlugin",{init:function(d){var a=this;this.editor=d;d.addCommand("wsWidgetText",function(){WikispacesCommon.track("Editor","Open Media Tool");var c="";if(d.plugins.wstext.expandSelectionToTag("[[","media","]]"))c="wikitext@@media@@"+d.plugins.wstext.getSelectedText().match(/\[\[media (.*)\]\]/)[1];else if(d.plugins.wstext.expandSelectionToTag("[[","rss","]]"))c="wikitext@@rss@@"+d.plugins.wstext.getSelectedText().match(/\[\[rss (.*)\]\]/)[1];
k.mainEditor.plugins.wspopup.show("mediaTool",{plugin:a,mediaString:c})})},getInfo:function(){return{longname:"Wikispaces widgets text",author:"Tangient LLC",authorurl:"http://wikispaces.com",infourl:"http://wikispaces.com",version:"0.1"}},insertWidget:function(d,a){WikispacesCommon.track("Editor","Add Media",a);this.editor.wsselection.setContent(d)},insertCharacter:function(d,a){WikispacesCommon.track("Editor","Add Character",d);this.editor.wsselection.setContent(a)},insertReference:function(){WikispacesCommon.track("Editor",
"Insert Reference");this.editor.wsselection.setContent("<ref></ref>")},insertReferences:function(){WikispacesCommon.track("Editor","Insert References");this.editor.wsselection.setContent("\n<references/>")},insertToc:function(d){WikispacesCommon.track("Editor","Insert Toc",d);d?this.editor.wsselection.setContent("\n[[toc|flat]]"):this.editor.wsselection.setContent("\n[[toc]]")},insertCode:function(d,a){a||(a="text");WikispacesCommon.track("Editor","Add Code",a);this.editor.wsselection.setContent('\n[[code format="'+
a+'"]]\n'+d+"\n[[code]]\n")}});k.PluginManager.add("wswidgettext",wikispaces.plugins.WidgetTextPlugin)})(tinymce);
(function(k){var d=k.DOM;k.create("wikispaces.themes.ReferenceTheme:wikispaces.themes.WikispacesTheme",{renderUI:function(a){var c=this.editor,e=c.controlManager,b=c.getParam("reference_reference_id"),f=d.insertAfter(d.create("div",{id:c.id+"_container","class":"mceEditor "+c.settings.skin+"Skin editorLayer referenceEditor",style:"position: relative; margin-top: 5px; "}),a.targetNode);a=d.add(f,"div",{"class":"mceIframeContainer editorLayer",style:"position: relative;"});var h=d.add(f,"div",{id:c.id+
"_external","class":"toolbarLayer"});this.toolbar=e.createToolbar("tools1");this.toolbar.add(e.createButton("wsremovereference",{title:"Remove Reference",label:"Remove Reference","class":"btn",onclick:function(){k.mainEditor.plugins.wsreference.toggleReference(b)}}));this.toolbar.add(e.createButton("wsgotoreference",{title:"Show Citation",label:"Show Citation","class":"btn",onclick:function(){var g=jQuery(k.mainEditor.getDoc()).find("#citation-"+b),l=c.plugins.wscommon.absoluteOffset(g.get(0)).top,
o=0,p=function(){o++>2||g.animate({opacity:"0.1"},500,"swing",function(){g.animate({opacity:"1.0"},500,"swing",p)})};jQuery(window).scrollTo(l-55,{axis:"y",duration:500,onAfter:p})}}));this.toolbar.renderTo(h);jQuery(h).find(".btn span.mceButtonLabel").wrap("<span />");jQuery(h).find("td:first-child").attr("width",5);jQuery(h).find("td:nth-child(2)").attr("width",140);jQuery(h).find("td:nth-child(3)").attr("width",120);e=d.add(f,"div",{style:"display: none;"});return{iframeContainer:a,editorContainer:c.id+
"_container",sizeContainer:e,deltaHeight:0}},getInfo:function(){return{longname:"Wikispaces reference theme",author:"Tangient LLC",authorurl:"http://wikispaces.com",version:"0.1"}}});k.ThemeManager.add("reference",wikispaces.themes.ReferenceTheme)})(tinymce);
(function(k){var d=k.DOM;k.create("wikispaces.themes.SubEditorTheme:wikispaces.themes.WikispacesTheme",{renderUI:function(a){var c=this.editor,e=d.insertAfter(d.create("div",{id:c.id+"_container","class":"mceEditor "+c.settings.skin+"Skin editorLayer",style:"position: relative; "}),a.targetNode);a=d.add(e,"div",{"class":"mceIframeContainer editorLayer",style:"position: relative;"});e=d.add(e,"div",{style:"display: none;"});return{iframeContainer:a,editorContainer:c.id+"_container",sizeContainer:e,
deltaHeight:0}},getInfo:function(){return{longname:"Wikispaces subeditor theme",author:"Tangient LLC",authorurl:"http://wikispaces.com",version:"0.1"}}});k.ThemeManager.add("subeditor",wikispaces.themes.SubEditorTheme)})(tinymce);
(function(){tinymce.create("tinymce.plugins.Autoresize",{init:function(k){k.onNeedsResize=new tinymce.util.Dispatcher(k);k.onNeedsResize.add(this.fitEditor);k.onSetContent.add(this.fitEditor);k.onChange.add(this.fitEditor);k.onKeyPress.add(this.fitEditor);k.onInit.add(this.fitEditor);k.onPaste.add(function(){_.delay(function(){k.onNeedsResize.dispatch()},200)});k.onNeedsResize.dispatch()},fitEditor:function(){editorID=this.id;var k,d,a,c;d=document.getElementById(editorID+"_ifr");if(d!=null){if(d.contentDocument)a=
d.contentDocument;else if(d.contentWindow)a=d.contentWindow.document;else if(d.document)a=d.document;if(a!=null){a.body.style.overflow="hidden";k=d.parentNode.parentNode.parentNode.parentNode;k.style.height="auto";c=parseInt(d.style.height);k=tinymce.isWebKit?jQuery(a.body).height():a.height?a.height:parseInt(a.body.scrollHeight);var e=tinymce.isWebKit?0:50;if(k+e>c)d.style.height=k+e+"px";else if(k+e<c)d.style.height=Math.max(k+e,100)+"px";jQuery(d).parent().css("width","100%");a=jQuery(a).width();
a>jQuery(d).parent().innerWidth()&&jQuery(d).parent().css("width",a+"px");jQuery(d).scrollTo(0)}}}});tinymce.PluginManager.add("autoresize",tinymce.plugins.Autoresize)})();(function(){tinymce.create("tinymce.plugins.Rgbcolor",{init:function(){}});tinymce.PluginManager.add("rgbcolor",tinymce.plugins.Rgbcolor)})();
function RGBColor(k){this.ok=false;if(k.charAt(0)=="#")k=k.substr(1,6);k=k.replace(/ /g,"");k=k.toLowerCase();var d={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",
darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",
gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",
lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",
oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",
slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var a in d)if(k==a)k=d[a];var c=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(f){return[parseInt(f[1]),parseInt(f[2]),parseInt(f[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,
example:["#00ff00","336699"],process:function(f){return[parseInt(f[1],16),parseInt(f[2],16),parseInt(f[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(f){return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)]}}];for(a=0;a<c.length;a++){var e=c[a].process,b=c[a].re.exec(k);if(b){channels=e(b);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r;this.g=this.g<0||isNaN(this.g)?
0:this.g>255?255:this.g;this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b;this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var f=this.r.toString(16),h=this.g.toString(16),g=this.b.toString(16);if(f.length==1)f="0"+f;if(h.length==1)h="0"+h;if(g.length==1)g="0"+g;return"#"+f+h+g};this.getHelpXML=function(){for(var f=[],h=0;h<c.length;h++)for(var g=c[h].example,l=0;l<g.length;l++)f[f.length]=g[l];for(var o in d)f[f.length]=o;g=document.createElement("ul");
g.setAttribute("id","rgbcolor-examples");for(h=0;h<f.length;h++)try{var p=document.createElement("li"),m=new RGBColor(f[h]),n=document.createElement("div");n.style.cssText="margin: 3px; border: 1px solid black; background:"+m.toHex()+"; color:"+m.toHex();n.appendChild(document.createTextNode("test"));var q=document.createTextNode(" "+f[h]+" -> "+m.toRGB()+" -> "+m.toHex());p.appendChild(n);p.appendChild(q);g.appendChild(p)}catch(s){}return g}}var wikispaces_jsLoaded=wikispaces_jsLoaded||[];wikispaces_jsLoaded.push({editorc:"f04c17a1d967f6886bef5c5a35a1ff17"});
